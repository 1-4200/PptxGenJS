{"version":3,"sources":["App.js","serviceWorker.js","index.js","logo.svg","pptxgen.es.js"],"names":["App","className","href","src","logo","width","height","alt","type","data-toggle","data-target","aria-controls","aria-expanded","aria-label","id","onClick","ev","window","open","pptx","pptxgen","addSlide","addText","x","y","w","h","fontSize","fill","align","writeFile","console","log","version","runDemo","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","module","exports","TEXT_HALIGN","TEXT_VALIGN","EMU","ONEPT","CRLF","LAYOUT_IDX_SERIES_BASE","REGEX_HEX_COLOR","LINEH_MODIFIER","DEF_CELL_BORDER","color","DEF_CELL_MARGIN_PT","DEF_CHART_GRIDLINE","style","size","DEF_FONT_COLOR","DEF_FONT_SIZE","DEF_FONT_TITLE_SIZE","DEF_PRES_LAYOUT","DEF_PRES_LAYOUT_NAME","DEF_SLIDE_MARGIN_IN","DEF_SHAPE_SHADOW","blur","offset","angle","opacity","rotateWithShape","AXIS_ID_VALUE_PRIMARY","AXIS_ID_VALUE_SECONDARY","AXIS_ID_CATEGORY_PRIMARY","AXIS_ID_CATEGORY_SECONDARY","AXIS_ID_SERIES_PRIMARY","LETTERS","split","BARCHART_COLORS","PIECHART_COLORS","SCHEME_COLOR_NAMES","MASTER_OBJECTS","SLIDE_OBJECT_TYPES","PLACEHOLDER_TYPES","CHART_TYPES","BULLET_TYPES","SLDNUMFLDID","BASE_SHAPES","Object","freeze","RECTANGLE","displayName","name","avLst","LINE","IMG_BROKEN","IMG_PLAYBTN","getSmartParseNumber","xyDir","layout","isNaN","Number","inch2Emu","indexOf","Math","round","parseFloat","getUuid","uuidFormat","replace","c","r","random","toString","getMix","o1","o2","etc","objMix","_loop_1","i","oN","arguments_1","keys","forEach","key","arguments","length","encodeXmlEntities","xml","inches","convertRotationDegrees","d","componentToHex","hex","rgbToHex","g","b","toUpperCase","createColorElement","colorStr","innerElements","isHexaRgb","test","values","warn","tagName","colorAttr","genXmlColorSelection","shapeFill","backColor","colorVal","fillType","internalElements","outText","alpha","getSlidesForTableRows","tableRows","tabOpts","presLayout","masterSlide","emuSlideTabW","arrInchMargins","emuTabCurrH","emuSlideTabH","numCols","tableRowSlides","rows","verbose","colW","slideMargin","margin","Array","isArray","cell","tablecell","cellOpts","options","colspan","val","toFixed","arrColW_1","push","iCol","iRow","row","shift","maxLineHeight","linesRow","maxCellMarTopEmu","maxCellMarBtmEmu","currSlide","newRowSlide","text","newSlideStartY","iCell","newCell","lines","lineHeight","autoPageLineWeight","rowspan","autoPageCharWeight","colWidth","CHAR","CPL","arrLines","strCurrLine","trim","line","word","parseTextToLines","_loop_2","addHeaderToEach","_arrObjTabHeadRows","newRowSlide_1","join","unshift","currSlide_1","newRowSlide_2","idxR","currSlide_2","RegExp","filter","PowerPointShapes","ACTION_BUTTON_BACK_OR_PREVIOUS","ACTION_BUTTON_BEGINNING","ACTION_BUTTON_CUSTOM","ACTION_BUTTON_DOCUMENT","ACTION_BUTTON_END","ACTION_BUTTON_FORWARD_OR_NEXT","ACTION_BUTTON_HELP","ACTION_BUTTON_HOME","ACTION_BUTTON_INFORMATION","ACTION_BUTTON_MOVIE","ACTION_BUTTON_RETURN","ACTION_BUTTON_SOUND","ARC","BALLOON","BENT_ARROW","BENT_UP_ARROW","BEVEL","BLOCK_ARC","CAN","CHART_PLUS","CHART_STAR","CHART_X","CHEVRON","CHORD","CIRCULAR_ARROW","CLOUD","CLOUD_CALLOUT","CORNER","CORNER_TABS","CROSS","CUBE","CURVED_DOWN_ARROW","CURVED_DOWN_RIBBON","CURVED_LEFT_ARROW","CURVED_RIGHT_ARROW","CURVED_UP_ARROW","CURVED_UP_RIBBON","DECAGON","DIAGONAL_STRIPE","DIAMOND","DODECAGON","DONUT","DOUBLE_BRACE","DOUBLE_BRACKET","DOUBLE_WAVE","DOWN_ARROW","DOWN_ARROW_CALLOUT","DOWN_RIBBON","EXPLOSION1","EXPLOSION2","FLOWCHART_ALTERNATE_PROCESS","FLOWCHART_CARD","FLOWCHART_COLLATE","FLOWCHART_CONNECTOR","FLOWCHART_DATA","FLOWCHART_DECISION","FLOWCHART_DELAY","FLOWCHART_DIRECT_ACCESS_STORAGE","FLOWCHART_DISPLAY","FLOWCHART_DOCUMENT","FLOWCHART_EXTRACT","FLOWCHART_INTERNAL_STORAGE","FLOWCHART_MAGNETIC_DISK","FLOWCHART_MANUAL_INPUT","FLOWCHART_MANUAL_OPERATION","FLOWCHART_MERGE","FLOWCHART_MULTIDOCUMENT","FLOWCHART_OFFLINE_STORAGE","FLOWCHART_OFFPAGE_CONNECTOR","FLOWCHART_OR","FLOWCHART_PREDEFINED_PROCESS","FLOWCHART_PREPARATION","FLOWCHART_PROCESS","FLOWCHART_PUNCHED_TAPE","FLOWCHART_SEQUENTIAL_ACCESS_STORAGE","FLOWCHART_SORT","FLOWCHART_STORED_DATA","FLOWCHART_SUMMING_JUNCTION","FLOWCHART_TERMINATOR","FOLDED_CORNER","FRAME","FUNNEL","GEAR_6","GEAR_9","HALF_FRAME","HEART","HEPTAGON","HEXAGON","HORIZONTAL_SCROLL","ISOSCELES_TRIANGLE","LEFT_ARROW","LEFT_ARROW_CALLOUT","LEFT_BRACE","LEFT_BRACKET","LEFT_CIRCULAR_ARROW","LEFT_RIGHT_ARROW","LEFT_RIGHT_ARROW_CALLOUT","LEFT_RIGHT_CIRCULAR_ARROW","LEFT_RIGHT_RIBBON","LEFT_RIGHT_UP_ARROW","LEFT_UP_ARROW","LIGHTNING_BOLT","LINE_CALLOUT_1","LINE_CALLOUT_1_ACCENT_BAR","LINE_CALLOUT_1_BORDER_AND_ACCENT_BAR","LINE_CALLOUT_1_NO_BORDER","LINE_CALLOUT_2","LINE_CALLOUT_2_ACCENT_BAR","LINE_CALLOUT_2_BORDER_AND_ACCENT_BAR","LINE_CALLOUT_2_NO_BORDER","LINE_CALLOUT_3","LINE_CALLOUT_3_ACCENT_BAR","LINE_CALLOUT_3_BORDER_AND_ACCENT_BAR","LINE_CALLOUT_3_NO_BORDER","LINE_CALLOUT_4","LINE_CALLOUT_4_ACCENT_BAR","LINE_CALLOUT_4_BORDER_AND_ACCENT_BAR","LINE_CALLOUT_4_NO_BORDER","LINE_INVERSE","MATH_DIVIDE","MATH_EQUAL","MATH_MINUS","MATH_MULTIPLY","MATH_NOT_EQUAL","MATH_PLUS","MOON","NON_ISOSCELES_TRAPEZOID","NOTCHED_RIGHT_ARROW","NO_SYMBOL","OCTAGON","OVAL","OVAL_CALLOUT","PARALLELOGRAM","PENTAGON","PIE","PIE_WEDGE","PLAQUE","PLAQUE_TABS","QUAD_ARROW","QUAD_ARROW_CALLOUT","RECTANGULAR_CALLOUT","REGULAR_PENTAGON","RIGHT_ARROW","RIGHT_ARROW_CALLOUT","RIGHT_BRACE","RIGHT_BRACKET","RIGHT_TRIANGLE","ROUNDED_RECTANGLE","ROUNDED_RECTANGULAR_CALLOUT","ROUND_1_RECTANGLE","ROUND_2_DIAG_RECTANGLE","ROUND_2_SAME_RECTANGLE","SMILEY_FACE","SNIP_1_RECTANGLE","SNIP_2_DIAG_RECTANGLE","SNIP_2_SAME_RECTANGLE","SNIP_ROUND_RECTANGLE","SQUARE_TABS","STAR_10_POINT","STAR_12_POINT","STAR_16_POINT","STAR_24_POINT","STAR_32_POINT","STAR_4_POINT","STAR_5_POINT","STAR_6_POINT","STAR_7_POINT","STAR_8_POINT","STRIPED_RIGHT_ARROW","SUN","SWOOSH_ARROW","TEAR","TRAPEZOID","UP_ARROW","UP_ARROW_CALLOUT","UP_DOWN_ARROW","UP_DOWN_ARROW_CALLOUT","UP_RIBBON","U_TURN_ARROW","VERTICAL_SCROLL","WAVE","imageSizingXml","cover","imgSize","boxDim","imgRatio","isBoxBased","hzPerc","vzPerc","contain","widthBased","crop","imageSize","l","t","slideObjectToXml","slide","strSlideXml","intTableNum","bkgd","bkgdImgRid","data","slideItemObj","idx","placeholderObj","cx","cy","locationAttr","shapeType","undefined","slideLayout","placeholder","object","shape","getShapeInfo","flipH","flipV","rotate","table","cellOpts_1","objTableGrid_1","arrTabRows_1","arrTabRows","objTabOpts_1","intColCnt_1","intColW","strXml_1","number","col","colw","rIdx","cIdx","idx_1","currColIdx","idy","hmerge","idz","vmerge","entries","_a","rowObj","intRowH","rowH","cellValign","valign","cellColspan","cellRowspan","cellFill","optImp","cellMargin","cellMarginXml","genXmlTextBody","border","obj","strC","intW","pt","strClr","strAttr","toLowerCase","tmp","bodyProp","lIns","rIns","bIns","tIns","isTextBox","genXmlPlaceholder","rectRadius","min","lineSize","lineDash","lineHead","lineTail","shadow","image","sizing","rounding","hyperlink","url","rId","tooltip","rel","imageRid","boxW","boxH","boxX","boxY","media","mtype","mediaRid","pop","chart","chartRid","slideNumberObj","fontFace","slideObjectRelationsToXml","defaultRels","lastRid","strXml","rels","max","Target","relsChart","relsMedia","target","genXmlParagraphProperties","textObj","isDefault","strXmlBullet","strXmlLnSpc","strXmlParaSpc","tag","paragraphPropXml","rtlMode","lineSpacing","indentLevel","paraSpaceBefore","paraSpaceAfter","bullet","startAt","code","bulletCode","genXmlTextRunProperties","opts","runProps","runPropsTag","lang","bold","italic","strike","underline","subscript","superscript","charSpacing","outline","Error","slideObj","arrTextObjects","tagStart","tagClose","breakLine","lineIdx","slideObject","bodyProperties","wrap","anchor","vert","shrinkText","autoFit","genXmlBodyProperties","xmlTextRun","startInfo","genXmlTextRun","placeholderIdx","placeholderType","makeXmlNotesSlide","notesText","getNotesFromSlide","getLayoutIdxForSlide","slides","slideLayouts","slideNumber","correctShadowOptions","ShadowOptions","shapeName","objShape","_chartCounter","createSlideObject","slideDef","bkg","path","strImgExtn","intRels","extn","addBackgroundDefinition","objects","tgt","addChartDefinition","addImageDefinition","addShapeDefinition","addTextDefinition","opt","addPlaceholderDefinition","correctGridLineOptions","glOpts","tmpOpt","chartId","resultObject","tmpData","concat","item","index","barDir","dataLabelPosition","DOUGHNUT","dataLabelBkgrdColors","legendPos","barGrouping","barGapWidthPct","bar3DShape","lineDataSymbol","displayBlanksAs","radarStyle","lineDataSymbolSize","lineDataSymbolLineSize","catGridLine","SCATTER","valGridLine","serGridLine","showDataTable","showDataTableHorzBorder","showDataTableVertBorder","showDataTableOutline","showDataTableKeys","showLabel","showLegend","showPercent","showTitle","showValue","catAxisLineShow","valAxisLineShow","serAxisLineShow","v3DRotX","v3DRotY","v3DRAngAx","v3DPerspective","barGapDepthPct","chartColors","chartColorsOpacity","dataBorder","dataLabelFormatCode","dataLabelFormatScatter","valAxisMajorUnit","valAxisCrossesAt","globalId","fileName","newObject","intPosX","intPosY","intWidth","intHeight","objHyperlink","strImageData","strImagePath","imageRelId","error","substring","lastIndexOf","exec","isSvgPng","svgSize","isPlaceholder","ctr","inset","startsWith","center","left","right","justify","createHyperlinkRels","textObjs","relId","Slide","params","this","getSlide","_setSlideNum","setSlideNum","defineProperty","prototype","get","_bkgd","set","value","enumerable","configurable","_color","_hidden","_slideNumber","addChart","addImage","addMedia","strExtn","intSizeX","intSizeY","strData","strLink","link","strPath","strType","slideData","addMediaDefinition","addNotes","notes","addNotesDefinition","addShape","addTable","arrRows","newRow","autoPage","arrTableMargin","firstRowColCnt","floor","assign","newSlide","addTableDefinition","createExcelWorksheet","chartObject","zip","Promise","resolve","reject","zipExcel","JSZip","intBubbleCols","folder","file","Date","toISOString","strSharedStrings_1","BUBBLE","labels","objData","label","strTableXml_1","_obj","strSheetXml_1","idxBc","idxColLtr","sizes","idxSd","_cat","generateAsync","content","base64","usesSecondaryValAxis","genXmlTitle","title","titleFontSize","titleColor","titleFontFace","titleRotate","titleAlign","titlePos","BAR3D","valAxisId","catAxisId","makeChartType","valAxes","catAxes","makeCatAxis","makeValAxis","axisId","serAxisOrientation","serAxisHidden","createGridLineElement","showSerAxisTitle","serAxisTitleColor","serAxisTitleFontFace","serAxisTitleFontSize","serAxisTitleRotate","serAxisTitle","serLabelFormatCode","serAxisLabelPos","serAxisLabelFontSize","serAxisLabelColor","serAxisLabelFontFace","serAxisLabelFrequency","serAxisBaseTimeUnit","serAxisMajorTimeUnit","serAxisMinorTimeUnit","serAxisMajorUnit","serAxisMinorUnit","makeSerAxis","legendFontFace","legendFontSize","legendColor","makeXmlCharts","catch","strErr","chartType","isMultiTypeChart","AREA","BAR","RADAR","colorIndex_1","getExcelColName","seriesColor","createShadowElement","dataLabelFontSize","dataLabelColor","dataLabelFontFace","lineDataSymbolLineColor","valueBarColors","arrColors","invertedColors","catLabelFormatCode","lineSmooth","dataLabelFontBold","tmpSerColor","chartUuid_1","_value","idxColLtr_1","dataNoEffects","_label","holeSize","catAxisOrientation","catAxisMaxVal","catAxisMinVal","catAxisHidden","showCatAxisTitle","catAxisTitleColor","catAxisTitleFontFace","catAxisTitleFontSize","catAxisTitleRotate","catAxisTitle","valAxisLabelFormatCode","catAxisMajorTickMark","catAxisLabelPos","catAxisLabelRotate","catAxisLabelFontSize","catAxisLabelFontBold","catAxisLabelColor","catAxisLabelFontFace","catAxisLabelFrequency","catAxisBaseTimeUnit","catAxisMajorTimeUnit","catAxisMinorTimeUnit","catAxisMajorUnit","catAxisMinorUnit","axisPos","crosses","crossAxId","valAxisOrientation","valAxisMaxVal","valAxisMinVal","valAxisHidden","showValAxisTitle","valAxisTitleColor","valAxisTitleFontFace","valAxisTitleFontSize","valAxisTitleRotate","valAxisTitle","valAxisMajorTickMark","valAxisMinorTickMark","valAxisLabelPos","valAxisLabelRotate","valAxisLabelFontSize","valAxisLabelFontBold","valAxisLabelColor","valAxisLabelFontFace","sizeAttr","strName","defaults","encodeSlideMediaRels","fs","require","https","imageProms","bitmap","readFileSync","Buffer","from","ex","res","rawData","setEncoding","on","chunk","xhr_1","XMLHttpRequest","onload","reader","FileReader","onloadend","result","createSvgPngPreview","readAsDataURL","response","onerror","responseType","send","Image","canvas","createElement","ctx","getContext","drawImage","toDataURL","VERSION","PptxGenJS","_this","_version","_charts","_colors","_shapes","addNewSlide","masterName","slideNum","setSlideNumber","createChartMediaRels","chartPromises","writeFileToBrowser","exportName","blobContent","_reject","eleLink","setAttribute","body","appendChild","msSaveOrOpenBlob","blob_1","Blob","onclick","click","removeChild","URL","createObjectURL","url_1","download","setTimeout","revokeObjectURL","exportPresentation","outputType","arrChartPromises","arrMediaPromises","all","err","company","subject","author","revision","slideLayoutObj","addPlaceholdersToSlideLayouts","_slide","makeXmlContTypes","map","_slideObj","intRelNum","makeXmlPresentationRels","pptLayout","makeXmlPresentation","layoutNumber","makeXmlLayout","hidden","makeXmlSlide","makeXmlSlideRel","layouts","layoutDefs","_layoutDef","makeXmlMaster","makeXmlMasterRel","LAYOUTS","LAYOUT_4x3","LAYOUT_16x9","LAYOUT_16x10","LAYOUT_WIDE","_author","_company","_revision","_subject","_title","_presLayout","_rtlMode","_layout","newLayout","stream","write","endsWith","masterSlideName","defineLayout","defineSlideMaster","slideMasterOpts","tableToSlides","tableElementId","tabEleId","arrObjTabHeadRows","arrObjTabBodyRows","arrObjTabFootRows","arrColW","arrTabColW","intTabW","firstRowCells","querySelectorAll","getAttribute","idxc","offsetWidth","idxW","intCalcWidth","intMinWidth","colSelectorMin","querySelector","colSelectorSet","part","arrObjTabCells","cells","arrRGB1","getComputedStyle","getPropertyValue","arrRGB2","idxs","idxb","arrRGB","intBorderW","strBorderC","innerText","idxTr","genTableToSlides"],"mappings":"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","file":"static/js/main.dfd2c7ac.chunk.js","sourcesContent":["import React from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport pptxgen from \"./pptxgen.es.js\"; // LOCAL DEV TESTING src=`PptxGenJS/dist`\n//import pptxgen from \"pptxgenjs\"; // react-app webpack will use package.json `\"module\": \"dist/pptxgen.es.js\"` value\n\nfunction App() {\n\tconst demoCode = `import pptxgen from \"pptxgenjs\";\nlet pptx = new pptxgen();\n\nlet slide = pptx.addSlide();\nslide.addText(\"React Demo!\", { x:1, y:1, w:'80%', h:1, fontSize:36, fill:'eeeeee', align:'center' });\n\npptx.writeFile(\"react-demo.pptx\");`;\n\n\tfunction runDemo() {\n\t\tlet pptx = new pptxgen();\n\t\tlet slide = pptx.addSlide();\n\t\tslide.addText(\"React Demo!\", { x: 1, y: 1, w: \"80%\", h: 1, fontSize: 36, fill: \"eeeeee\", align: \"center\" });\n\t\tpptx.writeFile(\"pptxgenjs-demo-react.pptx\");\n\n\t\tconsole.log(`pptx.version = ${pptx.version}`);\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<nav className=\"navbar navbar-expand-lg navbar-dark bg-primary\">\n\t\t\t\t<a className=\"navbar-brand\" href=\"https://gitbrent.github.io/PptxGenJS/\">\n\t\t\t\t\t<img src={logo} width=\"30\" height=\"30\" className=\"d-inline-block align-top mr-2\" alt=\"\" />\n\t\t\t\t\tPptxGenJS\n\t\t\t\t</a>\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"navbar-toggler\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tdata-toggle=\"collapse\"\n\t\t\t\t\tdata-target=\"#navbarColor01\"\n\t\t\t\t\taria-controls=\"navbarColor01\"\n\t\t\t\t\taria-expanded=\"false\"\n\t\t\t\t\taria-label=\"Toggle navigation\"\n\t\t\t\t>\n\t\t\t\t\t<span className=\"navbar-toggler-icon\"></span>\n\t\t\t\t</button>\n\n\t\t\t\t<div className=\"collapse navbar-collapse\" id=\"navbarColor01\">\n\t\t\t\t\t<ul className=\"navbar-nav mr-auto\">\n\t\t\t\t\t\t<li className=\"nav-item active\">\n\t\t\t\t\t\t\t<a className=\"nav-link\" href=\"https://gitbrent.github.io/PptxGenJS/demo-react/index.html\">\n\t\t\t\t\t\t\t\tHome <span className=\"sr-only\">(current)</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<form className=\"form-inline my-2 my-lg-0\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn btn-outline-info mx-3 my-2 my-sm-0\"\n\t\t\t\t\t\t\tonClick={ev => {\n\t\t\t\t\t\t\t\twindow.open(\"https://gitbrent.github.io/PptxGenJS/demo/\", true);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tDemo Page\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn btn-outline-info mx-3 my-2 my-sm-0\"\n\t\t\t\t\t\t\tonClick={ev => {\n\t\t\t\t\t\t\t\twindow.open(\"https://github.com/gitbrent/PptxGenJS\", true);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tGitHub Project\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn btn-outline-info mx-3 my-2 my-sm-0\"\n\t\t\t\t\t\t\tonClick={ev => {\n\t\t\t\t\t\t\t\twindow.open(\"https://gitbrent.github.io/PptxGenJS/docs/installation.html\", true);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tAPI Docs\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</nav>\n\n\t\t\t<main className=\"container\">\n\t\t\t\t<div className=\"jumbotron mt-5\">\n\t\t\t\t\t<h1 className=\"display-4\">React Demo</h1>\n\t\t\t\t\t<p className=\"lead\">Sample React application to demonstrate using the PptxGenJS library as a module.</p>\n\t\t\t\t\t<hr className=\"my-4\" />\n\n\t\t\t\t\t<h5 className=\"text-info\">Demo Code</h5>\n\t\t\t\t\t<pre className=\"my-4\">\n\t\t\t\t\t\t<code className=\"language-javascript\">{demoCode}</code>\n\t\t\t\t\t</pre>\n\n\t\t\t\t\t<button type=\"button\" className=\"btn btn-success w-25\" onClick={ev => runDemo()}>\n\t\t\t\t\t\tRun Demo\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</main>\n\t\t</div>\n\t);\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/logo.bcad93ae.svg\";","/* PptxGenJS 3.1.0-beta @ 2020-01-09T05:19:37.076Z */\nimport * as JSZip from 'jszip';\n\n/**\r\n * PptxGenJS Enums\r\n * NOTE: `enum` wont work for objects, so use `Object.freeze`\r\n */\r\n// CONST\r\nvar EMU = 914400; // One (1) inch (OfficeXML measures in EMU (English Metric Units))\r\nvar ONEPT = 12700; // One (1) point (pt)\r\nvar CRLF = '\\r\\n'; // AKA: Chr(13) & Chr(10)\r\nvar LAYOUT_IDX_SERIES_BASE = 2147483649;\r\nvar REGEX_HEX_COLOR = /^[0-9a-fA-F]{6}$/;\r\nvar LINEH_MODIFIER = 1.67; // AKA: Golden Ratio Typography\r\nvar DEF_CELL_BORDER = { color: '666666' };\r\nvar DEF_CELL_MARGIN_PT = [3, 3, 3, 3]; // TRBL-style\r\nvar DEF_CHART_GRIDLINE = { color: '888888', style: 'solid', size: 1 };\r\nvar DEF_FONT_COLOR = '000000';\r\nvar DEF_FONT_SIZE = 12;\r\nvar DEF_FONT_TITLE_SIZE = 18;\r\nvar DEF_PRES_LAYOUT = 'LAYOUT_16x9';\r\nvar DEF_PRES_LAYOUT_NAME = 'DEFAULT';\r\nvar DEF_SLIDE_MARGIN_IN = [0.5, 0.5, 0.5, 0.5]; // TRBL-style\r\nvar DEF_SHAPE_SHADOW = { type: 'outer', blur: 3, offset: 23000 / 12700, angle: 90, color: '000000', opacity: 0.35, rotateWithShape: true };\r\nvar AXIS_ID_VALUE_PRIMARY = '2094734552';\r\nvar AXIS_ID_VALUE_SECONDARY = '2094734553';\r\nvar AXIS_ID_CATEGORY_PRIMARY = '2094734554';\r\nvar AXIS_ID_CATEGORY_SECONDARY = '2094734555';\r\nvar AXIS_ID_SERIES_PRIMARY = '2094734556';\r\nvar LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');\r\nvar BARCHART_COLORS = [\r\n    'C0504D',\r\n    '4F81BD',\r\n    '9BBB59',\r\n    '8064A2',\r\n    '4BACC6',\r\n    'F79646',\r\n    '628FC6',\r\n    'C86360',\r\n    'C0504D',\r\n    '4F81BD',\r\n    '9BBB59',\r\n    '8064A2',\r\n    '4BACC6',\r\n    'F79646',\r\n    '628FC6',\r\n    'C86360',\r\n];\r\nvar PIECHART_COLORS = [\r\n    '5DA5DA',\r\n    'FAA43A',\r\n    '60BD68',\r\n    'F17CB0',\r\n    'B2912F',\r\n    'B276B2',\r\n    'DECF3F',\r\n    'F15854',\r\n    'A7A7A7',\r\n    '5DA5DA',\r\n    'FAA43A',\r\n    '60BD68',\r\n    'F17CB0',\r\n    'B2912F',\r\n    'B276B2',\r\n    'DECF3F',\r\n    'F15854',\r\n    'A7A7A7',\r\n];\r\nvar TEXT_HALIGN;\r\n(function (TEXT_HALIGN) {\r\n    TEXT_HALIGN[\"left\"] = \"left\";\r\n    TEXT_HALIGN[\"center\"] = \"center\";\r\n    TEXT_HALIGN[\"right\"] = \"right\";\r\n    TEXT_HALIGN[\"justify\"] = \"justify\";\r\n})(TEXT_HALIGN || (TEXT_HALIGN = {}));\r\nvar TEXT_VALIGN;\r\n(function (TEXT_VALIGN) {\r\n    TEXT_VALIGN[\"b\"] = \"b\";\r\n    TEXT_VALIGN[\"ctr\"] = \"ctr\";\r\n    TEXT_VALIGN[\"t\"] = \"t\";\r\n})(TEXT_VALIGN || (TEXT_VALIGN = {}));\r\nvar SLDNUMFLDID = '{F7021451-1387-4CA6-816F-3879F97B5CBC}';\r\n// ENUM\r\nvar SCHEME_COLOR_NAMES;\r\n(function (SCHEME_COLOR_NAMES) {\r\n    SCHEME_COLOR_NAMES[\"TEXT1\"] = \"tx1\";\r\n    SCHEME_COLOR_NAMES[\"TEXT2\"] = \"tx2\";\r\n    SCHEME_COLOR_NAMES[\"BACKGROUND1\"] = \"bg1\";\r\n    SCHEME_COLOR_NAMES[\"BACKGROUND2\"] = \"bg2\";\r\n    SCHEME_COLOR_NAMES[\"ACCENT1\"] = \"accent1\";\r\n    SCHEME_COLOR_NAMES[\"ACCENT2\"] = \"accent2\";\r\n    SCHEME_COLOR_NAMES[\"ACCENT3\"] = \"accent3\";\r\n    SCHEME_COLOR_NAMES[\"ACCENT4\"] = \"accent4\";\r\n    SCHEME_COLOR_NAMES[\"ACCENT5\"] = \"accent5\";\r\n    SCHEME_COLOR_NAMES[\"ACCENT6\"] = \"accent6\";\r\n})(SCHEME_COLOR_NAMES || (SCHEME_COLOR_NAMES = {}));\r\nvar MASTER_OBJECTS;\r\n(function (MASTER_OBJECTS) {\r\n    MASTER_OBJECTS[\"chart\"] = \"chart\";\r\n    MASTER_OBJECTS[\"image\"] = \"image\";\r\n    MASTER_OBJECTS[\"line\"] = \"line\";\r\n    MASTER_OBJECTS[\"rect\"] = \"rect\";\r\n    MASTER_OBJECTS[\"text\"] = \"text\";\r\n    MASTER_OBJECTS[\"placeholder\"] = \"placeholder\";\r\n})(MASTER_OBJECTS || (MASTER_OBJECTS = {}));\r\nvar SLIDE_OBJECT_TYPES;\r\n(function (SLIDE_OBJECT_TYPES) {\r\n    SLIDE_OBJECT_TYPES[\"chart\"] = \"chart\";\r\n    SLIDE_OBJECT_TYPES[\"hyperlink\"] = \"hyperlink\";\r\n    SLIDE_OBJECT_TYPES[\"image\"] = \"image\";\r\n    SLIDE_OBJECT_TYPES[\"media\"] = \"media\";\r\n    SLIDE_OBJECT_TYPES[\"online\"] = \"online\";\r\n    SLIDE_OBJECT_TYPES[\"placeholder\"] = \"placeholder\";\r\n    SLIDE_OBJECT_TYPES[\"table\"] = \"table\";\r\n    SLIDE_OBJECT_TYPES[\"tablecell\"] = \"tablecell\";\r\n    SLIDE_OBJECT_TYPES[\"text\"] = \"text\";\r\n    SLIDE_OBJECT_TYPES[\"notes\"] = \"notes\";\r\n})(SLIDE_OBJECT_TYPES || (SLIDE_OBJECT_TYPES = {}));\r\nvar PLACEHOLDER_TYPES;\r\n(function (PLACEHOLDER_TYPES) {\r\n    PLACEHOLDER_TYPES[\"title\"] = \"title\";\r\n    PLACEHOLDER_TYPES[\"body\"] = \"body\";\r\n    PLACEHOLDER_TYPES[\"image\"] = \"pic\";\r\n    PLACEHOLDER_TYPES[\"chart\"] = \"chart\";\r\n    PLACEHOLDER_TYPES[\"table\"] = \"tbl\";\r\n    PLACEHOLDER_TYPES[\"media\"] = \"media\";\r\n})(PLACEHOLDER_TYPES || (PLACEHOLDER_TYPES = {}));\r\nvar CHART_TYPES;\r\n(function (CHART_TYPES) {\r\n    CHART_TYPES[\"AREA\"] = \"area\";\r\n    CHART_TYPES[\"BAR\"] = \"bar\";\r\n    CHART_TYPES[\"BAR3D\"] = \"bar3D\";\r\n    CHART_TYPES[\"BUBBLE\"] = \"bubble\";\r\n    CHART_TYPES[\"DOUGHNUT\"] = \"doughnut\";\r\n    CHART_TYPES[\"LINE\"] = \"line\";\r\n    CHART_TYPES[\"PIE\"] = \"pie\";\r\n    CHART_TYPES[\"RADAR\"] = \"radar\";\r\n    CHART_TYPES[\"SCATTER\"] = \"scatter\";\r\n})(CHART_TYPES || (CHART_TYPES = {}));\r\n/**\r\n * NOTE: 20170304: BULLET_TYPES: Only default is used so far. I'd like to combine the two pieces of code that use these before implementing these as options\r\n * Since we close <p> within the text object bullets, its slightly more difficult than combining into a func and calling to get the paraProp\r\n * and i'm not sure if anyone will even use these... so, skipping for now.\r\n */\r\nvar BULLET_TYPES;\r\n(function (BULLET_TYPES) {\r\n    BULLET_TYPES[\"DEFAULT\"] = \"&#x2022;\";\r\n    BULLET_TYPES[\"CHECK\"] = \"&#x2713;\";\r\n    BULLET_TYPES[\"STAR\"] = \"&#x2605;\";\r\n    BULLET_TYPES[\"TRIANGLE\"] = \"&#x25B6;\";\r\n})(BULLET_TYPES || (BULLET_TYPES = {}));\r\nvar BASE_SHAPES = Object.freeze({\r\n    RECTANGLE: { displayName: 'Rectangle', name: 'rect', avLst: {} },\r\n    LINE: { displayName: 'Line', name: 'line', avLst: {} },\r\n});\r\n// IMAGES (base64)\r\nvar IMG_BROKEN = 'data:image/png;base64,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';\r\nvar IMG_PLAYBTN = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAHCCAYAAAAXY63IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAFRdJREFUeNrs3WFz2lbagOEnkiVLxsYQsP//z9uZZmMswJIlS3k/tPb23U3TOAUM6Lpm8qkzbXM4A7p1dI4+/etf//oWAAAAB3ARETGdTo0EAACwV1VVRWIYAACAQxEgAACAAAEAAAQIAACAAAEAAAQIAACAAAEAAAQIAAAgQAAAAAQIAAAgQAAAAAQIAAAgQAAAAAECAAAgQAAAAAECAAAgQAAAAAECAAAIEAAAAAECAAAIEAAAAAECAAAIEAAAQIAAAAAIEAAAQIAAAAAIEAAAQIAAAAACBAAAQIAAAAACBAAAQIAAAAACBAAAQIAAAAACBAAAECAAAAACBAAAECAAAAACBAAAECAAAIAAAQAAECAAAIAAAQAAECAAAIAAAQAABAgAAIAAAQAABAgAAIAAAQAABAgAACBAAAAABAgAACBAAAAABAgAACBAAAAAAQIAACBAAAAAAQIAACBAAAAAAQIAACBAAAAAAQIAAAgQAAAAAQIAAAgQAAAAAQIAAAgQAABAgAAAAAgQAABAgAAAAAgQAABAgAAAAAIEAABAgAAAAAIEAABAgAAAAAIEAAAQIAAAAAIEAAAQIAAAAAIEAAAQIAAAgAABAAAQIAAAgAABAAAQIAAAgAABAAAQIAAAgAABAAAECAAAgAABAAAECAAAgAABAAAECAAAIEAAAAAECAAAIEAAAAAECAAAIEAAAAABAgAAIEAAAAABAgAAIEAAAAABAgAACBAAAAABAgAACBAAAAABAgAACBAAAECAAAAACBAAAECAAAAACBAAAECAAAAAAgQAAECAAAAAAgQAAECAAAAAAgQAAECAAAAAAgQAABAgAAAAAgQAABAgAAAAAgQAABAgAACAAAEAABAgAACAAAEAABAgAACAAAEAAAQIAACAAAEAAAQIAACAAAEAAAQIAAAgQAAAAPbnwhAA8CuGYYiXl5fv/7hcXESSuMcFgAAB4G90XRffvn2L5+fniIho2zYiIvq+j77vf+nfmaZppGkaERF5nkdExOXlZXz69CmyLDPoAAIEgDFo2zaen5/j5eUl+r6Pruv28t/5c7y8Bs1ms3n751mWRZqmcXFxEZeXl2+RAoAAAeBEDcMQbdu+/dlXbPyKruve/n9ewyTLssjz/O2PR7oABAgAR67v+2iaJpqmeVt5OBWvUbLdbiPi90e3iqKIoijeHucCQIAAcATRsd1uo2maX96zcYxeV26qqoo0TaMoiphMJmIEQIAAcGjDMERd11HX9VE9WrXvyNput5FlWZRlGWVZekwLQIAAsE+vjyjVdT3qMei6LqqqirIsYzKZOFkLQIAAsEt1XcfT09PJ7es4xLjUdR15nsfV1VWUZWlQAAQIAP/kAnu9Xp/V3o59eN0vsl6v4+bmRogACBAAhMf+9X0fq9VKiAAIEAB+RtM0UVWV8NhhiEyn0yiKwqAACBAAXr1uqrbHY/ch8vDwEHmex3Q6tVkdQIAAjNswDLHZbN5evsd+tG0bX758iclkEtfX147vBRAgAOPTNE08Pj7GMAwG40BejzC+vb31WBaAAAEYh9f9CR63+hjDMLw9ljWfz62GAOyZb1mAD9Q0TXz58kV8HIG2beO3336LpmkMBsAeWQEB+ADDMERVVaN+g/mxfi4PDw9RlmVMp1OrIQACBOD0dV0XDw8PjtY9YnVdR9u2MZ/PnZQFsGNu7QAc+ML269ev4uME9H0fX79+tUoFsGNWQAAOZLVauZg9McMwxGq1iufn55jNZgYEQIAAnMZF7MPDg43mJ6yu6+j73ilZADvgWxRgj7qui69fv4qPM9C2rcfnAAQIwPHHR9d1BuOMPtMvX774TAEECMBxxoe3mp+fYRiEJYAAATgeryddiY/zjxAvLQQQIAAfHh+r1Up8jCRCHh4enGwGIEAAPkbTNLFarQzEyKxWKyshAAIE4LC6rovHx0cDMVKPj4/2hAAIEIDDxYc9H+NmYzqAAAEQH4gQAAECcF4XnI+Pj+IDcwJAgADs38PDg7vd/I+u6+Lh4cFAAAgQgN1ZrVbRtq2B4LvatnUiGoAAAdiNuq69+wHzBECAAOxf13VRVZWB4KdUVeUxPQABAvBrXt98bYMx5gyAAAHYu6qqou97A8G79H1v1QxAgAC8T9M0nufnl9V1HU3TGAgAAQLw9/q+j8fHx5P6f86yLMqy9OEdEe8HARAgAD9ltVqd3IXjp0+fYjabxWKxiDzPfYhH4HU/CIAAAeAvNU1z0u/7yPM8FotFzGazSBJf+R+tbVuPYgECxBAAfN8wDCf36NVfKcsy7u7u4vr62gf7wTyKBQgQAL5rs9mc1YVikiRxc3MT9/f3URSFD/gDw3az2RgIQIAA8B9d18V2uz3Lv1uapjGfz2OxWESWZT7sD7Ddbr2gEBAgAPzHGN7bkOd5LJfLmE6n9oeYYwACBOCjnPrG8/eaTCZxd3cXk8nEh39ANqQDAgSAiBjnnekkSWI6ncb9/b1je801AAECcCh1XUff96P9+6dpGovFIhaLRaRpakLsWd/3Ude1gQAECMBYrddrgxC/7w+5v7+P6+tr+0PMOQABArAPY1/9+J6bm5u4u7uLsiwNxp5YBQEECMBIuRP9Fz8USRKz2SyWy6X9IeYegAAB2AWrH38vy7JYLBYxn8/tD9kxqyCAAAEYmaenJ4Pwk4qiiOVyaX+IOQggQAB+Rdd1o3rvx05+PJIkbm5uYrlc2h+yI23bejs6IEAAxmC73RqEX5Smacxms1gsFpFlmQExFwEECMCPDMPg2fsdyPM8lstlzGYzj2X9A3VdxzAMBgIQIADnfMHH7pRlGXd3d3F9fW0wzEkAAQLgYu8APyx/7A+5v7+PoigMiDkJIEAAIn4/+tSm3/1J0zTm83ksFgvH9r5D13WOhAYECMA5suH3MPI8j/v7+5hOp/aHmJsAAgQYr6ZpDMIBTSaTuLu7i8lkYjDMTUCAAIxL3/cec/mIH50kiel0Gvf395HnuQExPwEBAjAO7jB/rDRNY7FYxHw+tz/EHAUECICLOw6jKIq4v7+P6+tr+0PMUUCAAJynYRiibVsDcURubm7i7u4uyrI0GH9o29ZLCQEBAnAuF3Yc4Q9SksRsNovlcml/iLkKCBAAF3UcRpZlsVgsYjabjX5/iLkKnKMLQwC4qOMYlWUZl5eXsd1u4+npaZSPI5mrwDmyAgKMjrefn9CPVJLEzc1NLJfLUe4PMVcBAQJw4txRPk1pmsZsNovFYhFZlpmzAAIE4DQ8Pz8bhBOW53ksl8uYzWajObbXnAXOjT0gwKi8vLwYhDPw5/0hm83GnAU4IVZAgFHp+94gnMsP2B/7Q+7v78/62F5zFhAgACfMpt7zk6ZpLBaLWCwWZ3lsrzkLCBAAF3IcoTzP4/7+PqbT6dntDzF3AQECcIK+fftmEEZgMpnE3d1dTCYTcxdAgAB8HKcJjejHLUliOp3Gcrk8i/0h5i4gQADgBGRZFovFIubz+VnuDwE4RY7hBUbDC93GqyiKKIoi1ut1PD09xTAM5i7AB7ECAsBo3NzcxN3dXZRlaTAABAjAfnmfAhG/7w+ZzWaxWCxOZn+IuQsIEAABwonL8zwWi0XMZrOj3x9i7gLnxB4QAEatLMu4vLyM7XZ7kvtDAE6NFRAA/BgmSdzc3MRyuYyiKAwIgAAB+Gfc1eZnpGka8/k8FotFZFlmDgMIEIBf8/LyYhD4aXmex3K5jNlsFkmSmMMAO2QPCAD8hT/vD9lsNgYEYAesgADAj34o/9gfcn9/fzLH9gIIEAAAgPAIFgD80DAMsdlsYrvdGgwAAQIA+/O698MJVAACBOB9X3YXvu74eW3bRlVV0XWdOQwgQADe71iOUuW49X0fVVVF0zTmMIAAAYD9GIbBUbsAAgQA9q+u61iv19H3vcEAECAAu5OmqYtM3rRtG+v1Otq2PYm5CyBAAAQIJ6jv+1iv11HX9UnNXQABAgAnZr1ex9PTk2N1AQQIwP7leX4Sj9uwe03TRFVVJ7sClue5DxEQIABw7Lqui6qqhCeAAAE4vMvLS8esjsQwDLHZbGK73Z7N3AUQIAAn5tOnTwZhBF7f53FO+zzMXUCAAJygLMsMwhlr2zZWq9VZnnRm7gICBOCEL+S6rjMQZ6Tv+1itVme7z0N8AAIE4ISlaSpAzsQwDG+PW537nAUQIACn+qV34WvvHNR1HVVVjeJ9HuYsIEAATpiTsE5b27ZRVdWoVrGcgAUIEIBT/tJzN/kk9X0fVVVF0zSj+7t7CSEgQABOWJIkNqKfkNd9Hk9PT6N43Oq/2YAOCBCAM5DnuQA5AXVdx3q9Pstjdd8zVwEECMAZXNSdyxuyz1HXdVFV1dkeqytAAAEC4KKOIzAMQ1RVFXVdGwxzFRAgAOcjSZLI89wd9iOyXq9Hu8/jR/GRJImBAAQIwDkoikKAHIGmaaKqqlHv8/jRHAUQIABndHFXVZWB+CB938dqtRKBAgQQIADjkKZppGnqzvuBDcMQm83GIQA/OT8BBAjAGSmKwoXwAW2329hsNvZ5/OTcBBAgAGdmMpkIkANo2zZWq5XVpnfOTQABAnBm0jT1VvQ96vs+qqqKpmkMxjtkWebxK0CAAJyrsiwFyI4Nw/D2uBW/NicBBAjAGV/sOQ1rd+q6jqqq7PMQIAACBOB7kiSJsiy9ffsfats2qqqymrSD+PDyQUCAAJy5q6srAfKL+r6P9Xpt/HY4FwEECMCZy/M88jz3Urx3eN3n8fT05HGrHc9DAAECMAJXV1cC5CfVdR3r9dqxunuYgwACBGAkyrJ0Uf03uq6LqqqE2h6kaWrzOSBAAMbm5uYmVquVgfgvwzBEVVX2eex57gEIEICRsQryv9brtX0ee2b1AxAgACNmFeR3bdvGarUSYweacwACBGCkxr4K0vd9rFYr+zwOxOoHIEAAGOUqyDAMsdlsYrvdmgAHnmsAAgRg5MqyjKenp9GsAmy329hsNvZ5HFie51Y/gFFKDAHA/xrDnem2bePLly9RVZX4MMcADsYKCMB3vN6dPsejZ/u+j6qqomkaH/QHKcvSW88BAQLA/zedTuP5+flsVgeGYXh73IqPkyRJTKdTAwGM93vQEAD89YXi7e3tWfxd6rqO3377TXwcgdvb20gSP7/AeFkBAfiBoigiz/OT3ZDetm2s12vH6h6JPM+jKAoDAYyaWzAAf2M2m53cHetv377FarWKf//73+LjWH5wkyRms5mBAHwfGgKAH0vT9OQexeq67iw30J+y29vbSNPUQAACxBAA/L2iKDw6g/kDIEAADscdbH7FKa6gAQgQgGP4wkySmM/nBoJ3mc/nTr0CECAAvybLMhuJ+Wmz2SyyLDMQAAIE4NeVZRllWRoIzBMAAQJwGO5s8yNWygAECMDOff78WYTw3fj4/PmzgQAQIAA7/gJNkri9vbXBGHMCQIAAHMbr3W4XnCRJYlUMQIAAiBDEB4AAATjDCJlOpwZipKbTqfgAECAAh1WWpZOPRmg2mzluF+AdLgwBwG4jJCKiqqoYhsGAnLEkSWI6nYoPgPd+fxoCgN1HiD0h5x8fnz9/Fh8AAgTgONiYfv7xYc8HgAABOMoIcaHqMwVAgAC4YOVd8jz3WQIIEIAT+KJNklgul/YLnLCyLGOxWHikDkCAAJyO2WzmmF6fG8DoOYYX4IDKsoyLi4t4eHiIvu8NyBFL0zTm87lHrgB2zAoIwIFlWRbL5TKKojAYR6ooilgul+IDYA+sgAB8gCRJYj6fR9M08fj46KWFR/S53N7eikMAAQJwnoqiiCzLYrVaRdu2BuQD5Xkes9ks0jQ1GAACBOB8pWkai8XCasgHseoBIEAARqkoisjzPKqqirquDcgBlGUZ0+nU8boAAgRgnJIkidlsFldXV7Ferz2WtSd5nsd0OrXJHECAAPB6gbxYLKKu61iv147s3ZE0TWM6nXrcCkCAAPA9ZVlGWZZCZAfhcXNz4230AAIEACEiPAAECABHHyJPT0/2iPyFPM/j6upKeAAIEAB2GSJt28bT05NTs/40LpPJxOZyAAECwD7kef52olNd11HXdXRdN6oxyLLsLcgcpwsgQAA4gCRJYjKZxGQyib7vY7vdRtM0Z7tXJE3TKIoiJpOJN5cDCBAAPvrifDqdxnQ6jb7vo2maaJrm5PeL5HkeRVFEURSiA0CAAHCsMfK6MjIMQ7Rt+/bn2B/VyrLs7RGzPM89XgUgQAA4JUmSvK0gvGrbNp6fn+Pl5SX6vv+wKMmyLNI0jYuLi7i8vIw8z31gAAIEgHPzurrwZ13Xxbdv3+L5+fktUiIi+r7/5T0laZq+PTb1+t+7vLyMT58+ObEKQIAAMGavQfB3qxDDMMTLy8v3f1wuLjwyBYAAAWB3kiTxqBQA7//9MAQAAIAAAQAABAgAAIAAAQAABAgAAIAAAQAABAgAACBAAAAABAgAACBAAAAABAgAACBAAAAAAQIAACBAAAAAAQIAACBAAAAAAQIAAAgQAAAAAQIAAAgQAAAAAQIAAAgQAABAgAAAAAgQAABAgAAAAAgQAABAgAAAAAIEAABAgAAAAAIEAABAgAAAAAIEAABAgAAAAAIEAAAQIAAAAAIEAAAQIAAAAAIEAAAQIAAAgAABAAAQIAAAgAABAAAQIAAAgAABAAAECAAAgAABAAAECAAAgAABAAAECAAAIEAAAAAECAAAIEAAAAAECAAAIEAAAAABAgAAIEAAAAABAgAAIEAAAAABAgAAIEAAAAABAgAACBAAAAABAgAACBAAAAABAgAACBAAAECAAAAACBAAAECAAAAACBAAAECAAAAAAgQAAECAAAAAAgQAAECAAAAAAgQAABAgAAAAAgQAABAgAAAAAgQAABAgAACAAAEAABAgAACAAAEAABAgAACAAAEAAASIIQAAAAQIAAAgQAAAAAQIAAAgQAAAAAQIAAAgQAAAAAECAAAgQAAAAAECAAAgQAAAAAECAAAIEAAAAAECAAAIEAAAAAECAAAIEAAAQIAAAAAIEAAAQIAAAAAIEAAAQIAAAAACBAAAQIAAAAACBAAAQIAAAAACBAAAECAAAAACBAAAECAAAAACBAAAECAAAAACBAAAECAAAIAAAQAAECAAAIAAAQAAECAAAIAAAQAABAgAAIAAAQAABAgAAIAAAQAABAgAACBAAAAAdu0iIqKqKiMBAADs3f8NAFFjCf5mB+leAAAAAElFTkSuQmCC';\n\n/**\r\n * PptxGenJS: Utility Methods\r\n */\r\n/**\r\n * Convert string percentages to number relative to slide size\r\n * @param {number|string} size - numeric (\"5.5\") or percentage (\"90%\")\r\n * @param {'X' | 'Y'} xyDir - direction\r\n * @param {ILayout} layout - presentation layout\r\n * @returns {number} calculated size\r\n */\r\nfunction getSmartParseNumber(size, xyDir, layout) {\r\n    // FIRST: Convert string numeric value if reqd\r\n    if (typeof size === 'string' && !isNaN(Number(size)))\r\n        size = Number(size);\r\n    // CASE 1: Number in inches\r\n    // Assume any number less than 100 is inches\r\n    if (typeof size === 'number' && size < 100)\r\n        return inch2Emu(size);\r\n    // CASE 2: Number is already converted to something other than inches\r\n    // Assume any number greater than 100 is not inches! Just return it (its EMU already i guess??)\r\n    if (typeof size === 'number' && size >= 100)\r\n        return size;\r\n    // CASE 3: Percentage (ex: '50%')\r\n    if (typeof size === 'string' && size.indexOf('%') > -1) {\r\n        if (xyDir && xyDir === 'X')\r\n            return Math.round((parseFloat(size) / 100) * layout.width);\r\n        if (xyDir && xyDir === 'Y')\r\n            return Math.round((parseFloat(size) / 100) * layout.height);\r\n        // Default: Assume width (x/cx)\r\n        return Math.round((parseFloat(size) / 100) * layout.width);\r\n    }\r\n    // LAST: Default value\r\n    return 0;\r\n}\r\n/**\r\n * Basic UUID Generator Adapted\r\n * @link https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript#answer-2117523\r\n * @param {string} uuidFormat - UUID format\r\n * @returns {string} UUID\r\n */\r\nfunction getUuid(uuidFormat) {\r\n    return uuidFormat.replace(/[xy]/g, function (c) {\r\n        var r = (Math.random() * 16) | 0, v = c === 'x' ? r : (r & 0x3) | 0x8;\r\n        return v.toString(16);\r\n    });\r\n}\r\n/**\r\n * TODO: What does this method do again??\r\n * shallow mix, returns new object\r\n */\r\nfunction getMix(o1, o2, etc) {\r\n    var objMix = {};\r\n    var _loop_1 = function (i) {\r\n        var oN = arguments_1[i];\r\n        if (oN)\r\n            Object.keys(oN).forEach(function (key) {\r\n                objMix[key] = oN[key];\r\n            });\r\n    };\r\n    var arguments_1 = arguments;\r\n    for (var i = 0; i <= arguments.length; i++) {\r\n        _loop_1(i);\r\n    }\r\n    return objMix;\r\n}\r\n/**\r\n * Replace special XML characters with HTML-encoded strings\r\n * @param {string} xml - XML string to encode\r\n * @returns {string} escaped XML\r\n */\r\nfunction encodeXmlEntities(xml) {\r\n    // NOTE: Dont use short-circuit eval here as value c/b \"0\" (zero) etc.!\r\n    if (typeof xml === 'undefined' || xml == null)\r\n        return '';\r\n    return xml\r\n        .toString()\r\n        .replace(/&/g, '&amp;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;')\r\n        .replace(/\"/g, '&quot;')\r\n        .replace(/'/g, '&apos;');\r\n}\r\n/**\r\n * Convert inches into EMU\r\n * @param {number|string} inches - as string or number\r\n * @returns {number} EMU value\r\n */\r\nfunction inch2Emu(inches) {\r\n    // FIRST: Provide Caller Safety: Numbers may get conv<->conv during flight, so be kind and do some simple checks to ensure inches were passed\r\n    // Any value over 100 damn sure isnt inches, must be EMU already, so just return it\r\n    if (typeof inches === 'number' && inches > 100)\r\n        return inches;\r\n    if (typeof inches === 'string')\r\n        inches = Number(inches.replace(/in*/gi, ''));\r\n    return Math.round(EMU * inches);\r\n}\r\n/**\r\n * Convert degrees (0..360) to PowerPoint `rot` value\r\n *\r\n * @param {number} d - degrees\r\n * @returns {number} rot - value\r\n */\r\nfunction convertRotationDegrees(d) {\r\n    d = d || 0;\r\n    return (d > 360 ? d - 360 : d) * 60000;\r\n}\r\n/**\r\n * Converts component value to hex value\r\n * @param {number} c - component color\r\n * @returns {string} hex string\r\n */\r\nfunction componentToHex(c) {\r\n    var hex = c.toString(16);\r\n    return hex.length === 1 ? '0' + hex : hex;\r\n}\r\n/**\r\n * Converts RGB colors from css selectors to Hex for Presentation colors\r\n * @param {number} r - red value\r\n * @param {number} g - green value\r\n * @param {number} b - blue value\r\n * @returns {string} XML string\r\n */\r\nfunction rgbToHex(r, g, b) {\r\n    return (componentToHex(r) + componentToHex(g) + componentToHex(b)).toUpperCase();\r\n}\r\n/**\r\n * Create either a `a:schemeClr` - (scheme color) or `a:srgbClr` (hexa representation).\r\n * @param {string} colorStr - hexa representation (eg. \"FFFF00\") or a scheme color constant (eg. pptx.colors.ACCENT1)\r\n * @param {string} innerElements - additional elements that adjust the color and are enclosed by the color element\r\n * @returns {string} XML string\r\n */\r\nfunction createColorElement(colorStr, innerElements) {\r\n    var isHexaRgb = REGEX_HEX_COLOR.test(colorStr);\r\n    if (!isHexaRgb && Object.values(SCHEME_COLOR_NAMES).indexOf(colorStr) === -1) {\r\n        console.warn('\"' + colorStr + '\" is not a valid scheme color or hexa RGB! \"' + DEF_FONT_COLOR + '\" is used as a fallback. Pass 6-digit RGB or `pptx.colors` values');\r\n        colorStr = DEF_FONT_COLOR;\r\n    }\r\n    var tagName = isHexaRgb ? 'srgbClr' : 'schemeClr';\r\n    var colorAttr = ' val=\"' + (isHexaRgb ? (colorStr || '').toUpperCase() : colorStr) + '\"';\r\n    return innerElements ? '<a:' + tagName + colorAttr + '>' + innerElements + '</a:' + tagName + '>' : '<a:' + tagName + colorAttr + '/>';\r\n}\r\n/**\r\n * Create color selection\r\n * @param {ShapeFill} shapeFill - options\r\n * @param {string} backColor - color string\r\n * @returns {string} XML string\r\n */\r\nfunction genXmlColorSelection(shapeFill, backColor) {\r\n    var colorVal = '';\r\n    var fillType = 'solid';\r\n    var internalElements = '';\r\n    var outText = '';\r\n    if (backColor && typeof backColor === 'string') {\r\n        outText += \"<p:bg><p:bgPr>\" + genXmlColorSelection(backColor.replace('#', '')) + \"<a:effectLst/></p:bgPr></p:bg>\";\r\n    }\r\n    if (shapeFill) {\r\n        if (typeof shapeFill === 'string')\r\n            colorVal = shapeFill;\r\n        else {\r\n            if (shapeFill.type)\r\n                fillType = shapeFill.type;\r\n            if (shapeFill.color)\r\n                colorVal = shapeFill.color;\r\n            if (shapeFill.alpha)\r\n                internalElements += \"<a:alpha val=\\\"\" + (100 - shapeFill.alpha) + \"000\\\"/>\";\r\n        }\r\n        switch (fillType) {\r\n            case 'solid':\r\n                outText += \"<a:solidFill>\" + createColorElement(colorVal, internalElements) + \"</a:solidFill>\";\r\n                break;\r\n            default:\r\n                outText += ''; // @note need a statement as having only \"break\" is removed by rollup, then tiggers \"no-default\" js-linter\r\n                break;\r\n        }\r\n    }\r\n    return outText;\r\n}\n\n/**\r\n * PptxGenJS: Table Generation\r\n */\r\n/**\r\n * Break text paragraphs into lines based upon table column width (e.g.: Magic Happens Here(tm))\r\n * @param {ITableCell} cell - table cell\r\n * @param {number} colWidth - table column width\r\n * @return {string[]} XML\r\n */\r\nfunction parseTextToLines(cell, colWidth) {\r\n    var CHAR = 2.2 + (cell.options && cell.options.autoPageCharWeight ? cell.options.autoPageCharWeight : 0); // Character Constant (An approximation of the Golden Ratio)\r\n    var CPL = (colWidth * EMU) / (((cell.options && cell.options.fontSize) || DEF_FONT_SIZE) / CHAR); // Chars-Per-Line\r\n    var arrLines = [];\r\n    var strCurrLine = '';\r\n    // A: Allow a single space/whitespace as cell text (user-requested feature)\r\n    if (cell.text && cell.text.toString().trim().length === 0)\r\n        return [' '];\r\n    // B: Remove leading/trailing spaces\r\n    var inStr = (cell.text || '').toString().trim();\r\n    // C: Build line array\r\n    inStr.split('\\n').forEach(function (line) {\r\n        line.split(' ').forEach(function (word) {\r\n            if (strCurrLine.length + word.length + 1 < CPL) {\r\n                strCurrLine += word + ' ';\r\n            }\r\n            else {\r\n                if (strCurrLine)\r\n                    arrLines.push(strCurrLine);\r\n                strCurrLine = word + ' ';\r\n            }\r\n        });\r\n        // All words for this line have been exhausted, flush buffer to new line, clear line var\r\n        if (strCurrLine)\r\n            arrLines.push(strCurrLine.trim() + CRLF);\r\n        strCurrLine = '';\r\n    });\r\n    // D: Remove trailing linebreak\r\n    arrLines[arrLines.length - 1] = arrLines[arrLines.length - 1].trim();\r\n    return arrLines;\r\n}\r\n/**\r\n * Takes an array of table rows and breaks into an array of slides, which contain the calculated amount of table rows that fit on that slide\r\n * @param {[ITableToSlidesCell[]?]} tableRows - HTMLElementID of the table\r\n * @param {ITableToSlidesOpts} tabOpts - array of options (e.g.: tabsize)\r\n * @param {ILayout} presLayout - Presentation layout\r\n * @param {ISlideLayout} masterSlide - master slide (if any)\r\n * @return {TableRowSlide[]} array of table rows\r\n */\r\nfunction getSlidesForTableRows(tableRows, tabOpts, presLayout, masterSlide) {\r\n    if (tableRows === void 0) { tableRows = []; }\r\n    if (tabOpts === void 0) { tabOpts = {}; }\r\n    var arrInchMargins = DEF_SLIDE_MARGIN_IN, emuTabCurrH = 0, emuSlideTabW = EMU * 1, emuSlideTabH = EMU * 1, numCols = 0, tableRowSlides = [\r\n        {\r\n            rows: [],\r\n        },\r\n    ];\r\n    if (tabOpts.verbose) {\r\n        console.log(\"-- VERBOSE MODE ----------------------------------\");\r\n        console.log(\".. (PARAMETERS)\");\r\n        console.log(\"presLayout.height ......... = \" + presLayout.height / EMU);\r\n        console.log(\"tabOpts.h ................. = \" + tabOpts.h);\r\n        console.log(\"tabOpts.w ................. = \" + tabOpts.w);\r\n        console.log(\"tabOpts.colW .............. = \" + tabOpts.colW);\r\n        console.log(\"tabOpts.slideMargin ....... = \" + (tabOpts.slideMargin || ''));\r\n        console.log(\".. (/PARAMETERS)\");\r\n    }\r\n    // STEP 1: Calculate margins\r\n    {\r\n        // Important: Use default size as zero cell margin is causing our tables to be too large and touch bottom of slide!\r\n        if (!tabOpts.slideMargin && tabOpts.slideMargin !== 0)\r\n            tabOpts.slideMargin = DEF_SLIDE_MARGIN_IN[0];\r\n        if (masterSlide && typeof masterSlide.margin !== 'undefined') {\r\n            if (Array.isArray(masterSlide.margin))\r\n                arrInchMargins = masterSlide.margin;\r\n            else if (!isNaN(Number(masterSlide.margin)))\r\n                arrInchMargins = [Number(masterSlide.margin), Number(masterSlide.margin), Number(masterSlide.margin), Number(masterSlide.margin)];\r\n        }\r\n        else if (tabOpts.slideMargin || tabOpts.slideMargin === 0) {\r\n            if (Array.isArray(tabOpts.slideMargin))\r\n                arrInchMargins = tabOpts.slideMargin;\r\n            else if (!isNaN(tabOpts.slideMargin))\r\n                arrInchMargins = [tabOpts.slideMargin, tabOpts.slideMargin, tabOpts.slideMargin, tabOpts.slideMargin];\r\n        }\r\n        if (tabOpts.verbose)\r\n            console.log('arrInchMargins ......... = ' + arrInchMargins.toString());\r\n    }\r\n    // STEP 2: Calculate number of columns\r\n    {\r\n        // NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\r\n        // ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\r\n        tableRows[0].forEach(function (cell) {\r\n            if (!cell)\r\n                cell = { type: SLIDE_OBJECT_TYPES.tablecell };\r\n            var cellOpts = cell.options || null;\r\n            numCols += Number(cellOpts && cellOpts.colspan ? cellOpts.colspan : 1);\r\n        });\r\n        if (tabOpts.verbose)\r\n            console.log('numCols ................ = ' + numCols);\r\n    }\r\n    // STEP 3: Calculate tabOpts.w if tabOpts.colW was provided\r\n    if (!tabOpts.w && tabOpts.colW) {\r\n        if (Array.isArray(tabOpts.colW))\r\n            tabOpts.colW.forEach(function (val) {\r\n                typeof tabOpts.w !== 'number' ? (tabOpts.w = 0 + val) : (tabOpts.w += val);\r\n            });\r\n        else {\r\n            tabOpts.w = tabOpts.colW * numCols;\r\n        }\r\n    }\r\n    // STEP 4: Calculate usable space/table size (now that total usable space is known)\r\n    {\r\n        emuSlideTabW =\r\n            typeof tabOpts.w === 'number'\r\n                ? inch2Emu(tabOpts.w)\r\n                : presLayout.width - inch2Emu((typeof tabOpts.x === 'number' ? tabOpts.x : arrInchMargins[1]) + arrInchMargins[3]);\r\n        if (tabOpts.verbose)\r\n            console.log('emuSlideTabW (in) ...... = ' + (emuSlideTabW / EMU).toFixed(1));\r\n    }\r\n    // STEP 5: Calculate column widths if not provided (emuSlideTabW will be used below to determine lines-per-col)\r\n    if (!tabOpts.colW || !Array.isArray(tabOpts.colW)) {\r\n        if (tabOpts.colW && !isNaN(Number(tabOpts.colW))) {\r\n            var arrColW_1 = [];\r\n            tableRows[0].forEach(function () {\r\n                arrColW_1.push(tabOpts.colW);\r\n            });\r\n            tabOpts.colW = [];\r\n            arrColW_1.forEach(function (val) {\r\n                if (Array.isArray(tabOpts.colW))\r\n                    tabOpts.colW.push(val);\r\n            });\r\n        }\r\n        // No column widths provided? Then distribute cols.\r\n        else {\r\n            tabOpts.colW = [];\r\n            for (var iCol = 0; iCol < numCols; iCol++) {\r\n                tabOpts.colW.push(emuSlideTabW / EMU / numCols);\r\n            }\r\n        }\r\n    }\r\n    // STEP 6: **MAIN** Iterate over rows, add table content, create new slides as rows overflow\r\n    var iRow = 0;\r\n    var _loop_1 = function () {\r\n        var row = tableRows.shift();\r\n        iRow++;\r\n        // A: Row variables\r\n        var maxLineHeight = 0;\r\n        var linesRow = [];\r\n        var maxCellMarTopEmu = 0;\r\n        var maxCellMarBtmEmu = 0;\r\n        // B: Create new row in data model\r\n        var currSlide = tableRowSlides[tableRowSlides.length - 1];\r\n        var newRowSlide = [];\r\n        row.forEach(function (cell) {\r\n            newRowSlide.push({\r\n                type: SLIDE_OBJECT_TYPES.tablecell,\r\n                text: '',\r\n                options: cell.options,\r\n            });\r\n            if (cell.options.margin && cell.options.margin[0] && cell.options.margin[0] * ONEPT > maxCellMarTopEmu)\r\n                maxCellMarTopEmu = cell.options.margin[0] * ONEPT;\r\n            else if (tabOpts.margin && tabOpts.margin[0] && tabOpts.margin[0] * ONEPT > maxCellMarTopEmu)\r\n                maxCellMarTopEmu = tabOpts.margin[0] * ONEPT;\r\n            if (cell.options.margin && cell.options.margin[2] && cell.options.margin[2] * ONEPT > maxCellMarBtmEmu)\r\n                maxCellMarBtmEmu = cell.options.margin[2] * ONEPT;\r\n            else if (tabOpts.margin && tabOpts.margin[2] && tabOpts.margin[2] * ONEPT > maxCellMarBtmEmu)\r\n                maxCellMarBtmEmu = tabOpts.margin[2] * ONEPT;\r\n        });\r\n        // C: Calc usable vertical space/table height. Set default value first, adjust below when necessary.\r\n        emuSlideTabH =\r\n            tabOpts.h && typeof tabOpts.h === 'number'\r\n                ? tabOpts.h\r\n                : presLayout.height - inch2Emu(arrInchMargins[0] + arrInchMargins[2]) - (tabOpts.y && typeof tabOpts.y === 'number' ? tabOpts.y : 0);\r\n        if (tabOpts.verbose)\r\n            console.log('emuSlideTabH (in) ...... = ' + (emuSlideTabH / EMU).toFixed(1));\r\n        // D: RULE: Use margins for starting point after the initial Slide, not `opt.y` (ISSUE#43, ISSUE#47, ISSUE#48)\r\n        if (tableRowSlides.length > 1 && typeof tabOpts.newSlideStartY === 'number') {\r\n            emuSlideTabH = tabOpts.h && typeof tabOpts.h === 'number' ? tabOpts.h : presLayout.height - inch2Emu(tabOpts.newSlideStartY + arrInchMargins[2]);\r\n        }\r\n        else if (tableRowSlides.length > 1 && typeof tabOpts.y === 'number') {\r\n            emuSlideTabH = presLayout.height - inch2Emu((tabOpts.y / EMU < arrInchMargins[0] ? tabOpts.y / EMU : arrInchMargins[0]) + arrInchMargins[2]);\r\n            // Use whichever is greater: area between margins or the table H provided (dont shrink usable area - the whole point of over-riding X on paging is to *increarse* usable space)\r\n            if (typeof tabOpts.h === 'number' && emuSlideTabH < tabOpts.h)\r\n                emuSlideTabH = tabOpts.h;\r\n        }\r\n        else if (typeof tabOpts.h === 'number' && typeof tabOpts.y === 'number')\r\n            emuSlideTabH = tabOpts.h ? tabOpts.h : presLayout.height - inch2Emu((tabOpts.y / EMU || arrInchMargins[0]) + arrInchMargins[2]);\r\n        //if (tabOpts.verbose) console.log(`- SLIDE [${tableRowSlides.length}]: emuSlideTabH .. = ${(emuSlideTabH / EMU).toFixed(1)}`)\r\n        // E: **BUILD DATA SET** | Iterate over cells: split text into lines[], set `lineHeight`\r\n        row.forEach(function (cell, iCell) {\r\n            var newCell = {\r\n                type: SLIDE_OBJECT_TYPES.tablecell,\r\n                text: '',\r\n                options: cell.options,\r\n                lines: [],\r\n                lineHeight: inch2Emu(((cell.options && cell.options.fontSize ? cell.options.fontSize : tabOpts.fontSize ? tabOpts.fontSize : DEF_FONT_SIZE) *\r\n                    (LINEH_MODIFIER + (tabOpts.autoPageLineWeight ? tabOpts.autoPageLineWeight : 0))) /\r\n                    100),\r\n            };\r\n            //if (tabOpts.verbose) console.log(`- CELL [${iCell}]: newCell.lineHeight ..... = ${(newCell.lineHeight / EMU).toFixed(2)}`)\r\n            // 1: Exempt cells with `rowspan` from increasing lineHeight (or we could create a new slide when unecessary!)\r\n            if (newCell.options.rowspan)\r\n                newCell.lineHeight = 0;\r\n            // 2: The parseTextToLines method uses `autoPageCharWeight`, so inherit from table options\r\n            newCell.options.autoPageCharWeight = tabOpts.autoPageCharWeight ? tabOpts.autoPageCharWeight : null;\r\n            // 3: **MAIN** Parse cell contents into lines based upon col width, font, etc\r\n            newCell.lines = parseTextToLines(cell, tabOpts.colW[iCell] / ONEPT);\r\n            // 4: Add to array\r\n            linesRow.push(newCell);\r\n        });\r\n        // F: Start row height with margins\r\n        if (tabOpts.verbose)\r\n            console.log(\"- SLIDE [\" + tableRowSlides.length + \"]: ROW [\" + iRow + \"]: maxCellMarTopEmu=\" + maxCellMarTopEmu + \" / maxCellMarBtmEmu=\" + maxCellMarBtmEmu);\r\n        emuTabCurrH += maxCellMarTopEmu + maxCellMarBtmEmu;\r\n        // G: Only create a new row if there is room, otherwise, it'll be an empty row as \"A:\" below will create a new Slide before loop can populate this row\r\n        if (emuTabCurrH + maxLineHeight <= emuSlideTabH)\r\n            currSlide.rows.push(newRowSlide);\r\n        /* H: **PAGE DATA SET**\r\n         * Add text one-line-a-time to this row's cells until: lines are exhausted OR table height limit is hit\r\n         * Design: Building cells L-to-R/loop style wont work as one could be 100 lines and another 1 line.\r\n         * Therefore, build the whole row, 1-line-at-a-time, spanning all columns.\r\n         * That way, when the vertical size limit is hit, all lines pick up where they need to on the subsequent slide.\r\n         */\r\n        if (tabOpts.verbose)\r\n            console.log(\"- SLIDE [\" + tableRowSlides.length + \"]: ROW [\" + iRow + \"]: START...\");\r\n        var _loop_2 = function () {\r\n            // A: Add new Slide if there is no more space to fix 1 new line\r\n            if (emuTabCurrH + maxLineHeight > emuSlideTabH) {\r\n                if (tabOpts.verbose)\r\n                    console.log(\"** NEW SLIDE CREATED *****************************************\" +\r\n                        (\" (why?): \" + (emuTabCurrH / EMU).toFixed(2) + \"+\" + (maxLineHeight / EMU).toFixed(2) + \" > \" + emuSlideTabH / EMU));\r\n                // 1: Add a new slide\r\n                tableRowSlides.push({\r\n                    rows: [],\r\n                });\r\n                // 2: Reset current table height for new Slide\r\n                emuTabCurrH = 0; // This row's emuRowH w/b added below\r\n                // 3: Handle \"addHeaderToEach\" option /or/ Add new empty row to continue current lines into\r\n                if (tabOpts.addHeaderToEach && tabOpts._arrObjTabHeadRows) {\r\n                    // A: Add remaining cell lines\r\n                    var newRowSlide_1 = [];\r\n                    linesRow.forEach(function (cell) {\r\n                        newRowSlide_1.push({\r\n                            type: SLIDE_OBJECT_TYPES.tablecell,\r\n                            text: cell.lines.join(''),\r\n                            options: cell.options,\r\n                        });\r\n                    });\r\n                    tableRows.unshift(newRowSlide_1);\r\n                    // B: Add header row(s)\r\n                    newRowSlide_1 = [];\r\n                    tabOpts._arrObjTabHeadRows[0].forEach(function (cell) {\r\n                        newRowSlide_1.push(cell);\r\n                    });\r\n                    tableRows.unshift(newRowSlide_1);\r\n                    return \"break\";\r\n                }\r\n                else {\r\n                    // A: Add new row to new slide\r\n                    var currSlide_1 = tableRowSlides[tableRowSlides.length - 1];\r\n                    var newRowSlide_2 = [];\r\n                    row.forEach(function (cell) {\r\n                        newRowSlide_2.push({\r\n                            type: SLIDE_OBJECT_TYPES.tablecell,\r\n                            text: '',\r\n                            options: cell.options,\r\n                        });\r\n                    });\r\n                    currSlide_1.rows.push(newRowSlide_2);\r\n                }\r\n            }\r\n            // B: Add a line of text to 1-N cells that still have `lines`\r\n            linesRow.forEach(function (cell, idxR) {\r\n                if (cell.lines.length > 0) {\r\n                    // 1\r\n                    var currSlide_2 = tableRowSlides[tableRowSlides.length - 1];\r\n                    currSlide_2.rows[currSlide_2.rows.length - 1][idxR].text +=\r\n                        (currSlide_2.rows[currSlide_2.rows.length - 1][idxR].text.length > 0 && !RegExp(/\\n$/g).test(currSlide_2.rows[currSlide_2.rows.length - 1][idxR].text)\r\n                            ? CRLF\r\n                            : '').replace(/[\\r\\n]+$/g, CRLF) + cell.lines.shift();\r\n                    // 2\r\n                    if (cell.lineHeight > maxLineHeight)\r\n                        maxLineHeight = cell.lineHeight;\r\n                }\r\n            });\r\n            // C: Increase table height by one line height as 1-N cells below are\r\n            emuTabCurrH += maxLineHeight;\r\n            if (tabOpts.verbose)\r\n                console.log(\"- SLIDE [\" + tableRowSlides.length + \"]: ROW [\" + iRow + \"]: one line added ... emuTabCurrH = \" + (emuTabCurrH / EMU).toFixed(2));\r\n        };\r\n        while (linesRow.filter(function (cell) { return cell.lines.length > 0; }).length > 0) {\r\n            var state_1 = _loop_2();\r\n            if (state_1 === \"break\")\r\n                break;\r\n        }\r\n        if (tabOpts.verbose)\r\n            console.log(\"- SLIDE [\" + tableRowSlides.length + \"]: ROW [\" + iRow + \"]: ...COMPLETE ...... emuTabCurrH = \" + (emuTabCurrH / EMU).toFixed(2) + \" ( emuSlideTabH = \" + (emuSlideTabH / EMU).toFixed(2) + \" )\");\r\n    };\r\n    while (tableRows.length > 0) {\r\n        _loop_1();\r\n    }\r\n    if (tabOpts.verbose) {\r\n        console.log(\"\\n|================================================|\\n| FINAL: tableRowSlides.length = \" + tableRowSlides.length);\r\n        console.log(tableRowSlides);\r\n        //console.log(JSON.stringify(tableRowSlides,null,2))\r\n        console.log(\"|================================================|\\n\\n\");\r\n    }\r\n    return tableRowSlides;\r\n}\r\n/**\r\n * Reproduces an HTML table as a PowerPoint table - including column widths, style, etc. - creates 1 or more slides as needed\r\n * @param {string} tabEleId - HTMLElementID of the table\r\n * @param {ITableToSlidesOpts} inOpts - array of options (e.g.: tabsize)\r\n */\r\nfunction genTableToSlides(pptx, tabEleId, options, masterSlide) {\r\n    if (options === void 0) { options = {}; }\r\n    var opts = options || {};\r\n    opts.slideMargin = opts.slideMargin || opts.slideMargin === 0 ? opts.slideMargin : 0.5;\r\n    var emuSlideTabW = opts.w || pptx.presLayout.width;\r\n    var arrObjTabHeadRows = [];\r\n    var arrObjTabBodyRows = [];\r\n    var arrObjTabFootRows = [];\r\n    var arrColW = [];\r\n    var arrTabColW = [];\r\n    var arrInchMargins = [0.5, 0.5, 0.5, 0.5]; // TRBL-style\r\n    var intTabW = 0;\r\n    // REALITY-CHECK:\r\n    if (!document.getElementById(tabEleId))\r\n        throw new Error('tableToSlides: Table ID \"' + tabEleId + '\" does not exist!');\r\n    // STEP 1: Set margins\r\n    if (masterSlide && masterSlide.margin) {\r\n        if (Array.isArray(masterSlide.margin))\r\n            arrInchMargins = masterSlide.margin;\r\n        else if (!isNaN(masterSlide.margin))\r\n            arrInchMargins = [masterSlide.margin, masterSlide.margin, masterSlide.margin, masterSlide.margin];\r\n        opts.slideMargin = arrInchMargins;\r\n    }\r\n    else if (opts && opts.slideMargin) {\r\n        if (Array.isArray(opts.slideMargin))\r\n            arrInchMargins = opts.slideMargin;\r\n        else if (!isNaN(opts.slideMargin))\r\n            arrInchMargins = [opts.slideMargin, opts.slideMargin, opts.slideMargin, opts.slideMargin];\r\n    }\r\n    emuSlideTabW = (opts.w ? inch2Emu(opts.w) : pptx.presLayout.width) - inch2Emu(arrInchMargins[1] + arrInchMargins[3]);\r\n    if (opts.verbose)\r\n        console.log('-- VERBOSE MODE ----------------------------------');\r\n    if (opts.verbose)\r\n        console.log(\"opts.h ................. = \" + opts.h);\r\n    if (opts.verbose)\r\n        console.log(\"opts.w ................. = \" + opts.w);\r\n    if (opts.verbose)\r\n        console.log(\"pptx.presLayout.width .. = \" + pptx.presLayout.width / EMU);\r\n    if (opts.verbose)\r\n        console.log(\"emuSlideTabW (in)....... = \" + emuSlideTabW / EMU);\r\n    // STEP 2: Grab table col widths - just find the first availble row, either thead/tbody/tfoot, others may have colspsna,s who cares, we only need col widths from 1\r\n    var firstRowCells = document.querySelectorAll(\"#\" + tabEleId + \" tr:first-child th\");\r\n    if (firstRowCells.length === 0)\r\n        firstRowCells = document.querySelectorAll(\"#\" + tabEleId + \" tr:first-child td\");\r\n    firstRowCells.forEach(function (cell) {\r\n        if (cell.getAttribute('colspan')) {\r\n            // Guesstimate (divide evenly) col widths\r\n            // NOTE: both j$query and vanilla selectors return {0} when table is not visible)\r\n            for (var idxc = 0; idxc < Number(cell.getAttribute('colspan')); idxc++) {\r\n                arrTabColW.push(Math.round(cell.offsetWidth / Number(cell.getAttribute('colspan'))));\r\n            }\r\n        }\r\n        else {\r\n            arrTabColW.push(cell.offsetWidth);\r\n        }\r\n    });\r\n    arrTabColW.forEach(function (colW) {\r\n        intTabW += colW;\r\n    });\r\n    // STEP 3: Calc/Set column widths by using same column width percent from HTML table\r\n    arrTabColW.forEach(function (colW, idxW) {\r\n        var intCalcWidth = Number(((Number(emuSlideTabW) * ((colW / intTabW) * 100)) / 100 / EMU).toFixed(2));\r\n        var intMinWidth = 0;\r\n        var colSelectorMin = document.querySelector(\"#\" + tabEleId + \" thead tr:first-child th:nth-child(\" + (idxW + 1) + \")\");\r\n        if (colSelectorMin)\r\n            intMinWidth = Number(colSelectorMin.getAttribute('data-pptx-min-width'));\r\n        var colSelectorSet = document.querySelector(\"#\" + tabEleId + \" thead tr:first-child th:nth-child(\" + (idxW + 1) + \")\");\r\n        if (colSelectorSet)\r\n            intMinWidth = Number(colSelectorSet.getAttribute('data-pptx-width'));\r\n        arrColW.push( intMinWidth > intCalcWidth ? intMinWidth : intCalcWidth);\r\n    });\r\n    if (opts.verbose) {\r\n        console.log(\"arrColW ................ = \" + arrColW.toString());\r\n    }\r\n    ['thead', 'tbody', 'tfoot'].forEach(function (part) {\r\n        document.querySelectorAll(\"#\" + tabEleId + \" \" + part + \" tr\").forEach(function (row) {\r\n            var arrObjTabCells = [];\r\n            Array.from(row.cells).forEach(function (cell) {\r\n                // A: Get RGB text/bkgd colors\r\n                var arrRGB1 = window\r\n                    .getComputedStyle(cell)\r\n                    .getPropertyValue('color')\r\n                    .replace(/\\s+/gi, '')\r\n                    .replace('rgba(', '')\r\n                    .replace('rgb(', '')\r\n                    .replace(')', '')\r\n                    .split(',');\r\n                var arrRGB2 = window\r\n                    .getComputedStyle(cell)\r\n                    .getPropertyValue('background-color')\r\n                    .replace(/\\s+/gi, '')\r\n                    .replace('rgba(', '')\r\n                    .replace('rgb(', '')\r\n                    .replace(')', '')\r\n                    .split(',');\r\n                if (\r\n                // NOTE: (ISSUE#57): Default for unstyled tables is black bkgd, so use white instead\r\n                window.getComputedStyle(cell).getPropertyValue('background-color') === 'rgba(0, 0, 0, 0)' ||\r\n                    window.getComputedStyle(cell).getPropertyValue('transparent')) {\r\n                    arrRGB2 = ['255', '255', '255'];\r\n                }\r\n                // B: Create option object\r\n                var cellOpts = {\r\n                    align: null,\r\n                    bold: window.getComputedStyle(cell).getPropertyValue('font-weight') === 'bold' ||\r\n                        Number(window.getComputedStyle(cell).getPropertyValue('font-weight')) >= 500\r\n                        ? true\r\n                        : false,\r\n                    border: null,\r\n                    color: rgbToHex(Number(arrRGB1[0]), Number(arrRGB1[1]), Number(arrRGB1[2])),\r\n                    fill: rgbToHex(Number(arrRGB2[0]), Number(arrRGB2[1]), Number(arrRGB2[2])),\r\n                    fontFace: (window.getComputedStyle(cell).getPropertyValue('font-family') || '')\r\n                        .split(',')[0]\r\n                        .replace(/\"/g, '')\r\n                        .replace('inherit', '')\r\n                        .replace('initial', '') || null,\r\n                    fontSize: Number(window\r\n                        .getComputedStyle(cell)\r\n                        .getPropertyValue('font-size')\r\n                        .replace(/[a-z]/gi, '')),\r\n                    margin: null,\r\n                    colspan: Number(cell.getAttribute('colspan')) || null,\r\n                    rowspan: Number(cell.getAttribute('rowspan')) || null,\r\n                    valign: null,\r\n                };\r\n                if (['left', 'center', 'right', 'start', 'end'].indexOf(window.getComputedStyle(cell).getPropertyValue('text-align')) > -1) {\r\n                    var align = window\r\n                        .getComputedStyle(cell)\r\n                        .getPropertyValue('text-align')\r\n                        .replace('start', 'left')\r\n                        .replace('end', 'right');\r\n                    cellOpts.align = align === 'center' ? 'center' : align === 'left' ? 'left' : align === 'right' ? 'right' : null;\r\n                }\r\n                if (['top', 'middle', 'bottom'].indexOf(window.getComputedStyle(cell).getPropertyValue('vertical-align')) > -1) {\r\n                    var valign = window.getComputedStyle(cell).getPropertyValue('vertical-align');\r\n                    cellOpts.valign = valign === 'top' ? 'top' : valign === 'middle' ? 'middle' : valign === 'bottom' ? 'bottom' : null;\r\n                }\r\n                // C: Add padding [margin] (if any)\r\n                // NOTE: Margins translate: px->pt 1:1 (e.g.: a 20px padded cell looks the same in PPTX as 20pt Text Inset/Padding)\r\n                if (window.getComputedStyle(cell).getPropertyValue('padding-left')) {\r\n                    cellOpts.margin = [0, 0, 0, 0];\r\n                    var sidesPad = ['padding-top', 'padding-right', 'padding-bottom', 'padding-left'];\r\n                    sidesPad.forEach(function (val, idxs) {\r\n                        cellOpts.margin[idxs] = Math.round(Number(window\r\n                            .getComputedStyle(cell)\r\n                            .getPropertyValue(val)\r\n                            .replace(/\\D/gi, '')));\r\n                    });\r\n                }\r\n                // D: Add border (if any)\r\n                if (window.getComputedStyle(cell).getPropertyValue('border-top-width') ||\r\n                    window.getComputedStyle(cell).getPropertyValue('border-right-width') ||\r\n                    window.getComputedStyle(cell).getPropertyValue('border-bottom-width') ||\r\n                    window.getComputedStyle(cell).getPropertyValue('border-left-width')) {\r\n                    cellOpts.border = [null, null, null, null];\r\n                    var sidesBor = ['top', 'right', 'bottom', 'left'];\r\n                    sidesBor.forEach(function (val, idxb) {\r\n                        var intBorderW = Math.round(Number(window\r\n                            .getComputedStyle(cell)\r\n                            .getPropertyValue('border-' + val + '-width')\r\n                            .replace('px', '')));\r\n                        var arrRGB = [];\r\n                        arrRGB = window\r\n                            .getComputedStyle(cell)\r\n                            .getPropertyValue('border-' + val + '-color')\r\n                            .replace(/\\s+/gi, '')\r\n                            .replace('rgba(', '')\r\n                            .replace('rgb(', '')\r\n                            .replace(')', '')\r\n                            .split(',');\r\n                        var strBorderC = rgbToHex(Number(arrRGB[0]), Number(arrRGB[1]), Number(arrRGB[2]));\r\n                        cellOpts.border[idxb] = { pt: intBorderW, color: strBorderC };\r\n                    });\r\n                }\r\n                // LAST: Add cell\r\n                arrObjTabCells.push({\r\n                    type: SLIDE_OBJECT_TYPES.tablecell,\r\n                    text: cell.innerText,\r\n                    options: cellOpts,\r\n                });\r\n            });\r\n            switch (part) {\r\n                case 'thead':\r\n                    arrObjTabHeadRows.push(arrObjTabCells);\r\n                    break;\r\n                case 'tbody':\r\n                    arrObjTabBodyRows.push(arrObjTabCells);\r\n                    break;\r\n                case 'tfoot':\r\n                    arrObjTabFootRows.push(arrObjTabCells);\r\n                    break;\r\n                default:\r\n                    console.log(\"table parsing: unexpected table part: \" + part);\r\n                    break;\r\n            }\r\n        });\r\n    });\r\n    // STEP 5: Break table into Slides as needed\r\n    // Pass head-rows as there is an option to add to each table and the parse func needs this data to fulfill that option\r\n    opts._arrObjTabHeadRows = arrObjTabHeadRows || null;\r\n    opts.colW = arrColW;\r\n    getSlidesForTableRows(arrObjTabHeadRows.concat(arrObjTabBodyRows, arrObjTabFootRows), opts, pptx.presLayout, masterSlide).forEach(function (slide, idxTr) {\r\n        // A: Create new Slide\r\n        var newSlide = pptx.addSlide(opts.masterSlideName || null);\r\n        // B: DESIGN: Reset `y` to `newSlideStartY` or margin after first Slide (ISSUE#43, ISSUE#47, ISSUE#48)\r\n        if (idxTr === 0)\r\n            opts.y = opts.y || arrInchMargins[0];\r\n        if (idxTr > 0)\r\n            opts.y = opts.newSlideStartY || arrInchMargins[0];\r\n        if (opts.verbose)\r\n            console.log('opts.newSlideStartY:' + opts.newSlideStartY + ' / arrInchMargins[0]:' + arrInchMargins[0] + ' => opts.y = ' + opts.y);\r\n        // C: Add table to Slide\r\n        newSlide.addTable(slide.rows, { x: opts.x || arrInchMargins[3], y: opts.y, w: Number(emuSlideTabW) / EMU, colW: arrColW, autoPage: false });\r\n        // D: Add any additional objects\r\n        if (opts.addImage)\r\n            newSlide.addImage({ path: opts.addImage.url, x: opts.addImage.x, y: opts.addImage.y, w: opts.addImage.w, h: opts.addImage.h });\r\n        if (opts.addShape)\r\n            newSlide.addShape(opts.addShape.shape, opts.addShape.opts || {});\r\n        if (opts.addTable)\r\n            newSlide.addTable(opts.addTable.rows, opts.addTable.opts || {});\r\n        if (opts.addText)\r\n            newSlide.addText(opts.addText.text, opts.addText.opts || {});\r\n    });\r\n}\n\n/**\r\n* PptxGenJS: All PowerPoint Shapes\r\n*/\r\nvar PowerPointShapes = Object.freeze({\r\n    ACTION_BUTTON_BACK_OR_PREVIOUS: {\r\n        'displayName': 'Action Button: Back or Previous',\r\n        'name': 'actionButtonBackPrevious',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_BEGINNING: {\r\n        'displayName': 'Action Button: Beginning',\r\n        'name': 'actionButtonBeginning',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_CUSTOM: {\r\n        'displayName': 'Action Button: Custom',\r\n        'name': 'actionButtonBlank',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_DOCUMENT: {\r\n        'displayName': 'Action Button: Document',\r\n        'name': 'actionButtonDocument',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_END: {\r\n        'displayName': 'Action Button: End',\r\n        'name': 'actionButtonEnd',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_FORWARD_OR_NEXT: {\r\n        'displayName': 'Action Button: Forward or Next',\r\n        'name': 'actionButtonForwardNext',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_HELP: {\r\n        'displayName': 'Action Button: Help',\r\n        'name': 'actionButtonHelp',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_HOME: {\r\n        'displayName': 'Action Button: Home',\r\n        'name': 'actionButtonHome',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_INFORMATION: {\r\n        'displayName': 'Action Button: Information',\r\n        'name': 'actionButtonInformation',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_MOVIE: {\r\n        'displayName': 'Action Button: Movie',\r\n        'name': 'actionButtonMovie',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_RETURN: {\r\n        'displayName': 'Action Button: Return',\r\n        'name': 'actionButtonReturn',\r\n        'avLst': {}\r\n    },\r\n    ACTION_BUTTON_SOUND: {\r\n        'displayName': 'Action Button: Sound',\r\n        'name': 'actionButtonSound',\r\n        'avLst': {}\r\n    },\r\n    ARC: {\r\n        'displayName': 'Arc',\r\n        'name': 'arc',\r\n        'avLst': {\r\n            'adj1': 16200000,\r\n            'adj2': 0\r\n        }\r\n    },\r\n    BALLOON: {\r\n        'displayName': 'Rounded Rectangular Callout',\r\n        'name': 'wedgeRoundRectCallout',\r\n        'avLst': {\r\n            'adj1': -20833,\r\n            'adj2': 62500,\r\n            'adj3': 16667\r\n        }\r\n    },\r\n    BENT_ARROW: {\r\n        'displayName': 'Bent Arrow',\r\n        'name': 'bentArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000,\r\n            'adj4': 43750\r\n        }\r\n    },\r\n    BENT_UP_ARROW: {\r\n        'displayName': 'Bent-Up Arrow',\r\n        'name': 'bentUpArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000\r\n        }\r\n    },\r\n    BEVEL: {\r\n        'displayName': 'Bevel',\r\n        'name': 'bevel',\r\n        'avLst': {\r\n            'adj': 12500\r\n        }\r\n    },\r\n    BLOCK_ARC: {\r\n        'displayName': 'Block Arc',\r\n        'name': 'blockArc',\r\n        'avLst': {\r\n            'adj1': 10800000,\r\n            'adj2': 0,\r\n            'adj3': 25000\r\n        }\r\n    },\r\n    CAN: {\r\n        'displayName': 'Can',\r\n        'name': 'can',\r\n        'avLst': {\r\n            'adj': 25000\r\n        }\r\n    },\r\n    CHART_PLUS: {\r\n        'displayName': 'Chart Plus',\r\n        'name': 'chartPlus',\r\n        'avLst': {}\r\n    },\r\n    CHART_STAR: {\r\n        'displayName': 'Chart Star',\r\n        'name': 'chartStar',\r\n        'avLst': {}\r\n    },\r\n    CHART_X: {\r\n        'displayName': 'Chart X',\r\n        'name': 'chartX',\r\n        'avLst': {}\r\n    },\r\n    CHEVRON: {\r\n        'displayName': 'Chevron',\r\n        'name': 'chevron',\r\n        'avLst': {\r\n            'adj': 50000\r\n        }\r\n    },\r\n    CHORD: {\r\n        'displayName': 'Chord',\r\n        'name': 'chord',\r\n        'avLst': {\r\n            'adj1': 2700000,\r\n            'adj2': 16200000\r\n        }\r\n    },\r\n    CIRCULAR_ARROW: {\r\n        'displayName': 'Circular Arrow',\r\n        'name': 'circularArrow',\r\n        'avLst': {\r\n            'adj1': 12500,\r\n            'adj2': 1142319,\r\n            'adj3': 20457681,\r\n            'adj4': 10800000,\r\n            'adj5': 12500\r\n        }\r\n    },\r\n    CLOUD: {\r\n        'displayName': 'Cloud',\r\n        'name': 'cloud',\r\n        'avLst': {}\r\n    },\r\n    CLOUD_CALLOUT: {\r\n        'displayName': 'Cloud Callout',\r\n        'name': 'cloudCallout',\r\n        'avLst': {\r\n            'adj1': -20833,\r\n            'adj2': 62500\r\n        }\r\n    },\r\n    CORNER: {\r\n        'displayName': 'Corner',\r\n        'name': 'corner',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    CORNER_TABS: {\r\n        'displayName': 'Corner Tabs',\r\n        'name': 'cornerTabs',\r\n        'avLst': {}\r\n    },\r\n    CROSS: {\r\n        'displayName': 'Cross',\r\n        'name': 'plus',\r\n        'avLst': {\r\n            'adj': 25000\r\n        }\r\n    },\r\n    CUBE: {\r\n        'displayName': 'Cube',\r\n        'name': 'cube',\r\n        'avLst': {\r\n            'adj': 25000\r\n        }\r\n    },\r\n    CURVED_DOWN_ARROW: {\r\n        'displayName': 'Curved Down Arrow',\r\n        'name': 'curvedDownArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 50000,\r\n            'adj3': 25000\r\n        }\r\n    },\r\n    CURVED_DOWN_RIBBON: {\r\n        'displayName': 'Curved Down Ribbon',\r\n        'name': 'ellipseRibbon',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 50000,\r\n            'adj3': 12500\r\n        }\r\n    },\r\n    CURVED_LEFT_ARROW: {\r\n        'displayName': 'Curved Left Arrow',\r\n        'name': 'curvedLeftArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 50000,\r\n            'adj3': 25000\r\n        }\r\n    },\r\n    CURVED_RIGHT_ARROW: {\r\n        'displayName': 'Curved Right Arrow',\r\n        'name': 'curvedRightArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 50000,\r\n            'adj3': 25000\r\n        }\r\n    },\r\n    CURVED_UP_ARROW: {\r\n        'displayName': 'Curved Up Arrow',\r\n        'name': 'curvedUpArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 50000,\r\n            'adj3': 25000\r\n        }\r\n    },\r\n    CURVED_UP_RIBBON: {\r\n        'displayName': 'Curved Up Ribbon',\r\n        'name': 'ellipseRibbon2',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 50000,\r\n            'adj3': 12500\r\n        }\r\n    },\r\n    DECAGON: {\r\n        'displayName': 'Decagon',\r\n        'name': 'decagon',\r\n        'avLst': {\r\n            'vf': 105146\r\n        }\r\n    },\r\n    DIAGONAL_STRIPE: {\r\n        'displayName': 'Diagonal Stripe',\r\n        'name': 'diagStripe',\r\n        'avLst': {\r\n            'adj': 50000\r\n        }\r\n    },\r\n    DIAMOND: {\r\n        'displayName': 'Diamond',\r\n        'name': 'diamond',\r\n        'avLst': {}\r\n    },\r\n    DODECAGON: {\r\n        'displayName': 'Dodecagon',\r\n        'name': 'dodecagon',\r\n        'avLst': {}\r\n    },\r\n    DONUT: {\r\n        'displayName': 'Donut',\r\n        'name': 'donut',\r\n        'avLst': {\r\n            'adj': 25000\r\n        }\r\n    },\r\n    DOUBLE_BRACE: {\r\n        'displayName': 'Double Brace',\r\n        'name': 'bracePair',\r\n        'avLst': {\r\n            'adj': 8333\r\n        }\r\n    },\r\n    DOUBLE_BRACKET: {\r\n        'displayName': 'Double Bracket',\r\n        'name': 'bracketPair',\r\n        'avLst': {\r\n            'adj': 16667\r\n        }\r\n    },\r\n    DOUBLE_WAVE: {\r\n        'displayName': 'Double Wave',\r\n        'name': 'doubleWave',\r\n        'avLst': {\r\n            'adj1': 6250,\r\n            'adj2': 0\r\n        }\r\n    },\r\n    DOWN_ARROW: {\r\n        'displayName': 'Down Arrow',\r\n        'name': 'downArrow',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    DOWN_ARROW_CALLOUT: {\r\n        'displayName': 'Down Arrow Callout',\r\n        'name': 'downArrowCallout',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000,\r\n            'adj4': 64977\r\n        }\r\n    },\r\n    DOWN_RIBBON: {\r\n        'displayName': 'Down Ribbon',\r\n        'name': 'ribbon',\r\n        'avLst': {\r\n            'adj1': 16667,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    EXPLOSION1: {\r\n        'displayName': 'Explosion',\r\n        'name': 'irregularSeal1',\r\n        'avLst': {}\r\n    },\r\n    EXPLOSION2: {\r\n        'displayName': 'Explosion',\r\n        'name': 'irregularSeal2',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_ALTERNATE_PROCESS: {\r\n        'displayName': 'Alternate process',\r\n        'name': 'flowChartAlternateProcess',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_CARD: {\r\n        'displayName': 'Card',\r\n        'name': 'flowChartPunchedCard',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_COLLATE: {\r\n        'displayName': 'Collate',\r\n        'name': 'flowChartCollate',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_CONNECTOR: {\r\n        'displayName': 'Connector',\r\n        'name': 'flowChartConnector',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_DATA: {\r\n        'displayName': 'Data',\r\n        'name': 'flowChartInputOutput',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_DECISION: {\r\n        'displayName': 'Decision',\r\n        'name': 'flowChartDecision',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_DELAY: {\r\n        'displayName': 'Delay',\r\n        'name': 'flowChartDelay',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_DIRECT_ACCESS_STORAGE: {\r\n        'displayName': 'Direct Access Storage',\r\n        'name': 'flowChartMagneticDrum',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_DISPLAY: {\r\n        'displayName': 'Display',\r\n        'name': 'flowChartDisplay',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_DOCUMENT: {\r\n        'displayName': 'Document',\r\n        'name': 'flowChartDocument',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_EXTRACT: {\r\n        'displayName': 'Extract',\r\n        'name': 'flowChartExtract',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_INTERNAL_STORAGE: {\r\n        'displayName': 'Internal Storage',\r\n        'name': 'flowChartInternalStorage',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_MAGNETIC_DISK: {\r\n        'displayName': 'Magnetic Disk',\r\n        'name': 'flowChartMagneticDisk',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_MANUAL_INPUT: {\r\n        'displayName': 'Manual Input',\r\n        'name': 'flowChartManualInput',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_MANUAL_OPERATION: {\r\n        'displayName': 'Manual Operation',\r\n        'name': 'flowChartManualOperation',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_MERGE: {\r\n        'displayName': 'Merge',\r\n        'name': 'flowChartMerge',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_MULTIDOCUMENT: {\r\n        'displayName': 'Multidocument',\r\n        'name': 'flowChartMultidocument',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_OFFLINE_STORAGE: {\r\n        'displayName': 'Offline Storage',\r\n        'name': 'flowChartOfflineStorage',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_OFFPAGE_CONNECTOR: {\r\n        'displayName': 'Off-page Connector',\r\n        'name': 'flowChartOffpageConnector',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_OR: {\r\n        'displayName': 'Or',\r\n        'name': 'flowChartOr',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_PREDEFINED_PROCESS: {\r\n        'displayName': 'Predefined Process',\r\n        'name': 'flowChartPredefinedProcess',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_PREPARATION: {\r\n        'displayName': 'Preparation',\r\n        'name': 'flowChartPreparation',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_PROCESS: {\r\n        'displayName': 'Process',\r\n        'name': 'flowChartProcess',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_PUNCHED_TAPE: {\r\n        'displayName': 'Punched Tape',\r\n        'name': 'flowChartPunchedTape',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_SEQUENTIAL_ACCESS_STORAGE: {\r\n        'displayName': 'Sequential Access Storage',\r\n        'name': 'flowChartMagneticTape',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_SORT: {\r\n        'displayName': 'Sort',\r\n        'name': 'flowChartSort',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_STORED_DATA: {\r\n        'displayName': 'Stored Data',\r\n        'name': 'flowChartOnlineStorage',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_SUMMING_JUNCTION: {\r\n        'displayName': 'Summing Junction',\r\n        'name': 'flowChartSummingJunction',\r\n        'avLst': {}\r\n    },\r\n    FLOWCHART_TERMINATOR: {\r\n        'displayName': 'Terminator',\r\n        'name': 'flowChartTerminator',\r\n        'avLst': {}\r\n    },\r\n    FOLDED_CORNER: {\r\n        'displayName': 'Folded Corner',\r\n        'name': 'folderCorner',\r\n        'avLst': {}\r\n    },\r\n    FRAME: {\r\n        'displayName': 'Frame',\r\n        'name': 'frame',\r\n        'avLst': {\r\n            'adj1': 12500\r\n        }\r\n    },\r\n    FUNNEL: {\r\n        'displayName': 'Funnel',\r\n        'name': 'funnel',\r\n        'avLst': {}\r\n    },\r\n    GEAR_6: {\r\n        'displayName': 'Gear 6',\r\n        'name': 'gear6',\r\n        'avLst': {\r\n            'adj1': 15000,\r\n            'adj2': 3526\r\n        }\r\n    },\r\n    GEAR_9: {\r\n        'displayName': 'Gear 9',\r\n        'name': 'gear9',\r\n        'avLst': {\r\n            'adj1': 10000,\r\n            'adj2': 1763\r\n        }\r\n    },\r\n    HALF_FRAME: {\r\n        'displayName': 'Half Frame',\r\n        'name': 'halfFrame',\r\n        'avLst': {\r\n            'adj1': 33333,\r\n            'adj2': 33333\r\n        }\r\n    },\r\n    HEART: {\r\n        'displayName': 'Heart',\r\n        'name': 'heart',\r\n        'avLst': {}\r\n    },\r\n    HEPTAGON: {\r\n        'displayName': 'Heptagon',\r\n        'name': 'heptagon',\r\n        'avLst': {\r\n            'hf': 102572,\r\n            'vf': 105210\r\n        }\r\n    },\r\n    HEXAGON: {\r\n        'displayName': 'Hexagon',\r\n        'name': 'hexagon',\r\n        'avLst': {\r\n            'adj': 25000,\r\n            'vf': 115470\r\n        }\r\n    },\r\n    HORIZONTAL_SCROLL: {\r\n        'displayName': 'Horizontal Scroll',\r\n        'name': 'horizontalScroll',\r\n        'avLst': {\r\n            'adj': 12500\r\n        }\r\n    },\r\n    ISOSCELES_TRIANGLE: {\r\n        'displayName': 'Isosceles Triangle',\r\n        'name': 'triangle',\r\n        'avLst': {\r\n            'adj': 50000\r\n        }\r\n    },\r\n    LEFT_ARROW: {\r\n        'displayName': 'Left Arrow',\r\n        'name': 'leftArrow',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    LEFT_ARROW_CALLOUT: {\r\n        'displayName': 'Left Arrow Callout',\r\n        'name': 'leftArrowCallout',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000,\r\n            'adj4': 64977\r\n        }\r\n    },\r\n    LEFT_BRACE: {\r\n        'displayName': 'Left Brace',\r\n        'name': 'leftBrace',\r\n        'avLst': {\r\n            'adj1': 8333,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    LEFT_BRACKET: {\r\n        'displayName': 'Left Bracket',\r\n        'name': 'leftBracket',\r\n        'avLst': {\r\n            'adj': 8333\r\n        }\r\n    },\r\n    LEFT_CIRCULAR_ARROW: {\r\n        'displayName': 'Left Circular Arrow',\r\n        'name': 'leftCircularArrow',\r\n        'avLst': {\r\n            'adj1': 12500,\r\n            'adj2': -1142319,\r\n            'adj3': 1142319,\r\n            'adj4': 10800000,\r\n            'adj5': 12500\r\n        }\r\n    },\r\n    LEFT_RIGHT_ARROW: {\r\n        'displayName': 'Left-Right Arrow',\r\n        'name': 'leftRightArrow',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    LEFT_RIGHT_ARROW_CALLOUT: {\r\n        'displayName': 'Left-Right Arrow Callout',\r\n        'name': 'leftRightArrowCallout',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000,\r\n            'adj4': 48123\r\n        }\r\n    },\r\n    LEFT_RIGHT_CIRCULAR_ARROW: {\r\n        'displayName': 'Left Right Circular Arrow',\r\n        'name': 'leftRightCircularArrow',\r\n        'avLst': {\r\n            'adj1': 12500,\r\n            'adj2': 1142319,\r\n            'adj3': 20457681,\r\n            'adj4': 11942319,\r\n            'adj5': 12500\r\n        }\r\n    },\r\n    LEFT_RIGHT_RIBBON: {\r\n        'displayName': 'Left Right Ribbon',\r\n        'name': 'leftRightRibbon',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000,\r\n            'adj3': 16667\r\n        }\r\n    },\r\n    LEFT_RIGHT_UP_ARROW: {\r\n        'displayName': 'Left-Right-Up Arrow',\r\n        'name': 'leftRightUpArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000\r\n        }\r\n    },\r\n    LEFT_UP_ARROW: {\r\n        'displayName': 'Left-Up Arrow',\r\n        'name': 'leftUpArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000\r\n        }\r\n    },\r\n    LIGHTNING_BOLT: {\r\n        'displayName': 'Lightning Bolt',\r\n        'name': 'lightningBolt',\r\n        'avLst': {}\r\n    },\r\n    LINE_CALLOUT_1: {\r\n        'displayName': 'Line Callout 1',\r\n        'name': 'borderCallout1',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 112500,\r\n            'adj4': -38333\r\n        }\r\n    },\r\n    LINE_CALLOUT_1_ACCENT_BAR: {\r\n        'displayName': 'Line Callout 1 {Accent Bar}',\r\n        'name': 'accentCallout1',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 112500,\r\n            'adj4': -38333\r\n        }\r\n    },\r\n    LINE_CALLOUT_1_BORDER_AND_ACCENT_BAR: {\r\n        'displayName': 'Line Callout 1 {Border and Accent Bar}',\r\n        'name': 'accentBorderCallout1',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 112500,\r\n            'adj4': -38333\r\n        }\r\n    },\r\n    LINE_CALLOUT_1_NO_BORDER: {\r\n        'displayName': 'Line Callout 1 {No Border}',\r\n        'name': 'callout1',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 112500,\r\n            'adj4': -38333\r\n        }\r\n    },\r\n    LINE_CALLOUT_2: {\r\n        'displayName': 'Line Callout 2',\r\n        'name': 'borderCallout2',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 112500,\r\n            'adj6': -46667\r\n        }\r\n    },\r\n    LINE_CALLOUT_2_ACCENT_BAR: {\r\n        'displayName': 'Line Callout 2 {Accent Bar}',\r\n        'name': 'accentCallout2',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 112500,\r\n            'adj6': -46667\r\n        }\r\n    },\r\n    LINE_CALLOUT_2_BORDER_AND_ACCENT_BAR: {\r\n        'displayName': 'Line Callout 2 {Border and Accent Bar}',\r\n        'name': 'accentBorderCallout2',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 112500,\r\n            'adj6': -46667\r\n        }\r\n    },\r\n    LINE_CALLOUT_2_NO_BORDER: {\r\n        'displayName': 'Line Callout 2 {No Border}',\r\n        'name': 'callout2',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 112500,\r\n            'adj6': -46667\r\n        }\r\n    },\r\n    LINE_CALLOUT_3: {\r\n        'displayName': 'Line Callout 3',\r\n        'name': 'borderCallout3',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 100000,\r\n            'adj6': -16667,\r\n            'adj7': 112963,\r\n            'adj8': -8333\r\n        }\r\n    },\r\n    LINE_CALLOUT_3_ACCENT_BAR: {\r\n        'displayName': 'Line Callout 3 {Accent Bar}',\r\n        'name': 'accentCallout3',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 100000,\r\n            'adj6': -16667,\r\n            'adj7': 112963,\r\n            'adj8': -8333\r\n        }\r\n    },\r\n    LINE_CALLOUT_3_BORDER_AND_ACCENT_BAR: {\r\n        'displayName': 'Line Callout 3 {Border and Accent Bar}',\r\n        'name': 'accentBorderCallout3',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 100000,\r\n            'adj6': -16667,\r\n            'adj7': 112963,\r\n            'adj8': -8333\r\n        }\r\n    },\r\n    LINE_CALLOUT_3_NO_BORDER: {\r\n        'displayName': 'Line Callout 3 {No Border}',\r\n        'name': 'callout3',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 100000,\r\n            'adj6': -16667,\r\n            'adj7': 112963,\r\n            'adj8': -8333\r\n        }\r\n    },\r\n    LINE_CALLOUT_4: {\r\n        'displayName': 'Line Callout 3',\r\n        'name': 'borderCallout3',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 100000,\r\n            'adj6': -16667,\r\n            'adj7': 112963,\r\n            'adj8': -8333\r\n        }\r\n    },\r\n    LINE_CALLOUT_4_ACCENT_BAR: {\r\n        'displayName': 'Line Callout 3 {Accent Bar}',\r\n        'name': 'accentCallout3',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 100000,\r\n            'adj6': -16667,\r\n            'adj7': 112963,\r\n            'adj8': -8333\r\n        }\r\n    },\r\n    LINE_CALLOUT_4_BORDER_AND_ACCENT_BAR: {\r\n        'displayName': 'Line Callout 3 {Border and Accent Bar}',\r\n        'name': 'accentBorderCallout3',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 100000,\r\n            'adj6': -16667,\r\n            'adj7': 112963,\r\n            'adj8': -8333\r\n        }\r\n    },\r\n    LINE_CALLOUT_4_NO_BORDER: {\r\n        'displayName': 'Line Callout 3 {No Border}',\r\n        'name': 'callout3',\r\n        'avLst': {\r\n            'adj1': 18750,\r\n            'adj2': -8333,\r\n            'adj3': 18750,\r\n            'adj4': -16667,\r\n            'adj5': 100000,\r\n            'adj6': -16667,\r\n            'adj7': 112963,\r\n            'adj8': -8333\r\n        }\r\n    },\r\n    LINE: {\r\n        'displayName': 'Line',\r\n        'name': 'line',\r\n        'avLst': {}\r\n    },\r\n    LINE_INVERSE: {\r\n        'displayName': 'Straight Connector',\r\n        'name': 'lineInv',\r\n        'avLst': {}\r\n    },\r\n    MATH_DIVIDE: {\r\n        'displayName': 'Division',\r\n        'name': 'mathDivide',\r\n        'avLst': {\r\n            'adj1': 23520,\r\n            'adj2': 5880,\r\n            'adj3': 11760\r\n        }\r\n    },\r\n    MATH_EQUAL: {\r\n        'displayName': 'Equal',\r\n        'name': 'mathEqual',\r\n        'avLst': {\r\n            'adj1': 23520,\r\n            'adj2': 11760\r\n        }\r\n    },\r\n    MATH_MINUS: {\r\n        'displayName': 'Minus',\r\n        'name': 'mathMinus',\r\n        'avLst': {\r\n            'adj1': 23520\r\n        }\r\n    },\r\n    MATH_MULTIPLY: {\r\n        'displayName': 'Multiply',\r\n        'name': 'mathMultiply',\r\n        'avLst': {\r\n            'adj1': 23520\r\n        }\r\n    },\r\n    MATH_NOT_EQUAL: {\r\n        'displayName': 'Not Equal',\r\n        'name': 'mathNotEqual',\r\n        'avLst': {\r\n            'adj1': 23520,\r\n            'adj2': 6600000,\r\n            'adj3': 11760\r\n        }\r\n    },\r\n    MATH_PLUS: {\r\n        'displayName': 'Plus',\r\n        'name': 'mathPlus',\r\n        'avLst': {\r\n            'adj1': 23520\r\n        }\r\n    },\r\n    MOON: {\r\n        'displayName': 'Moon',\r\n        'name': 'moon',\r\n        'avLst': {\r\n            'adj': 50000\r\n        }\r\n    },\r\n    NON_ISOSCELES_TRAPEZOID: {\r\n        'displayName': 'Non-isosceles Trapezoid',\r\n        'name': 'nonIsoscelesTrapezoid',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000\r\n        }\r\n    },\r\n    NOTCHED_RIGHT_ARROW: {\r\n        'displayName': 'Notched Right Arrow',\r\n        'name': 'notchedRightArrow',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    NO_SYMBOL: {\r\n        'displayName': '\"No\" symbol',\r\n        'name': 'noSmoking',\r\n        'avLst': {\r\n            'adj': 18750\r\n        }\r\n    },\r\n    OCTAGON: {\r\n        'displayName': 'Octagon',\r\n        'name': 'octagon',\r\n        'avLst': {\r\n            'adj': 29289\r\n        }\r\n    },\r\n    OVAL: {\r\n        'displayName': 'Oval',\r\n        'name': 'ellipse',\r\n        'avLst': {}\r\n    },\r\n    OVAL_CALLOUT: {\r\n        'displayName': 'Oval Callout',\r\n        'name': 'wedgeEllipseCallout',\r\n        'avLst': {\r\n            'adj1': -20833,\r\n            'adj2': 62500\r\n        }\r\n    },\r\n    PARALLELOGRAM: {\r\n        'displayName': 'Parallelogram',\r\n        'name': 'parallelogram',\r\n        'avLst': {\r\n            'adj': 25000\r\n        }\r\n    },\r\n    PENTAGON: {\r\n        'displayName': 'Pentagon',\r\n        'name': 'homePlate',\r\n        'avLst': {\r\n            'adj': 50000\r\n        }\r\n    },\r\n    PIE: {\r\n        'displayName': 'Pie',\r\n        'name': 'pie',\r\n        'avLst': {\r\n            'adj1': 0,\r\n            'adj2': 16200000\r\n        }\r\n    },\r\n    PIE_WEDGE: {\r\n        'displayName': 'Pie',\r\n        'name': 'pieWedge',\r\n        'avLst': {}\r\n    },\r\n    PLAQUE: {\r\n        'displayName': 'Plaque',\r\n        'name': 'plaque',\r\n        'avLst': {\r\n            'adj': 16667\r\n        }\r\n    },\r\n    PLAQUE_TABS: {\r\n        'displayName': 'Plaque Tabs',\r\n        'name': 'plaqueTabs',\r\n        'avLst': {}\r\n    },\r\n    QUAD_ARROW: {\r\n        'displayName': 'Quad Arrow',\r\n        'name': 'quadArrow',\r\n        'avLst': {\r\n            'adj1': 22500,\r\n            'adj2': 22500,\r\n            'adj3': 22500\r\n        }\r\n    },\r\n    QUAD_ARROW_CALLOUT: {\r\n        'displayName': 'Quad Arrow Callout',\r\n        'name': 'quadArrowCallout',\r\n        'avLst': {\r\n            'adj1': 18515,\r\n            'adj2': 18515,\r\n            'adj3': 18515,\r\n            'adj4': 48123\r\n        }\r\n    },\r\n    RECTANGLE: {\r\n        'displayName': 'Rectangle',\r\n        'name': 'rect',\r\n        'avLst': {}\r\n    },\r\n    RECTANGULAR_CALLOUT: {\r\n        'displayName': 'Rectangular Callout',\r\n        'name': 'wedgeRectCallout',\r\n        'avLst': {\r\n            'adj1': -20833,\r\n            'adj2': 62500\r\n        }\r\n    },\r\n    REGULAR_PENTAGON: {\r\n        'displayName': 'Regular Pentagon',\r\n        'name': 'pentagon',\r\n        'avLst': {\r\n            'hf': 105146,\r\n            'vf': 110557\r\n        }\r\n    },\r\n    RIGHT_ARROW: {\r\n        'displayName': 'Right Arrow',\r\n        'name': 'rightArrow',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    RIGHT_ARROW_CALLOUT: {\r\n        'displayName': 'Right Arrow Callout',\r\n        'name': 'rightArrowCallout',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000,\r\n            'adj4': 64977\r\n        }\r\n    },\r\n    RIGHT_BRACE: {\r\n        'displayName': 'Right Brace',\r\n        'name': 'rightBrace',\r\n        'avLst': {\r\n            'adj1': 8333,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    RIGHT_BRACKET: {\r\n        'displayName': 'Right Bracket',\r\n        'name': 'rightBracket',\r\n        'avLst': {\r\n            'adj': 8333\r\n        }\r\n    },\r\n    RIGHT_TRIANGLE: {\r\n        'displayName': 'Right Triangle',\r\n        'name': 'rtTriangle',\r\n        'avLst': {}\r\n    },\r\n    ROUNDED_RECTANGLE: {\r\n        'displayName': 'Rounded Rectangle',\r\n        'name': 'roundRect',\r\n        'avLst': {\r\n            'adj': 16667\r\n        }\r\n    },\r\n    ROUNDED_RECTANGULAR_CALLOUT: {\r\n        'displayName': 'Rounded Rectangular Callout',\r\n        'name': 'wedgeRoundRectCallout',\r\n        'avLst': {\r\n            'adj1': -20833,\r\n            'adj2': 62500,\r\n            'adj3': 16667\r\n        }\r\n    },\r\n    ROUND_1_RECTANGLE: {\r\n        'displayName': 'Round Single Corner Rectangle',\r\n        'name': 'round1Rect',\r\n        'avLst': {\r\n            'adj': 16667\r\n        }\r\n    },\r\n    ROUND_2_DIAG_RECTANGLE: {\r\n        'displayName': 'Round Diagonal Corner Rectangle',\r\n        'name': 'round2DiagRect',\r\n        'avLst': {\r\n            'adj1': 16667,\r\n            'adj2': 0\r\n        }\r\n    },\r\n    ROUND_2_SAME_RECTANGLE: {\r\n        'displayName': 'Round Same Side Corner Rectangle',\r\n        'name': 'round2SameRect',\r\n        'avLst': {\r\n            'adj1': 16667,\r\n            'adj2': 0\r\n        }\r\n    },\r\n    SMILEY_FACE: {\r\n        'displayName': 'Smiley Face',\r\n        'name': 'smileyFace',\r\n        'avLst': {\r\n            'adj': 4653\r\n        }\r\n    },\r\n    SNIP_1_RECTANGLE: {\r\n        'displayName': 'Snip Single Corner Rectangle',\r\n        'name': 'snip1Rect',\r\n        'avLst': {\r\n            'adj': 16667\r\n        }\r\n    },\r\n    SNIP_2_DIAG_RECTANGLE: {\r\n        'displayName': 'Snip Diagonal Corner Rectangle',\r\n        'name': 'snip2DiagRect',\r\n        'avLst': {\r\n            'adj1': 0,\r\n            'adj2': 16667\r\n        }\r\n    },\r\n    SNIP_2_SAME_RECTANGLE: {\r\n        'displayName': 'Snip Same Side Corner Rectangle',\r\n        'name': 'snip2SameRect',\r\n        'avLst': {\r\n            'adj1': 16667,\r\n            'adj2': 0\r\n        }\r\n    },\r\n    SNIP_ROUND_RECTANGLE: {\r\n        'displayName': 'Snip and Round Single Corner Rectangle',\r\n        'name': 'snipRoundRect',\r\n        'avLst': {\r\n            'adj1': 16667,\r\n            'adj2': 16667\r\n        }\r\n    },\r\n    SQUARE_TABS: {\r\n        'displayName': 'Square Tabs',\r\n        'name': 'squareTabs',\r\n        'avLst': {}\r\n    },\r\n    STAR_10_POINT: {\r\n        'displayName': '10-Point Star',\r\n        'name': 'star10',\r\n        'avLst': {\r\n            'adj': 42533,\r\n            'hf': 105146\r\n        }\r\n    },\r\n    STAR_12_POINT: {\r\n        'displayName': '12-Point Star',\r\n        'name': 'star12',\r\n        'avLst': {\r\n            'adj': 37500\r\n        }\r\n    },\r\n    STAR_16_POINT: {\r\n        'displayName': '16-Point Star',\r\n        'name': 'star16',\r\n        'avLst': {\r\n            'adj': 37500\r\n        }\r\n    },\r\n    STAR_24_POINT: {\r\n        'displayName': '24-Point Star',\r\n        'name': 'star24',\r\n        'avLst': {\r\n            'adj': 37500\r\n        }\r\n    },\r\n    STAR_32_POINT: {\r\n        'displayName': '32-Point Star',\r\n        'name': 'star32',\r\n        'avLst': {\r\n            'adj': 37500\r\n        }\r\n    },\r\n    STAR_4_POINT: {\r\n        'displayName': '4-Point Star',\r\n        'name': 'star4',\r\n        'avLst': {\r\n            'adj': 12500\r\n        }\r\n    },\r\n    STAR_5_POINT: {\r\n        'displayName': '5-Point Star',\r\n        'name': 'star5',\r\n        'avLst': {\r\n            'adj': 19098,\r\n            'hf': 105146,\r\n            'vf': 110557\r\n        }\r\n    },\r\n    STAR_6_POINT: {\r\n        'displayName': '6-Point Star',\r\n        'name': 'star6',\r\n        'avLst': {\r\n            'adj': 28868,\r\n            'hf': 115470\r\n        }\r\n    },\r\n    STAR_7_POINT: {\r\n        'displayName': '7-Point Star',\r\n        'name': 'star7',\r\n        'avLst': {\r\n            'adj': 34601,\r\n            'hf': 102572,\r\n            'vf': 105210\r\n        }\r\n    },\r\n    STAR_8_POINT: {\r\n        'displayName': '8-Point Star',\r\n        'name': 'star8',\r\n        'avLst': {\r\n            'adj': 37500\r\n        }\r\n    },\r\n    STRIPED_RIGHT_ARROW: {\r\n        'displayName': 'Striped Right Arrow',\r\n        'name': 'stripedRightArrow',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    SUN: {\r\n        'displayName': 'Sun',\r\n        'name': 'sun',\r\n        'avLst': {\r\n            'adj': 25000\r\n        }\r\n    },\r\n    SWOOSH_ARROW: {\r\n        'displayName': 'Swoosh Arrow',\r\n        'name': 'swooshArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 16667\r\n        }\r\n    },\r\n    TEAR: {\r\n        'displayName': 'Teardrop',\r\n        'name': 'teardrop',\r\n        'avLst': {\r\n            'adj': 100000\r\n        }\r\n    },\r\n    TRAPEZOID: {\r\n        'displayName': 'Trapezoid',\r\n        'name': 'trapezoid',\r\n        'avLst': {\r\n            'adj': 25000\r\n        }\r\n    },\r\n    UP_ARROW: {\r\n        'displayName': 'Up Arrow',\r\n        'name': 'upArrow',\r\n        'avLst': {}\r\n    },\r\n    UP_ARROW_CALLOUT: {\r\n        'displayName': 'Up Arrow Callout',\r\n        'name': 'upArrowCallout',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000,\r\n            'adj4': 64977\r\n        }\r\n    },\r\n    UP_DOWN_ARROW: {\r\n        'displayName': 'Up-Down Arrow',\r\n        'name': 'upDownArrow',\r\n        'avLst': {\r\n            'adj1': 50000,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    UP_DOWN_ARROW_CALLOUT: {\r\n        'displayName': 'Up-Down Arrow Callout',\r\n        'name': 'upDownArrowCallout',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000,\r\n            'adj4': 48123\r\n        }\r\n    },\r\n    UP_RIBBON: {\r\n        'displayName': 'Up Ribbon',\r\n        'name': 'ribbon2',\r\n        'avLst': {\r\n            'adj1': 16667,\r\n            'adj2': 50000\r\n        }\r\n    },\r\n    U_TURN_ARROW: {\r\n        'displayName': 'U-Turn Arrow',\r\n        'name': 'uturnArrow',\r\n        'avLst': {\r\n            'adj1': 25000,\r\n            'adj2': 25000,\r\n            'adj3': 25000,\r\n            'adj4': 43750,\r\n            'adj5': 75000\r\n        }\r\n    },\r\n    VERTICAL_SCROLL: {\r\n        'displayName': 'Vertical Scroll',\r\n        'name': 'verticalScroll',\r\n        'avLst': {\r\n            'adj': 12500\r\n        }\r\n    },\r\n    WAVE: {\r\n        'displayName': 'Wave',\r\n        'name': 'wave',\r\n        'avLst': {\r\n            'adj1': 12500,\r\n            'adj2': 0\r\n        }\r\n    }\r\n});\n\n/**\r\n * PptxGenJS: XML Generation\r\n */\r\nvar imageSizingXml = {\r\n    cover: function (imgSize, boxDim) {\r\n        var imgRatio = imgSize.h / imgSize.w, boxRatio = boxDim.h / boxDim.w, isBoxBased = boxRatio > imgRatio, width = isBoxBased ? boxDim.h / imgRatio : boxDim.w, height = isBoxBased ? boxDim.h : boxDim.w * imgRatio, hzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.w / width)), vzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.h / height));\r\n        return '<a:srcRect l=\"' + hzPerc + '\" r=\"' + hzPerc + '\" t=\"' + vzPerc + '\" b=\"' + vzPerc + '\"/><a:stretch/>';\r\n    },\r\n    contain: function (imgSize, boxDim) {\r\n        var imgRatio = imgSize.h / imgSize.w, boxRatio = boxDim.h / boxDim.w, widthBased = boxRatio > imgRatio, width = widthBased ? boxDim.w : boxDim.h / imgRatio, height = widthBased ? boxDim.w * imgRatio : boxDim.h, hzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.w / width)), vzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.h / height));\r\n        return '<a:srcRect l=\"' + hzPerc + '\" r=\"' + hzPerc + '\" t=\"' + vzPerc + '\" b=\"' + vzPerc + '\"/><a:stretch/>';\r\n    },\r\n    crop: function (imageSize, boxDim) {\r\n        var l = boxDim.x, r = imageSize.w - (boxDim.x + boxDim.w), t = boxDim.y, b = imageSize.h - (boxDim.y + boxDim.h), lPerc = Math.round(1e5 * (l / imageSize.w)), rPerc = Math.round(1e5 * (r / imageSize.w)), tPerc = Math.round(1e5 * (t / imageSize.h)), bPerc = Math.round(1e5 * (b / imageSize.h));\r\n        return '<a:srcRect l=\"' + lPerc + '\" r=\"' + rPerc + '\" t=\"' + tPerc + '\" b=\"' + bPerc + '\"/><a:stretch/>';\r\n    },\r\n};\r\n/**\r\n * Transforms a slide or slideLayout to resulting XML string - Creates `ppt/slide*.xml`\r\n * @param {ISlide|ISlideLayout} slideObject - slide object created within createSlideObject\r\n * @return {string} XML string with <p:cSld> as the root\r\n */\r\nfunction slideObjectToXml(slide) {\r\n    var strSlideXml = slide.name ? '<p:cSld name=\"' + slide.name + '\">' : '<p:cSld>';\r\n    var intTableNum = 1;\r\n    // STEP 1: Add background\r\n    if (slide.bkgd) {\r\n        strSlideXml += genXmlColorSelection(null, slide.bkgd);\r\n    }\r\n    else if (!slide.bkgd && slide.name && slide.name === DEF_PRES_LAYOUT_NAME) {\r\n        // NOTE: Default [white] background is needed on slideMaster1.xml to avoid gray background in Keynote (and Finder previews)\r\n        strSlideXml += '<p:bg><p:bgRef idx=\"1001\"><a:schemeClr val=\"bg1\"/></p:bgRef></p:bg>';\r\n    }\r\n    // STEP 2: Add background image (using Strech) (if any)\r\n    if (slide.bkgdImgRid) {\r\n        // FIXME: We should be doing this in the slideLayout...\r\n        strSlideXml +=\r\n            '<p:bg>' +\r\n                '<p:bgPr><a:blipFill dpi=\"0\" rotWithShape=\"1\">' +\r\n                '<a:blip r:embed=\"rId' +\r\n                slide.bkgdImgRid +\r\n                '\"><a:lum/></a:blip>' +\r\n                '<a:srcRect/><a:stretch><a:fillRect/></a:stretch></a:blipFill>' +\r\n                '<a:effectLst/></p:bgPr>' +\r\n                '</p:bg>';\r\n    }\r\n    // STEP 3: Continue slide by starting spTree node\r\n    strSlideXml += '<p:spTree>';\r\n    strSlideXml += '<p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr>';\r\n    strSlideXml += '<p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/>';\r\n    strSlideXml += '<a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>';\r\n    // STEP 4: Loop over all Slide.data objects and add them to this slide\r\n    slide.data.forEach(function (slideItemObj, idx) {\r\n        var x = 0, y = 0, cx = getSmartParseNumber('75%', 'X', slide.presLayout), cy = 0;\r\n        var placeholderObj;\r\n        var locationAttr = '';\r\n        var shapeType = null;\r\n        if (slide.slideLayout !== undefined && slide.slideLayout.data !== undefined && slideItemObj.options && slideItemObj.options.placeholder) {\r\n            placeholderObj = slide['slideLayout']['data'].filter(function (object) { return object.options.placeholder === slideItemObj.options.placeholder; })[0];\r\n        }\r\n        // A: Set option vars\r\n        slideItemObj.options = slideItemObj.options || {};\r\n        if (typeof slideItemObj.options.x !== 'undefined')\r\n            x = getSmartParseNumber(slideItemObj.options.x, 'X', slide.presLayout);\r\n        if (typeof slideItemObj.options.y !== 'undefined')\r\n            y = getSmartParseNumber(slideItemObj.options.y, 'Y', slide.presLayout);\r\n        if (typeof slideItemObj.options.w !== 'undefined')\r\n            cx = getSmartParseNumber(slideItemObj.options.w, 'X', slide.presLayout);\r\n        if (typeof slideItemObj.options.h !== 'undefined')\r\n            cy = getSmartParseNumber(slideItemObj.options.h, 'Y', slide.presLayout);\r\n        // If using a placeholder then inherit it's position\r\n        if (placeholderObj) {\r\n            if (placeholderObj.options.x || placeholderObj.options.x === 0)\r\n                x = getSmartParseNumber(placeholderObj.options.x, 'X', slide.presLayout);\r\n            if (placeholderObj.options.y || placeholderObj.options.y === 0)\r\n                y = getSmartParseNumber(placeholderObj.options.y, 'Y', slide.presLayout);\r\n            if (placeholderObj.options.w || placeholderObj.options.w === 0)\r\n                cx = getSmartParseNumber(placeholderObj.options.w, 'X', slide.presLayout);\r\n            if (placeholderObj.options.h || placeholderObj.options.h === 0)\r\n                cy = getSmartParseNumber(placeholderObj.options.h, 'Y', slide.presLayout);\r\n        }\r\n        //\r\n        if (slideItemObj.shape)\r\n            shapeType = getShapeInfo(slideItemObj.shape);\r\n        //\r\n        if (slideItemObj.options.flipH)\r\n            locationAttr += ' flipH=\"1\"';\r\n        if (slideItemObj.options.flipV)\r\n            locationAttr += ' flipV=\"1\"';\r\n        if (slideItemObj.options.rotate)\r\n            locationAttr += ' rot=\"' + convertRotationDegrees(slideItemObj.options.rotate) + '\"';\r\n        // B: Add OBJECT to the current Slide\r\n        switch (slideItemObj.type) {\r\n            case SLIDE_OBJECT_TYPES.table:\r\n                var objTableGrid_1 = {};\r\n                var arrTabRows_1 = slideItemObj.arrTabRows;\r\n                var objTabOpts_1 = slideItemObj.options;\r\n                var intColCnt_1 = 0, intColW = 0;\r\n                var cellOpts_1;\r\n                // Calc number of columns\r\n                // NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\r\n                // ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\r\n                arrTabRows_1[0].forEach(function (cell) {\r\n                    cellOpts_1 = cell.options || null;\r\n                    intColCnt_1 += cellOpts_1 && cellOpts_1.colspan ? Number(cellOpts_1.colspan) : 1;\r\n                });\r\n                // STEP 1: Start Table XML\r\n                // NOTE: Non-numeric cNvPr id values will trigger \"presentation needs repair\" type warning in MS-PPT-2013\r\n                var strXml_1 = '<p:graphicFrame>' +\r\n                    '  <p:nvGraphicFramePr>' +\r\n                    '    <p:cNvPr id=\"' +\r\n                    (intTableNum * slide.number + 1) +\r\n                    '\" name=\"Table ' +\r\n                    intTableNum * slide.number +\r\n                    '\"/>' +\r\n                    '    <p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr>' +\r\n                    '    <p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1579011935\"/></p:ext></p:extLst></p:nvPr>' +\r\n                    '  </p:nvGraphicFramePr>' +\r\n                    '  <p:xfrm>' +\r\n                    '    <a:off x=\"' +\r\n                    (x || (x === 0 ? 0 : EMU)) +\r\n                    '\" y=\"' +\r\n                    (y || (y === 0 ? 0 : EMU)) +\r\n                    '\"/>' +\r\n                    '    <a:ext cx=\"' +\r\n                    (cx || (cx === 0 ? 0 : EMU)) +\r\n                    '\" cy=\"' +\r\n                    (cy || EMU) +\r\n                    '\"/>' +\r\n                    '  </p:xfrm>' +\r\n                    '  <a:graphic>' +\r\n                    '    <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\">' +\r\n                    '      <a:tbl>' +\r\n                    '        <a:tblPr/>';\r\n                // + '        <a:tblPr bandRow=\"1\"/>';\r\n                // TODO: Support banded rows, first/last row, etc.\r\n                // NOTE: Banding, etc. only shows when using a table style! (or set alt row color if banding)\r\n                // <a:tblPr firstCol=\"0\" firstRow=\"0\" lastCol=\"0\" lastRow=\"0\" bandCol=\"0\" bandRow=\"1\">\r\n                // STEP 2: Set column widths\r\n                // Evenly distribute cols/rows across size provided when applicable (calc them if only overall dimensions were provided)\r\n                // A: Col widths provided?\r\n                if (Array.isArray(objTabOpts_1.colW)) {\r\n                    strXml_1 += '<a:tblGrid>';\r\n                    for (var col = 0; col < intColCnt_1; col++) {\r\n                        strXml_1 +=\r\n                            '<a:gridCol w=\"' +\r\n                                Math.round(inch2Emu(objTabOpts_1.colW[col]) || (typeof slideItemObj.options.w === 'number' ? slideItemObj.options.w : 1) / intColCnt_1) +\r\n                                '\"/>';\r\n                    }\r\n                    strXml_1 += '</a:tblGrid>';\r\n                }\r\n                // B: Table Width provided without colW? Then distribute cols\r\n                else {\r\n                    intColW = objTabOpts_1.colW ? objTabOpts_1.colW : EMU;\r\n                    if (slideItemObj.options.w && !objTabOpts_1.colW)\r\n                        intColW = Math.round((typeof slideItemObj.options.w === 'number' ? slideItemObj.options.w : 1) / intColCnt_1);\r\n                    strXml_1 += '<a:tblGrid>';\r\n                    for (var colw = 0; colw < intColCnt_1; colw++) {\r\n                        strXml_1 += '<a:gridCol w=\"' + intColW + '\"/>';\r\n                    }\r\n                    strXml_1 += '</a:tblGrid>';\r\n                }\r\n                // STEP 3: Build our row arrays into an actual grid to match the XML we will be building next (ISSUE #36)\r\n                // Note row arrays can arrive \"lopsided\" as in row1:[1,2,3] row2:[3] when first two cols rowspan!,\r\n                // so a simple loop below in XML building wont suffice to build table correctly.\r\n                // We have to build an actual grid now\r\n                /*\r\n                    EX: (A0:rowspan=3, B1:rowspan=2, C1:colspan=2)\r\n\n                    /------|------|------|------\\\r\n                    |  A0  |  B0  |  C0  |  D0  |\r\n                    |      |  B1  |  C1  |      |\r\n                    |      |      |  C2  |  D2  |\r\n                    \\------|------|------|------/\r\n                */\r\n                /*\r\n                    Object ex: key = rowIdx / val = [cells] cellIdx { 0:{type: \"tablecell\", text: Array(1), options: {…}}, 1:... }\r\n                    {0: {…}, 1: {…}, 2: {…}, 3: {…}}\r\n                */\r\n                arrTabRows_1.forEach(function (row, rIdx) {\r\n                    // A: Create row if needed (recall one may be created in loop below for rowspans, so dont assume we need to create one each iteration)\r\n                    if (!objTableGrid_1[rIdx])\r\n                        objTableGrid_1[rIdx] = {};\r\n                    // B: Loop over all cells\r\n                    row.forEach(function (cell, cIdx) {\r\n                        // DESIGN: NOTE: Row cell arrays can be \"uneven\" (diff cell count in each) due to rowspan/colspan\r\n                        // Therefore, for each cell we run 0->colCount to determine the correct slot for it to reside\r\n                        // as the uneven/mixed nature of the data means we cannot use the cIdx value alone.\r\n                        // E.g.: the 2nd element in the row array may actually go into the 5th table grid row cell b/c of colspans!\r\n                        for (var idx_1 = 0; cIdx + idx_1 < intColCnt_1; idx_1++) {\r\n                            var currColIdx = cIdx + idx_1;\r\n                            if (!objTableGrid_1[rIdx][currColIdx]) {\r\n                                // A: Set this cell\r\n                                objTableGrid_1[rIdx][currColIdx] = cell;\r\n                                // B: Handle `colspan` or `rowspan` (a {cell} cant have both! TODO: FUTURE: ROWSPAN & COLSPAN in same cell)\r\n                                if (cell && cell.options && cell.options.colspan && !isNaN(Number(cell.options.colspan))) {\r\n                                    for (var idy = 1; idy < Number(cell.options.colspan); idy++) {\r\n                                        objTableGrid_1[rIdx][currColIdx + idy] = { hmerge: true, text: 'hmerge' };\r\n                                    }\r\n                                }\r\n                                else if (cell && cell.options && cell.options.rowspan && !isNaN(Number(cell.options.rowspan))) {\r\n                                    for (var idz = 1; idz < Number(cell.options.rowspan); idz++) {\r\n                                        if (!objTableGrid_1[rIdx + idz])\r\n                                            objTableGrid_1[rIdx + idz] = {};\r\n                                        objTableGrid_1[rIdx + idz][currColIdx] = { vmerge: true, text: 'vmerge' };\r\n                                    }\r\n                                }\r\n                                // C: Break out of colCnt loop now that slot has been filled\r\n                                break;\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n                /* DEBUG: useful for rowspan/colspan testing\r\n                if ( objTabOpts.verbose ) {\r\n                    console.table(objTableGrid);\r\n                    let arrText = [];\r\n                    objTableGrid.forEach(function(row){ let arrRow = []; row.forEach(row,function(cell){ arrRow.push(cell.text); }); arrText.push(arrRow); });\r\n                    console.table( arrText );\r\n                }\r\n                */\r\n                // STEP 4: Build table rows/cells\r\n                Object.entries(objTableGrid_1).forEach(function (_a) {\r\n                    var rIdx = _a[0], rowObj = _a[1];\r\n                    // A: Table Height provided without rowH? Then distribute rows\r\n                    var intRowH = 0; // IMPORTANT: Default must be zero for auto-sizing to work\r\n                    if (Array.isArray(objTabOpts_1.rowH) && objTabOpts_1.rowH[rIdx])\r\n                        intRowH = inch2Emu(Number(objTabOpts_1.rowH[rIdx]));\r\n                    else if (objTabOpts_1.rowH && !isNaN(Number(objTabOpts_1.rowH)))\r\n                        intRowH = inch2Emu(Number(objTabOpts_1.rowH));\r\n                    else if (slideItemObj.options.cy || slideItemObj.options.h)\r\n                        intRowH =\r\n                            (slideItemObj.options.h ? inch2Emu(slideItemObj.options.h) : typeof slideItemObj.options.cy === 'number' ? slideItemObj.options.cy : 1) /\r\n                                arrTabRows_1.length;\r\n                    // B: Start row\r\n                    strXml_1 += '<a:tr h=\"' + intRowH + '\">';\r\n                    // C: Loop over each CELL\r\n                    Object.entries(rowObj).forEach(function (_a) {\r\n                        var _cIdx = _a[0], cellObj = _a[1];\r\n                        var cell = cellObj;\r\n                        // 1: \"hmerge\" cells are just place-holders in the table grid - skip those and go to next cell\r\n                        if (cell.hmerge)\r\n                            return;\r\n                        // 2: OPTIONS: Build/set cell options\r\n                        var cellOpts = cell.options || {};\r\n                        cell.options = cellOpts;\r\n                        ['align', 'bold', 'border', 'color', 'fill', 'fontFace', 'fontSize', 'margin', 'underline', 'valign'].forEach(function (name) {\r\n                            if (objTabOpts_1[name] && !cellOpts[name] && cellOpts[name] !== 0)\r\n                                cellOpts[name] = objTabOpts_1[name];\r\n                        });\r\n                        var cellValign = cellOpts.valign\r\n                            ? ' anchor=\"' +\r\n                                cellOpts.valign\r\n                                    .replace(/^c$/i, 'ctr')\r\n                                    .replace(/^m$/i, 'ctr')\r\n                                    .replace('center', 'ctr')\r\n                                    .replace('middle', 'ctr')\r\n                                    .replace('top', 't')\r\n                                    .replace('btm', 'b')\r\n                                    .replace('bottom', 'b') +\r\n                                '\"'\r\n                            : '';\r\n                        var cellColspan = cellOpts.colspan ? ' gridSpan=\"' + cellOpts.colspan + '\"' : '';\r\n                        var cellRowspan = cellOpts.rowspan ? ' rowSpan=\"' + cellOpts.rowspan + '\"' : '';\r\n                        var cellFill = (cell.optImp && cell.optImp.fill) || cellOpts.fill\r\n                            ? ' <a:solidFill><a:srgbClr val=\"' +\r\n                                ((cell.optImp && cell.optImp.fill) || (typeof cellOpts.fill === 'string' ? cellOpts.fill.replace('#', '') : '')).toUpperCase() +\r\n                                '\"/></a:solidFill>'\r\n                            : '';\r\n                        var cellMargin = cellOpts.margin === 0 || cellOpts.margin ? cellOpts.margin : DEF_CELL_MARGIN_PT;\r\n                        if (!Array.isArray(cellMargin) && typeof cellMargin === 'number')\r\n                            cellMargin = [cellMargin, cellMargin, cellMargin, cellMargin];\r\n                        var cellMarginXml = ' marL=\"' +\r\n                            cellMargin[3] * ONEPT +\r\n                            '\" marR=\"' +\r\n                            cellMargin[1] * ONEPT +\r\n                            '\" marT=\"' +\r\n                            cellMargin[0] * ONEPT +\r\n                            '\" marB=\"' +\r\n                            cellMargin[2] * ONEPT +\r\n                            '\"';\r\n                        // TODO: Cell NOWRAP property (text wrap: add to a:tcPr (horzOverflow=\"overflow\" or whatever options exist)\r\n                        // 3: ROWSPAN: Add dummy cells for any active rowspan\r\n                        if (cell.vmerge) {\r\n                            strXml_1 += '<a:tc vMerge=\"1\"><a:tcPr/></a:tc>';\r\n                            return;\r\n                        }\r\n                        // 4: Set CELL content and properties ==================================\r\n                        strXml_1 += '<a:tc' + cellColspan + cellRowspan + '>' + genXmlTextBody(cell) + '<a:tcPr' + cellMarginXml + cellValign + '>';\r\n                        // 5: Borders: Add any borders\r\n                        if (cellOpts.border && !Array.isArray(cellOpts.border) && cellOpts.border.type === 'none') {\r\n                            strXml_1 += '  <a:lnL w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnL>';\r\n                            strXml_1 += '  <a:lnR w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnR>';\r\n                            strXml_1 += '  <a:lnT w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnT>';\r\n                            strXml_1 += '  <a:lnB w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnB>';\r\n                        }\r\n                        else if (cellOpts.border && typeof cellOpts.border === 'string') {\r\n                            strXml_1 +=\r\n                                '  <a:lnL w=\"' + ONEPT + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"' + cellOpts.border + '\"/></a:solidFill></a:lnL>';\r\n                            strXml_1 +=\r\n                                '  <a:lnR w=\"' + ONEPT + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"' + cellOpts.border + '\"/></a:solidFill></a:lnR>';\r\n                            strXml_1 +=\r\n                                '  <a:lnT w=\"' + ONEPT + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"' + cellOpts.border + '\"/></a:solidFill></a:lnT>';\r\n                            strXml_1 +=\r\n                                '  <a:lnB w=\"' + ONEPT + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"' + cellOpts.border + '\"/></a:solidFill></a:lnB>';\r\n                        }\r\n                        else if (cellOpts.border && Array.isArray(cellOpts.border)) {\r\n                            [{ idx: 3, name: 'lnL' }, { idx: 1, name: 'lnR' }, { idx: 0, name: 'lnT' }, { idx: 2, name: 'lnB' }].forEach(function (obj) {\r\n                                if (cellOpts.border[obj.idx]) {\r\n                                    var strC = '<a:solidFill><a:srgbClr val=\"' +\r\n                                        (cellOpts.border[obj.idx].color ? cellOpts.border[obj.idx].color : DEF_CELL_BORDER.color) +\r\n                                        '\"/></a:solidFill>';\r\n                                    var intW = cellOpts.border[obj.idx] && (cellOpts.border[obj.idx].pt || cellOpts.border[obj.idx].pt === 0)\r\n                                        ? ONEPT * Number(cellOpts.border[obj.idx].pt)\r\n                                        : ONEPT;\r\n                                    strXml_1 += '<a:' + obj.name + ' w=\"' + intW + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">' + strC + '</a:' + obj.name + '>';\r\n                                }\r\n                                else\r\n                                    strXml_1 += '<a:' + obj.name + ' w=\"0\"><a:miter lim=\"400000\"/></a:' + obj.name + '>';\r\n                            });\r\n                        }\r\n                        else if (cellOpts.border && !Array.isArray(cellOpts.border)) {\r\n                            var intW = cellOpts.border && (cellOpts.border.pt || cellOpts.border.pt === 0) ? ONEPT * Number(cellOpts.border.pt) : ONEPT;\r\n                            var strClr = '<a:solidFill><a:srgbClr val=\"' +\r\n                                (cellOpts.border.color ? cellOpts.border.color.replace('#', '') : DEF_CELL_BORDER.color) +\r\n                                '\"/></a:solidFill>';\r\n                            var strAttr = '<a:prstDash val=\"';\r\n                            strAttr += cellOpts.border.type && cellOpts.border.type.toLowerCase().indexOf('dash') > -1 ? 'sysDash' : 'solid';\r\n                            strAttr += '\"/><a:round/><a:headEnd type=\"none\" w=\"med\" len=\"med\"/><a:tailEnd type=\"none\" w=\"med\" len=\"med\"/>';\r\n                            // *** IMPORTANT! *** LRTB order matters! (Reorder a line below to watch the borders go wonky in MS-PPT-2013!!)\r\n                            strXml_1 += '<a:lnL w=\"' + intW + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">' + strClr + strAttr + '</a:lnL>';\r\n                            strXml_1 += '<a:lnR w=\"' + intW + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">' + strClr + strAttr + '</a:lnR>';\r\n                            strXml_1 += '<a:lnT w=\"' + intW + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">' + strClr + strAttr + '</a:lnT>';\r\n                            strXml_1 += '<a:lnB w=\"' + intW + '\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">' + strClr + strAttr + '</a:lnB>';\r\n                            // *** IMPORTANT! *** LRTB order matters!\r\n                        }\r\n                        // 6: Close cell Properties & Cell\r\n                        strXml_1 += cellFill;\r\n                        strXml_1 += '  </a:tcPr>';\r\n                        strXml_1 += ' </a:tc>';\r\n                        // LAST: COLSPAN: Add a 'merged' col for each column being merged (SEE: http://officeopenxml.com/drwTableGrid.php)\r\n                        if (cellOpts.colspan) {\r\n                            for (var tmp = 1; tmp < Number(cellOpts.colspan); tmp++) {\r\n                                strXml_1 += '<a:tc hMerge=\"1\"><a:tcPr/></a:tc>';\r\n                            }\r\n                        }\r\n                    });\r\n                    // D: Complete row\r\n                    strXml_1 += '</a:tr>';\r\n                });\r\n                // STEP 5: Complete table\r\n                strXml_1 += '      </a:tbl>';\r\n                strXml_1 += '    </a:graphicData>';\r\n                strXml_1 += '  </a:graphic>';\r\n                strXml_1 += '</p:graphicFrame>';\r\n                // STEP 6: Set table XML\r\n                strSlideXml += strXml_1;\r\n                // LAST: Increment counter\r\n                intTableNum++;\r\n                break;\r\n            case SLIDE_OBJECT_TYPES.text:\r\n            case SLIDE_OBJECT_TYPES.placeholder:\r\n                // Lines can have zero cy, but text should not\r\n                if (!slideItemObj.options.line && cy === 0)\r\n                    cy = EMU * 0.3;\r\n                // Margin/Padding/Inset for textboxes\r\n                if (slideItemObj.options.margin && Array.isArray(slideItemObj.options.margin)) {\r\n                    slideItemObj.options.bodyProp.lIns = Math.round(slideItemObj.options.margin[0] * ONEPT || 0);\r\n                    slideItemObj.options.bodyProp.rIns = Math.round(slideItemObj.options.margin[1] * ONEPT || 0);\r\n                    slideItemObj.options.bodyProp.bIns = Math.round(slideItemObj.options.margin[2] * ONEPT || 0);\r\n                    slideItemObj.options.bodyProp.tIns = Math.round(slideItemObj.options.margin[3] * ONEPT || 0);\r\n                }\r\n                else if (typeof slideItemObj.options.margin === 'number') {\r\n                    slideItemObj.options.bodyProp.lIns = Math.round(slideItemObj.options.margin * ONEPT);\r\n                    slideItemObj.options.bodyProp.rIns = Math.round(slideItemObj.options.margin * ONEPT);\r\n                    slideItemObj.options.bodyProp.bIns = Math.round(slideItemObj.options.margin * ONEPT);\r\n                    slideItemObj.options.bodyProp.tIns = Math.round(slideItemObj.options.margin * ONEPT);\r\n                }\r\n                if (shapeType === null)\r\n                    shapeType = getShapeInfo(null);\r\n                // A: Start SHAPE =======================================================\r\n                strSlideXml += '<p:sp>';\r\n                // B: The addition of the \"txBox\" attribute is the sole determiner of if an object is a shape or textbox\r\n                strSlideXml += '<p:nvSpPr><p:cNvPr id=\"' + (idx + 2) + '\" name=\"Object ' + (idx + 1) + '\"/>';\r\n                strSlideXml += '<p:cNvSpPr' + (slideItemObj.options && slideItemObj.options.isTextBox ? ' txBox=\"1\"/>' : '/>');\r\n                strSlideXml += '<p:nvPr>';\r\n                strSlideXml += slideItemObj.type === 'placeholder' ? genXmlPlaceholder(slideItemObj) : genXmlPlaceholder(placeholderObj);\r\n                strSlideXml += '</p:nvPr>';\r\n                strSlideXml += '</p:nvSpPr><p:spPr>';\r\n                strSlideXml += '<a:xfrm' + locationAttr + '>';\r\n                strSlideXml += '<a:off x=\"' + x + '\" y=\"' + y + '\"/>';\r\n                strSlideXml += '<a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm>';\r\n                strSlideXml +=\r\n                    '<a:prstGeom prst=\"' +\r\n                        shapeType.name +\r\n                        '\"><a:avLst>' +\r\n                        (slideItemObj.options.rectRadius\r\n                            ? '<a:gd name=\"adj\" fmla=\"val ' + Math.round((slideItemObj.options.rectRadius * EMU * 100000) / Math.min(cx, cy)) + '\"/>'\r\n                            : '') +\r\n                        '</a:avLst></a:prstGeom>';\r\n                // Option: FILL\r\n                strSlideXml += slideItemObj.options.fill ? genXmlColorSelection(slideItemObj.options.fill) : '<a:noFill/>';\r\n                // shape Type: LINE: line color\r\n                if (slideItemObj.options.line) {\r\n                    strSlideXml += '<a:ln' + (slideItemObj.options.lineSize ? ' w=\"' + slideItemObj.options.lineSize * ONEPT + '\"' : '') + '>';\r\n                    strSlideXml += genXmlColorSelection(slideItemObj.options.line);\r\n                    if (slideItemObj.options.lineDash)\r\n                        strSlideXml += '<a:prstDash val=\"' + slideItemObj.options.lineDash + '\"/>';\r\n                    if (slideItemObj.options.lineHead)\r\n                        strSlideXml += '<a:headEnd type=\"' + slideItemObj.options.lineHead + '\"/>';\r\n                    if (slideItemObj.options.lineTail)\r\n                        strSlideXml += '<a:tailEnd type=\"' + slideItemObj.options.lineTail + '\"/>';\r\n                    strSlideXml += '</a:ln>';\r\n                }\r\n                // EFFECTS > SHADOW: REF: @see http://officeopenxml.com/drwSp-effects.php\r\n                if (slideItemObj.options.shadow) {\r\n                    slideItemObj.options.shadow.type = slideItemObj.options.shadow.type || 'outer';\r\n                    slideItemObj.options.shadow.blur = (slideItemObj.options.shadow.blur || 8) * ONEPT;\r\n                    slideItemObj.options.shadow.offset = (slideItemObj.options.shadow.offset || 4) * ONEPT;\r\n                    slideItemObj.options.shadow.angle = (slideItemObj.options.shadow.angle || 270) * 60000;\r\n                    slideItemObj.options.shadow.color = slideItemObj.options.shadow.color || '000000';\r\n                    slideItemObj.options.shadow.opacity = (slideItemObj.options.shadow.opacity || 0.75) * 100000;\r\n                    strSlideXml += '<a:effectLst>';\r\n                    strSlideXml += '<a:' + slideItemObj.options.shadow.type + 'Shdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" ';\r\n                    strSlideXml += ' algn=\"bl\" rotWithShape=\"0\" blurRad=\"' + slideItemObj.options.shadow.blur + '\" ';\r\n                    strSlideXml += ' dist=\"' + slideItemObj.options.shadow.offset + '\" dir=\"' + slideItemObj.options.shadow.angle + '\">';\r\n                    strSlideXml += '<a:srgbClr val=\"' + slideItemObj.options.shadow.color + '\">';\r\n                    strSlideXml += '<a:alpha val=\"' + slideItemObj.options.shadow.opacity + '\"/></a:srgbClr>';\r\n                    strSlideXml += '</a:outerShdw>';\r\n                    strSlideXml += '</a:effectLst>';\r\n                }\r\n                /* TODO: FUTURE: Text wrapping (copied from MS-PPTX export)\r\n                    // Commented out b/c i'm not even sure this works - current code produces text that wraps in shapes and textboxes, so...\r\n                    if ( slideItemObj.options.textWrap ) {\r\n                        strSlideXml += '<a:extLst>'\r\n                                    + '<a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\">'\r\n                                    + '<ma14:wrappingTextBoxFlag xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\" val=\"1\"/>'\r\n                                    + '</a:ext>'\r\n                                    + '</a:extLst>';\r\n                    }\r\n                    */\r\n                // B: Close shape Properties\r\n                strSlideXml += '</p:spPr>';\r\n                // C: Add formatted text (text body \"bodyPr\")\r\n                strSlideXml += genXmlTextBody(slideItemObj);\r\n                // LAST: Close SHAPE =======================================================\r\n                strSlideXml += '</p:sp>';\r\n                break;\r\n            case SLIDE_OBJECT_TYPES.image:\r\n                var sizing = slideItemObj.options.sizing, rounding = slideItemObj.options.rounding, width = cx, height = cy;\r\n                strSlideXml += '<p:pic>';\r\n                strSlideXml += '  <p:nvPicPr>';\r\n                strSlideXml += '    <p:cNvPr id=\"' + (idx + 2) + '\" name=\"Object ' + (idx + 1) + '\" descr=\"' + encodeXmlEntities(slideItemObj.image) + '\">';\r\n                if (slideItemObj.hyperlink && slideItemObj.hyperlink.url)\r\n                    strSlideXml +=\r\n                        '<a:hlinkClick r:id=\"rId' +\r\n                            slideItemObj.hyperlink.rId +\r\n                            '\" tooltip=\"' +\r\n                            (slideItemObj.hyperlink.tooltip ? encodeXmlEntities(slideItemObj.hyperlink.tooltip) : '') +\r\n                            '\"/>';\r\n                if (slideItemObj.hyperlink && slideItemObj.hyperlink.slide)\r\n                    strSlideXml +=\r\n                        '<a:hlinkClick r:id=\"rId' +\r\n                            slideItemObj.hyperlink.rId +\r\n                            '\" tooltip=\"' +\r\n                            (slideItemObj.hyperlink.tooltip ? encodeXmlEntities(slideItemObj.hyperlink.tooltip) : '') +\r\n                            '\" action=\"ppaction://hlinksldjump\"/>';\r\n                strSlideXml += '    </p:cNvPr>';\r\n                strSlideXml += '    <p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr>';\r\n                strSlideXml += '    <p:nvPr>' + genXmlPlaceholder(placeholderObj) + '</p:nvPr>';\r\n                strSlideXml += '  </p:nvPicPr>';\r\n                strSlideXml += '<p:blipFill>';\r\n                // NOTE: This works for both cases: either `path` or `data` contains the SVG\r\n                if ((slide['relsMedia'] || []).filter(function (rel) { return rel.rId === slideItemObj.imageRid; })[0] &&\r\n                    (slide['relsMedia'] || []).filter(function (rel) { return rel.rId === slideItemObj.imageRid; })[0]['extn'] === 'svg') {\r\n                    strSlideXml += '<a:blip r:embed=\"rId' + (slideItemObj.imageRid - 1) + '\">';\r\n                    strSlideXml += ' <a:extLst>';\r\n                    strSlideXml += '  <a:ext uri=\"{96DAC541-7B7A-43D3-8B79-37D633B846F1}\">';\r\n                    strSlideXml += '   <asvg:svgBlip xmlns:asvg=\"http://schemas.microsoft.com/office/drawing/2016/SVG/main\" r:embed=\"rId' + slideItemObj.imageRid + '\"/>';\r\n                    strSlideXml += '  </a:ext>';\r\n                    strSlideXml += ' </a:extLst>';\r\n                    strSlideXml += '</a:blip>';\r\n                }\r\n                else {\r\n                    strSlideXml += '<a:blip r:embed=\"rId' + slideItemObj.imageRid + '\"/>';\r\n                }\r\n                if (sizing && sizing.type) {\r\n                    var boxW = sizing.w ? getSmartParseNumber(sizing.w, 'X', slide.presLayout) : cx, boxH = sizing.h ? getSmartParseNumber(sizing.h, 'Y', slide.presLayout) : cy, boxX = getSmartParseNumber(sizing.x || 0, 'X', slide.presLayout), boxY = getSmartParseNumber(sizing.y || 0, 'Y', slide.presLayout);\r\n                    strSlideXml += imageSizingXml[sizing.type]({ w: width, h: height }, { w: boxW, h: boxH, x: boxX, y: boxY });\r\n                    width = boxW;\r\n                    height = boxH;\r\n                }\r\n                else {\r\n                    strSlideXml += '  <a:stretch><a:fillRect/></a:stretch>';\r\n                }\r\n                strSlideXml += '</p:blipFill>';\r\n                strSlideXml += '<p:spPr>';\r\n                strSlideXml += ' <a:xfrm' + locationAttr + '>';\r\n                strSlideXml += '  <a:off x=\"' + x + '\" y=\"' + y + '\"/>';\r\n                strSlideXml += '  <a:ext cx=\"' + width + '\" cy=\"' + height + '\"/>';\r\n                strSlideXml += ' </a:xfrm>';\r\n                strSlideXml += ' <a:prstGeom prst=\"' + (rounding ? 'ellipse' : 'rect') + '\"><a:avLst/></a:prstGeom>';\r\n                strSlideXml += '</p:spPr>';\r\n                strSlideXml += '</p:pic>';\r\n                break;\r\n            case SLIDE_OBJECT_TYPES.media:\r\n                if (slideItemObj.mtype === 'online') {\r\n                    strSlideXml += '<p:pic>';\r\n                    strSlideXml += ' <p:nvPicPr>';\r\n                    // IMPORTANT: <p:cNvPr id=\"\" value is critical - if not the same number as preview image rId, PowerPoint throws error!\r\n                    strSlideXml += ' <p:cNvPr id=\"' + (slideItemObj.mediaRid + 2) + '\" name=\"Picture' + (idx + 1) + '\"/>';\r\n                    strSlideXml += ' <p:cNvPicPr/>';\r\n                    strSlideXml += ' <p:nvPr>';\r\n                    strSlideXml += '  <a:videoFile r:link=\"rId' + slideItemObj.mediaRid + '\"/>';\r\n                    strSlideXml += ' </p:nvPr>';\r\n                    strSlideXml += ' </p:nvPicPr>';\r\n                    // NOTE: `blip` is diferent than videos; also there's no preview \"p:extLst\" above but exists in videos\r\n                    strSlideXml += ' <p:blipFill><a:blip r:embed=\"rId' + (slideItemObj.mediaRid + 1) + '\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill>'; // NOTE: Preview image is required!\r\n                    strSlideXml += ' <p:spPr>';\r\n                    strSlideXml += '  <a:xfrm' + locationAttr + '>';\r\n                    strSlideXml += '   <a:off x=\"' + x + '\" y=\"' + y + '\"/>';\r\n                    strSlideXml += '   <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>';\r\n                    strSlideXml += '  </a:xfrm>';\r\n                    strSlideXml += '  <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>';\r\n                    strSlideXml += ' </p:spPr>';\r\n                    strSlideXml += '</p:pic>';\r\n                }\r\n                else {\r\n                    strSlideXml += '<p:pic>';\r\n                    strSlideXml += ' <p:nvPicPr>';\r\n                    // IMPORTANT: <p:cNvPr id=\"\" value is critical - if not the same number as preiew image rId, PowerPoint throws error!\r\n                    strSlideXml +=\r\n                        ' <p:cNvPr id=\"' +\r\n                            (slideItemObj.mediaRid + 2) +\r\n                            '\" name=\"' +\r\n                            slideItemObj.media\r\n                                .split('/')\r\n                                .pop()\r\n                                .split('.')\r\n                                .shift() +\r\n                            '\"><a:hlinkClick r:id=\"\" action=\"ppaction://media\"/></p:cNvPr>';\r\n                    strSlideXml += ' <p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr>';\r\n                    strSlideXml += ' <p:nvPr>';\r\n                    strSlideXml += '  <a:videoFile r:link=\"rId' + slideItemObj.mediaRid + '\"/>';\r\n                    strSlideXml += '  <p:extLst>';\r\n                    strSlideXml += '   <p:ext uri=\"{DAA4B4D4-6D71-4841-9C94-3DE7FCFB9230}\">';\r\n                    strSlideXml += '    <p14:media xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" r:embed=\"rId' + (slideItemObj.mediaRid + 1) + '\"/>';\r\n                    strSlideXml += '   </p:ext>';\r\n                    strSlideXml += '  </p:extLst>';\r\n                    strSlideXml += ' </p:nvPr>';\r\n                    strSlideXml += ' </p:nvPicPr>';\r\n                    strSlideXml += ' <p:blipFill><a:blip r:embed=\"rId' + (slideItemObj.mediaRid + 2) + '\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill>'; // NOTE: Preview image is required!\r\n                    strSlideXml += ' <p:spPr>';\r\n                    strSlideXml += '  <a:xfrm' + locationAttr + '>';\r\n                    strSlideXml += '   <a:off x=\"' + x + '\" y=\"' + y + '\"/>';\r\n                    strSlideXml += '   <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>';\r\n                    strSlideXml += '  </a:xfrm>';\r\n                    strSlideXml += '  <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>';\r\n                    strSlideXml += ' </p:spPr>';\r\n                    strSlideXml += '</p:pic>';\r\n                }\r\n                break;\r\n            case SLIDE_OBJECT_TYPES.chart:\r\n                strSlideXml += '<p:graphicFrame>';\r\n                strSlideXml += ' <p:nvGraphicFramePr>';\r\n                strSlideXml += '   <p:cNvPr id=\"' + (idx + 2) + '\" name=\"Chart ' + (idx + 1) + '\"/>';\r\n                strSlideXml += '   <p:cNvGraphicFramePr/>';\r\n                strSlideXml += '   <p:nvPr>' + genXmlPlaceholder(placeholderObj) + '</p:nvPr>';\r\n                strSlideXml += ' </p:nvGraphicFramePr>';\r\n                strSlideXml += ' <p:xfrm>';\r\n                strSlideXml += '  <a:off x=\"' + x + '\" y=\"' + y + '\"/>';\r\n                strSlideXml += '  <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>';\r\n                strSlideXml += ' </p:xfrm>';\r\n                strSlideXml += ' <a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">';\r\n                strSlideXml += '  <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">';\r\n                strSlideXml += '   <c:chart r:id=\"rId' + slideItemObj.chartRid + '\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"/>';\r\n                strSlideXml += '  </a:graphicData>';\r\n                strSlideXml += ' </a:graphic>';\r\n                strSlideXml += '</p:graphicFrame>';\r\n                break;\r\n            default:\r\n                strSlideXml += '';\r\n                break;\r\n        }\r\n    });\r\n    // STEP 5: Add slide numbers (if any) last\r\n    if (slide.slideNumberObj) {\r\n        strSlideXml +=\r\n            '<p:sp>' +\r\n                '  <p:nvSpPr>' +\r\n                '    <p:cNvPr id=\"25\" name=\"Slide Number Placeholder 24\"/>' +\r\n                '    <p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr>' +\r\n                '    <p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4294967295\"/></p:nvPr>' +\r\n                '  </p:nvSpPr>' +\r\n                '  <p:spPr>' +\r\n                '    <a:xfrm>' +\r\n                '      <a:off x=\"' +\r\n                getSmartParseNumber(slide.slideNumberObj.x, 'X', slide.presLayout) +\r\n                '\" y=\"' +\r\n                getSmartParseNumber(slide.slideNumberObj.y, 'Y', slide.presLayout) +\r\n                '\"/>' +\r\n                '      <a:ext cx=\"' +\r\n                (slide.slideNumberObj.w ? getSmartParseNumber(slide.slideNumberObj.w, 'X', slide.presLayout) : 800000) +\r\n                '\" cy=\"' +\r\n                (slide.slideNumberObj.h ? getSmartParseNumber(slide.slideNumberObj.h, 'Y', slide.presLayout) : 300000) +\r\n                '\"/>' +\r\n                '    </a:xfrm>' +\r\n                '    <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>' +\r\n                '    <a:extLst><a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\"><ma14:wrappingTextBoxFlag val=\"0\" xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\"/></a:ext></a:extLst>' +\r\n                '  </p:spPr>';\r\n        strSlideXml += '<p:txBody>';\r\n        strSlideXml += '  <a:bodyPr/>';\r\n        strSlideXml += '  <a:lstStyle><a:lvl1pPr>';\r\n        if (slide.slideNumberObj.fontFace || slide.slideNumberObj.fontSize || slide.slideNumberObj.color) {\r\n            strSlideXml += '<a:defRPr sz=\"' + (slide.slideNumberObj.fontSize ? Math.round(slide.slideNumberObj.fontSize) : '12') + '00\">';\r\n            if (slide.slideNumberObj.color)\r\n                strSlideXml += genXmlColorSelection(slide.slideNumberObj.color);\r\n            if (slide.slideNumberObj.fontFace)\r\n                strSlideXml +=\r\n                    '<a:latin typeface=\"' +\r\n                        slide.slideNumberObj.fontFace +\r\n                        '\"/><a:ea typeface=\"' +\r\n                        slide.slideNumberObj.fontFace +\r\n                        '\"/><a:cs typeface=\"' +\r\n                        slide.slideNumberObj.fontFace +\r\n                        '\"/>';\r\n            strSlideXml += '</a:defRPr>';\r\n        }\r\n        strSlideXml += '</a:lvl1pPr></a:lstStyle>';\r\n        strSlideXml += '<a:p><a:fld id=\"' + SLDNUMFLDID + '\" type=\"slidenum\"><a:rPr lang=\"en-US\"/><a:t></a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p>';\r\n        strSlideXml += '</p:txBody></p:sp>';\r\n    }\r\n    // STEP 6: Close spTree and finalize slide XML\r\n    strSlideXml += '</p:spTree>';\r\n    strSlideXml += '</p:cSld>';\r\n    // LAST: Return\r\n    return strSlideXml;\r\n}\r\n/**\r\n * Transforms slide relations to XML string.\r\n * Extra relations that are not dynamic can be passed using the 2nd arg (e.g. theme relation in master file).\r\n * These relations use rId series that starts with 1-increased maximum of rIds used for dynamic relations.\r\n * @param {ISlide | ISlideLayout} slide - slide object whose relations are being transformed\r\n * @param {{ target: string; type: string }[]} defaultRels - array of default relations\r\n * @return {string} XML\r\n */\r\nfunction slideObjectRelationsToXml(slide, defaultRels) {\r\n    var lastRid = 0; // stores maximum rId used for dynamic relations\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\r\n    // STEP 1: Add all rels for this Slide\r\n    slide.rels.forEach(function (rel) {\r\n        lastRid = Math.max(lastRid, rel.rId);\r\n        if (rel.type.toLowerCase().indexOf('hyperlink') > -1) {\r\n            if (rel.data === 'slide') {\r\n                strXml +=\r\n                    '<Relationship Id=\"rId' +\r\n                        rel.rId +\r\n                        '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\"' +\r\n                        ' Target=\"slide' +\r\n                        rel.Target +\r\n                        '.xml\"/>';\r\n            }\r\n            else {\r\n                strXml +=\r\n                    '<Relationship Id=\"rId' +\r\n                        rel.rId +\r\n                        '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\"' +\r\n                        ' Target=\"' +\r\n                        rel.Target +\r\n                        '\" TargetMode=\"External\"/>';\r\n            }\r\n        }\r\n        else if (rel.type.toLowerCase().indexOf('notesSlide') > -1) {\r\n            strXml +=\r\n                '<Relationship Id=\"rId' + rel.rId + '\" Target=\"' + rel.Target + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesSlide\"/>';\r\n        }\r\n    });\r\n    (slide.relsChart || []).forEach(function (rel) {\r\n        lastRid = Math.max(lastRid, rel.rId);\r\n        strXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\" Target=\"' + rel.Target + '\"/>';\r\n    });\r\n    (slide.relsMedia || []).forEach(function (rel) {\r\n        lastRid = Math.max(lastRid, rel.rId);\r\n        if (rel.type.toLowerCase().indexOf('image') > -1) {\r\n            strXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"' + rel.Target + '\"/>';\r\n        }\r\n        else if (rel.type.toLowerCase().indexOf('audio') > -1) {\r\n            // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n            if (strXml.indexOf(' Target=\"' + rel.Target + '\"') > -1)\r\n                strXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\" Target=\"' + rel.Target + '\"/>';\r\n            else\r\n                strXml +=\r\n                    '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/audio\" Target=\"' + rel.Target + '\"/>';\r\n        }\r\n        else if (rel.type.toLowerCase().indexOf('video') > -1) {\r\n            // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n            if (strXml.indexOf(' Target=\"' + rel.Target + '\"') > -1)\r\n                strXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\" Target=\"' + rel.Target + '\"/>';\r\n            else\r\n                strXml +=\r\n                    '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\" Target=\"' + rel.Target + '\"/>';\r\n        }\r\n        else if (rel.type.toLowerCase().indexOf('online') > -1) {\r\n            // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n            if (strXml.indexOf(' Target=\"' + rel.Target + '\"') > -1)\r\n                strXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.microsoft.com/office/2007/relationships/image\" Target=\"' + rel.Target + '\"/>';\r\n            else\r\n                strXml +=\r\n                    '<Relationship Id=\"rId' +\r\n                        rel.rId +\r\n                        '\" Target=\"' +\r\n                        rel.Target +\r\n                        '\" TargetMode=\"External\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>';\r\n        }\r\n    });\r\n    // STEP 2: Add default rels\r\n    defaultRels.forEach(function (rel, idx) {\r\n        strXml += '<Relationship Id=\"rId' + (lastRid + idx + 1) + '\" Type=\"' + rel.type + '\" Target=\"' + rel.target + '\"/>';\r\n    });\r\n    strXml += '</Relationships>';\r\n    return strXml;\r\n}\r\n/**\r\n * Generate XML Paragraph Properties\r\n * @param {ISlideObject|IText} textObj - text object\r\n * @param {boolean} isDefault - array of default relations\r\n * @return {string} XML\r\n */\r\nfunction genXmlParagraphProperties(textObj, isDefault) {\r\n    var strXmlBullet = '', strXmlLnSpc = '', strXmlParaSpc = '';\r\n    var bulletLvl0Margin = 342900;\r\n    var tag = isDefault ? 'a:lvl1pPr' : 'a:pPr';\r\n    var paragraphPropXml = '<' + tag + (textObj.options.rtlMode ? ' rtl=\"1\" ' : '');\r\n    // A: Build paragraphProperties\r\n    {\r\n        // OPTION: align\r\n        if (textObj.options.align) {\r\n            switch (textObj.options.align) {\r\n                case 'left':\r\n                    paragraphPropXml += ' algn=\"l\"';\r\n                    break;\r\n                case 'right':\r\n                    paragraphPropXml += ' algn=\"r\"';\r\n                    break;\r\n                case 'center':\r\n                    paragraphPropXml += ' algn=\"ctr\"';\r\n                    break;\r\n                case 'justify':\r\n                    paragraphPropXml += ' algn=\"just\"';\r\n                    break;\r\n                default:\r\n                    paragraphPropXml += '';\r\n                    break;\r\n            }\r\n        }\r\n        if (textObj.options.lineSpacing) {\r\n            strXmlLnSpc = '<a:lnSpc><a:spcPts val=\"' + textObj.options.lineSpacing + '00\"/></a:lnSpc>';\r\n        }\r\n        // OPTION: indent\r\n        if (textObj.options.indentLevel && !isNaN(Number(textObj.options.indentLevel)) && textObj.options.indentLevel > 0) {\r\n            paragraphPropXml += ' lvl=\"' + textObj.options.indentLevel + '\"';\r\n        }\r\n        // OPTION: Paragraph Spacing: Before/After\r\n        if (textObj.options.paraSpaceBefore && !isNaN(Number(textObj.options.paraSpaceBefore)) && textObj.options.paraSpaceBefore > 0) {\r\n            strXmlParaSpc += '<a:spcBef><a:spcPts val=\"' + textObj.options.paraSpaceBefore * 100 + '\"/></a:spcBef>';\r\n        }\r\n        if (textObj.options.paraSpaceAfter && !isNaN(Number(textObj.options.paraSpaceAfter)) && textObj.options.paraSpaceAfter > 0) {\r\n            strXmlParaSpc += '<a:spcAft><a:spcPts val=\"' + textObj.options.paraSpaceAfter * 100 + '\"/></a:spcAft>';\r\n        }\r\n        // OPTION: bullet\r\n        // NOTE: OOXML uses the unicode character set for Bullets\r\n        // EX: Unicode Character 'BULLET' (U+2022) ==> '<a:buChar char=\"&#x2022;\"/>'\r\n        if (typeof textObj.options.bullet === 'object') {\r\n            if (textObj.options.bullet.type) {\r\n                if (textObj.options.bullet.type.toString().toLowerCase() === 'number') {\r\n                    paragraphPropXml +=\r\n                        ' marL=\"' +\r\n                            (textObj.options.indentLevel && textObj.options.indentLevel > 0\r\n                                ? bulletLvl0Margin + bulletLvl0Margin * textObj.options.indentLevel\r\n                                : bulletLvl0Margin) +\r\n                            '\" indent=\"-' +\r\n                            bulletLvl0Margin +\r\n                            '\"';\r\n                    strXmlBullet = \"<a:buSzPct val=\\\"100000\\\"/><a:buFont typeface=\\\"+mj-lt\\\"/><a:buAutoNum type=\\\"\" + (textObj.options.bullet.style ||\r\n                        'arabicPeriod') + \"\\\" startAt=\\\"\" + (textObj.options.bullet.startAt || '1') + \"\\\"/>\";\r\n                }\r\n            }\r\n            else if (textObj.options.bullet.code) {\r\n                var bulletCode = '&#x' + textObj.options.bullet.code + ';';\r\n                // Check value for hex-ness (s/b 4 char hex)\r\n                if (/^[0-9A-Fa-f]{4}$/.test(textObj.options.bullet.code) === false) {\r\n                    console.warn('Warning: `bullet.code should be a 4-digit hex code (ex: 22AB)`!');\r\n                    bulletCode = BULLET_TYPES['DEFAULT'];\r\n                }\r\n                paragraphPropXml +=\r\n                    ' marL=\"' +\r\n                        (textObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletLvl0Margin + bulletLvl0Margin * textObj.options.indentLevel : bulletLvl0Margin) +\r\n                        '\" indent=\"-' +\r\n                        bulletLvl0Margin +\r\n                        '\"';\r\n                strXmlBullet = '<a:buSzPct val=\"100000\"/><a:buChar char=\"' + bulletCode + '\"/>';\r\n            }\r\n        }\r\n        else if (textObj.options.bullet === true) {\r\n            paragraphPropXml +=\r\n                ' marL=\"' +\r\n                    (textObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletLvl0Margin + bulletLvl0Margin * textObj.options.indentLevel : bulletLvl0Margin) +\r\n                    '\" indent=\"-' +\r\n                    bulletLvl0Margin +\r\n                    '\"';\r\n            strXmlBullet = '<a:buSzPct val=\"100000\"/><a:buChar char=\"' + BULLET_TYPES['DEFAULT'] + '\"/>';\r\n        }\r\n        else {\r\n            strXmlBullet = '<a:buNone/>';\r\n        }\r\n        // B: Close Paragraph-Properties\r\n        // IMPORTANT: strXmlLnSpc, strXmlParaSpc, and strXmlBullet require strict ordering - anything out of order is ignored. (PPT-Online, PPT for Mac)\r\n        paragraphPropXml += '>' + strXmlLnSpc + strXmlParaSpc + strXmlBullet;\r\n        if (isDefault) {\r\n            paragraphPropXml += genXmlTextRunProperties(textObj.options, true);\r\n        }\r\n        paragraphPropXml += '</' + tag + '>';\r\n    }\r\n    return paragraphPropXml;\r\n}\r\n/**\r\n * Generate XML Text Run Properties (`a:rPr`)\r\n * @param {IObjectOptions|ITextOpts} opts - text options\r\n * @param {boolean} isDefault - whether these are the default text run properties\r\n * @return {string} XML\r\n */\r\nfunction genXmlTextRunProperties(opts, isDefault) {\r\n    var runProps = '';\r\n    var runPropsTag = isDefault ? 'a:defRPr' : 'a:rPr';\r\n    // BEGIN runProperties (ex: `<a:rPr lang=\"en-US\" sz=\"1600\" b=\"1\" dirty=\"0\">`)\r\n    runProps += '<' + runPropsTag + ' lang=\"' + (opts.lang ? opts.lang : 'en-US') + '\"' + (opts.lang ? ' altLang=\"en-US\"' : '');\r\n    runProps += opts.fontSize ? ' sz=\"' + Math.round(opts.fontSize) + '00\"' : ''; // NOTE: Use round so sizes like '7.5' wont cause corrupt pres.\r\n    runProps += opts.bold ? ' b=\"1\"' : '';\r\n    runProps += opts.italic ? ' i=\"1\"' : '';\r\n    runProps += opts.strike ? ' strike=\"sngStrike\"' : '';\r\n    runProps += opts.underline || opts.hyperlink ? ' u=\"sng\"' : '';\r\n    runProps += opts.subscript ? ' baseline=\"-40000\"' : opts.superscript ? ' baseline=\"30000\"' : '';\r\n    runProps += opts.charSpacing ? ' spc=\"' + opts.charSpacing * 100 + '\" kern=\"0\"' : ''; // IMPORTANT: Also disable kerning; otherwise text won't actually expand\r\n    runProps += ' dirty=\"0\">';\r\n    // Color / Font / Outline are children of <a:rPr>, so add them now before closing the runProperties tag\r\n    if (opts.color || opts.fontFace || opts.outline) {\r\n        if (opts.outline && typeof opts.outline === 'object') {\r\n            runProps += '<a:ln w=\"' + Math.round((opts.outline.size || 0.75) * ONEPT) + '\">' + genXmlColorSelection(opts.outline.color || 'FFFFFF') + '</a:ln>';\r\n        }\r\n        if (opts.color)\r\n            runProps += genXmlColorSelection(opts.color);\r\n        if (opts.fontFace) {\r\n            // NOTE: 'cs' = Complex Script, 'ea' = East Asian (use \"-120\" instead of \"0\" - per Issue #174); ea must come first (Issue #174)\r\n            runProps +=\r\n                '<a:latin typeface=\"' +\r\n                    opts.fontFace +\r\n                    '\" pitchFamily=\"34\" charset=\"0\"/>' +\r\n                    '<a:ea typeface=\"' +\r\n                    opts.fontFace +\r\n                    '\" pitchFamily=\"34\" charset=\"-122\"/>' +\r\n                    '<a:cs typeface=\"' +\r\n                    opts.fontFace +\r\n                    '\" pitchFamily=\"34\" charset=\"-120\"/>';\r\n        }\r\n    }\r\n    // Hyperlink support\r\n    if (opts.hyperlink) {\r\n        if (typeof opts.hyperlink !== 'object')\r\n            throw new Error(\"ERROR: text `hyperlink` option should be an object. Ex: `hyperlink:{url:'https://github.com'}` \");\r\n        else if (!opts.hyperlink.url && !opts.hyperlink.slide)\r\n            throw new Error(\"ERROR: 'hyperlink requires either `url` or `slide`'\");\r\n        else if (opts.hyperlink.url) {\r\n            // TODO: (20170410): FUTURE-FEATURE: color (link is always blue in Keynote and PPT online, so usual text run above isnt honored for links..?)\r\n            //runProps += '<a:uFill>'+ genXmlColorSelection('0000FF') +'</a:uFill>'; // Breaks PPT2010! (Issue#74)\r\n            runProps +=\r\n                '<a:hlinkClick r:id=\"rId' +\r\n                    opts.hyperlink.rId +\r\n                    '\" invalidUrl=\"\" action=\"\" tgtFrame=\"\" tooltip=\"' +\r\n                    (opts.hyperlink.tooltip ? encodeXmlEntities(opts.hyperlink.tooltip) : '') +\r\n                    '\" history=\"1\" highlightClick=\"0\" endSnd=\"0\"/>';\r\n        }\r\n        else if (opts.hyperlink.slide) {\r\n            runProps +=\r\n                '<a:hlinkClick r:id=\"rId' +\r\n                    opts.hyperlink.rId +\r\n                    '\" action=\"ppaction://hlinksldjump\" tooltip=\"' +\r\n                    (opts.hyperlink.tooltip ? encodeXmlEntities(opts.hyperlink.tooltip) : '') +\r\n                    '\"/>';\r\n        }\r\n    }\r\n    // END runProperties\r\n    runProps += '</' + runPropsTag + '>';\r\n    return runProps;\r\n}\r\n/**\r\n * Builds `<a:r></a:r>` text runs for `<a:p>` paragraphs in textBody\r\n * @param {IText} textObj - Text object\r\n * @return {string} XML string\r\n */\r\nfunction genXmlTextRun(textObj) {\r\n    var arrLines = [];\r\n    var paraProp = '';\r\n    var xmlTextRun = '';\r\n    // 1: ADD runProperties\r\n    var startInfo = genXmlTextRunProperties(textObj.options, false);\r\n    // 2: LINE-BREAKS/MULTI-LINE: Split text into multi-p:\r\n    arrLines = textObj.text.split(CRLF);\r\n    if (arrLines.length > 1) {\r\n        arrLines.forEach(function (line, idx) {\r\n            xmlTextRun += '<a:r>' + startInfo + '<a:t>' + encodeXmlEntities(line);\r\n            // Stop/Start <p>aragraph as long as there is more lines ahead (otherwise its closed at the end of this function)\r\n            if (idx + 1 < arrLines.length)\r\n                xmlTextRun += (textObj.options.breakLine ? CRLF : '') + '</a:t></a:r>';\r\n        });\r\n    }\r\n    else {\r\n        // Handle cases where addText `text` was an array of objects - if a text object doesnt contain a '\\n' it still need alignment!\r\n        // The first pPr-align is done in makeXml - use line countr to ensure we only add subsequently as needed\r\n        xmlTextRun = (textObj.options.align && textObj.options.lineIdx > 0 ? paraProp : '') + '<a:r>' + startInfo + '<a:t>' + encodeXmlEntities(textObj.text);\r\n    }\r\n    // Return paragraph with text run\r\n    return xmlTextRun + '</a:t></a:r>';\r\n}\r\n/**\r\n * Builds `<a:bodyPr></a:bodyPr>` tag for \"genXmlTextBody()\"\r\n * @param {ISlideObject | ITableCell} slideObject - various options\r\n * @return {string} XML string\r\n */\r\nfunction genXmlBodyProperties(slideObject) {\r\n    var bodyProperties = '<a:bodyPr';\r\n    if (slideObject && slideObject.type === SLIDE_OBJECT_TYPES.text && slideObject.options.bodyProp) {\r\n        // PPT-2019 EX: <a:bodyPr wrap=\"square\" lIns=\"1270\" tIns=\"1270\" rIns=\"1270\" bIns=\"1270\" rtlCol=\"0\" anchor=\"ctr\"/>\r\n        // A: Enable or disable textwrapping none or square\r\n        bodyProperties += slideObject.options.bodyProp.wrap ? ' wrap=\"' + slideObject.options.bodyProp.wrap + '\"' : ' wrap=\"square\"';\r\n        // B: Textbox margins [padding]\r\n        if (slideObject.options.bodyProp.lIns || slideObject.options.bodyProp.lIns === 0)\r\n            bodyProperties += ' lIns=\"' + slideObject.options.bodyProp.lIns + '\"';\r\n        if (slideObject.options.bodyProp.tIns || slideObject.options.bodyProp.tIns === 0)\r\n            bodyProperties += ' tIns=\"' + slideObject.options.bodyProp.tIns + '\"';\r\n        if (slideObject.options.bodyProp.rIns || slideObject.options.bodyProp.rIns === 0)\r\n            bodyProperties += ' rIns=\"' + slideObject.options.bodyProp.rIns + '\"';\r\n        if (slideObject.options.bodyProp.bIns || slideObject.options.bodyProp.bIns === 0)\r\n            bodyProperties += ' bIns=\"' + slideObject.options.bodyProp.bIns + '\"';\r\n        // C: Add rtl after margins\r\n        bodyProperties += ' rtlCol=\"0\"';\r\n        // D: Add anchorPoints\r\n        if (slideObject.options.bodyProp.anchor)\r\n            bodyProperties += ' anchor=\"' + slideObject.options.bodyProp.anchor + '\"'; // VALS: [t,ctr,b]\r\n        if (slideObject.options.bodyProp.vert)\r\n            bodyProperties += ' vert=\"' + slideObject.options.bodyProp.vert + '\"'; // VALS: [eaVert,horz,mongolianVert,vert,vert270,wordArtVert,wordArtVertRtl]\r\n        // E: Close <a:bodyPr element\r\n        bodyProperties += '>';\r\n        // F: NEW: Add autofit type tags\r\n        if (slideObject.options.shrinkText)\r\n            bodyProperties += '<a:normAutofit fontScale=\"85000\" lnSpcReduction=\"20000\"/>'; // MS-PPT > Format shape > Text Options: \"Shrink text on overflow\"\r\n        // MS-PPT > Format shape > Text Options: \"Resize shape to fit text\" [spAutoFit]\r\n        // NOTE: Use of '<a:noAutofit/>' in lieu of '' below causes issues in PPT-2013\r\n        bodyProperties += slideObject.options.bodyProp.autoFit !== false ? '<a:spAutoFit/>' : '';\r\n        // LAST: Close bodyProp\r\n        bodyProperties += '</a:bodyPr>';\r\n    }\r\n    else {\r\n        // DEFAULT:\r\n        bodyProperties += ' wrap=\"square\" rtlCol=\"0\">';\r\n        bodyProperties += '</a:bodyPr>';\r\n    }\r\n    // LAST: Return Close bodyProp\r\n    return slideObject.type === SLIDE_OBJECT_TYPES.tablecell ? '<a:bodyPr/>' : bodyProperties;\r\n}\r\n/**\r\n * Generate the XML for text and its options (bold, bullet, etc) including text runs (word-level formatting)\r\n * @note PPT text lines [lines followed by line-breaks] are created using <p>-aragraph's\r\n * @note Bullets are a paragprah-level formatting device\r\n * @param {ISlideObject|ITableCell} slideObj - slideObj -OR- table `cell` object\r\n * @returns XML containing the param object's text and formatting\r\n */\r\nfunction genXmlTextBody(slideObj) {\r\n    var opts = slideObj.options || {};\r\n    // FIRST: Shapes without text, etc. may be sent here during build, but have no text to render so return an empty string\r\n    if (opts && slideObj.type !== SLIDE_OBJECT_TYPES.tablecell && (typeof slideObj.text === 'undefined' || slideObj.text === null))\r\n        return '';\r\n    // Vars\r\n    var arrTextObjects = [];\r\n    var tagStart = slideObj.type === SLIDE_OBJECT_TYPES.tablecell ? '<a:txBody>' : '<p:txBody>';\r\n    var tagClose = slideObj.type === SLIDE_OBJECT_TYPES.tablecell ? '</a:txBody>' : '</p:txBody>';\r\n    var strSlideXml = tagStart;\r\n    // STEP 1: Modify slideObj to be consistent array of `{ text:'', options:{} }`\r\n    /* CASES:\r\n        addText( 'string' )\r\n        addText( 'line1\\n line2' )\r\n        addText( ['barry','allen'] )\r\n        addText( [{text'word1'}, {text:'word2'}] )\r\n        addText( [{text'line1\\n line2'}, {text:'end word'}] )\r\n    */\r\n    // A: Transform string/number into complex object\r\n    if (typeof slideObj.text === 'string' || typeof slideObj.text === 'number') {\r\n        slideObj.text = [{ text: slideObj.text.toString(), options: opts || {} }];\r\n    }\r\n    // STEP 2: Grab options, format line-breaks, etc.\r\n    if (Array.isArray(slideObj.text)) {\r\n        slideObj.text.forEach(function (obj, idx) {\r\n            // A: Set options\r\n            obj.options = obj.options || opts || {};\r\n            if (idx === 0 && obj.options && !obj.options.bullet && opts.bullet)\r\n                obj.options.bullet = opts.bullet;\r\n            // B: Cast to text-object and fix line-breaks (if needed)\r\n            if (typeof obj.text === 'string' || typeof obj.text === 'number') {\r\n                // 1: Convert \"\\n\" or any variation into CRLF\r\n                obj.text = obj.text.toString().replace(/\\r*\\n/g, CRLF);\r\n                // 2: Handle strings that contain \"\\n\"\r\n                if (obj.text.indexOf(CRLF) > -1) {\r\n                    // Remove trailing linebreak (if any) so the \"if\" below doesnt create a double CRLF+CRLF line ending!\r\n                    obj.text = obj.text.replace(/\\r\\n$/g, '');\r\n                    // Plain strings like \"hello \\n world\" or \"first line\\n\" need to have lineBreaks set to become 2 separate lines as intended\r\n                    obj.options.breakLine = true;\r\n                }\r\n                // 3: Add CRLF line ending if `breakLine`\r\n                if (obj.options.breakLine && !obj.options.bullet && !obj.options.align && idx + 1 < slideObj.text.length)\r\n                    obj.text += CRLF;\r\n            }\r\n            // C: If text string has line-breaks, then create a separate text-object for each (much easier than dealing with split inside a loop below)\r\n            if (obj.options.breakLine || obj.text.indexOf(CRLF) > -1) {\r\n                obj.text.split(CRLF).forEach(function (line, lineIdx) {\r\n                    // Add line-breaks if not bullets/aligned (we add CRLF for those below in STEP 3)\r\n                    // NOTE: Use \"idx>0\" so lines wont start with linebreak (eg:empty first line)\r\n                    arrTextObjects.push({\r\n                        text: (lineIdx > 0 && obj.options.breakLine && !obj.options.bullet && !obj.options.align ? CRLF : '') + line,\r\n                        options: obj.options,\r\n                    });\r\n                });\r\n            }\r\n            else {\r\n                // NOTE: The replace used here is for non-textObjects (plain strings) eg:'hello\\nworld'\r\n                arrTextObjects.push(obj);\r\n            }\r\n        });\r\n    }\r\n    // STEP 3: Add bodyProperties\r\n    {\r\n        // A: 'bodyPr'\r\n        strSlideXml += genXmlBodyProperties(slideObj);\r\n        // B: 'lstStyle'\r\n        // NOTE: shape type 'LINE' has different text align needs (a lstStyle.lvl1pPr between bodyPr and p)\r\n        // FIXME: LINE horiz-align doesnt work (text is always to the left inside line) (FYI: the PPT code diff is substantial!)\r\n        if (opts.h === 0 && opts.line && opts.align) {\r\n            strSlideXml += '<a:lstStyle><a:lvl1pPr algn=\"l\"/></a:lstStyle>';\r\n        }\r\n        else if (slideObj.type === 'placeholder') {\r\n            strSlideXml += '<a:lstStyle>';\r\n            strSlideXml += genXmlParagraphProperties(slideObj, true);\r\n            strSlideXml += '</a:lstStyle>';\r\n        }\r\n        else {\r\n            strSlideXml += '<a:lstStyle/>';\r\n        }\r\n    }\r\n    // STEP 4: Loop over each text object and create paragraph props, text run, etc.\r\n    arrTextObjects.forEach(function (textObj, idx) {\r\n        // Clear/Increment loop vars\r\n        var paragraphPropXml = '<a:pPr ' + (textObj.options.rtlMode ? ' rtl=\"1\" ' : '');\r\n        textObj.options.lineIdx = idx;\r\n        // A: Inherit pPr-type options from parent shape's `options`\r\n        textObj.options.align = textObj.options.align || opts.align;\r\n        textObj.options.lineSpacing = textObj.options.lineSpacing || opts.lineSpacing;\r\n        textObj.options.indentLevel = textObj.options.indentLevel || opts.indentLevel;\r\n        textObj.options.paraSpaceBefore = textObj.options.paraSpaceBefore || opts.paraSpaceBefore;\r\n        textObj.options.paraSpaceAfter = textObj.options.paraSpaceAfter || opts.paraSpaceAfter;\r\n        textObj.options.lineIdx = idx;\r\n        paragraphPropXml = genXmlParagraphProperties(textObj, false);\r\n        // B: Start paragraph if this is the first text obj, or if current textObj is about to be bulleted or aligned\r\n        if (idx === 0) {\r\n            // Add paragraphProperties right after <p> before textrun(s) begin\r\n            strSlideXml += '<a:p>' + paragraphPropXml;\r\n        }\r\n        else if (idx > 0 && (typeof textObj.options.bullet !== 'undefined' || typeof textObj.options.align !== 'undefined')) {\r\n            strSlideXml += '</a:p><a:p>' + paragraphPropXml;\r\n        }\r\n        // C: Inherit any main options (color, fontSize, etc.)\r\n        // We only pass the text.options to genXmlTextRun (not the Slide.options),\r\n        // so the run building function cant just fallback to Slide.color, therefore, we need to do that here before passing options below.\r\n        Object.entries(opts).forEach(function (_a) {\r\n            var key = _a[0], val = _a[1];\r\n            // NOTE: This loop will pick up unecessary keys (`x`, etc.), but it doesnt hurt anything\r\n            if (key !== 'bullet' && !textObj.options[key])\r\n                textObj.options[key] = val;\r\n        });\r\n        // D: Add formatted textrun\r\n        strSlideXml += genXmlTextRun(textObj);\r\n    });\r\n    // STEP 5: Append 'endParaRPr' (when needed) and close current open paragraph\r\n    // NOTE: (ISSUE#20, ISSUE#193): Add 'endParaRPr' with font/size props or PPT default (Arial/18pt en-us) is used making row \"too tall\"/not honoring options\r\n    if (slideObj.type === SLIDE_OBJECT_TYPES.tablecell && (opts.fontSize || opts.fontFace)) {\r\n        if (opts.fontFace) {\r\n            strSlideXml +=\r\n                '<a:endParaRPr lang=\"' + (opts.lang ? opts.lang : 'en-US') + '\"' + (opts.fontSize ? ' sz=\"' + Math.round(opts.fontSize) + '00\"' : '') + ' dirty=\"0\">';\r\n            strSlideXml += '<a:latin typeface=\"' + opts.fontFace + '\" charset=\"0\"/>';\r\n            strSlideXml += '<a:ea typeface=\"' + opts.fontFace + '\" charset=\"0\"/>';\r\n            strSlideXml += '<a:cs typeface=\"' + opts.fontFace + '\" charset=\"0\"/>';\r\n            strSlideXml += '</a:endParaRPr>';\r\n        }\r\n        else {\r\n            strSlideXml +=\r\n                '<a:endParaRPr lang=\"' + (opts.lang ? opts.lang : 'en-US') + '\"' + (opts.fontSize ? ' sz=\"' + Math.round(opts.fontSize) + '00\"' : '') + ' dirty=\"0\"/>';\r\n        }\r\n    }\r\n    else {\r\n        strSlideXml += '<a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\" dirty=\"0\"/>'; // NOTE: Added 20180101 to address PPT-2007 issues\r\n    }\r\n    strSlideXml += '</a:p>';\r\n    // STEP 6: Close the textBody\r\n    strSlideXml += tagClose;\r\n    // LAST: Return XML\r\n    return strSlideXml;\r\n}\r\n/**\r\n * Generate an XML Placeholder\r\n * @param {ISlideObject} placeholderObj\r\n * @returns XML\r\n */\r\nfunction genXmlPlaceholder(placeholderObj) {\r\n    if (!placeholderObj)\r\n        return '';\r\n    var placeholderIdx = placeholderObj.options && placeholderObj.options.placeholderIdx ? placeholderObj.options.placeholderIdx : '';\r\n    var placeholderType = placeholderObj.options && placeholderObj.options.placeholderType ? placeholderObj.options.placeholderType : '';\r\n    return \"<p:ph\\n\\t\\t\" + (placeholderIdx ? ' idx=\"' + placeholderIdx + '\"' : '') + \"\\n\\t\\t\" + (placeholderType && PLACEHOLDER_TYPES[placeholderType] ? ' type=\"' + PLACEHOLDER_TYPES[placeholderType] + '\"' : '') + \"\\n\\t\\t\" + (placeholderObj.text && placeholderObj.text.length > 0 ? ' hasCustomPrompt=\"1\"' : '') + \"\\n\\t\\t/>\";\r\n}\r\n// XML-GEN: First 6 functions create the base /ppt files\r\n/**\r\n * Generate XML ContentType\r\n * @param {ISlide[]} slides - slides\r\n * @param {ISlideLayout[]} slideLayouts - slide layouts\r\n * @param {ISlide} masterSlide - master slide\r\n * @returns XML\r\n */\r\nfunction makeXmlContTypes(slides, slideLayouts, masterSlide) {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n    strXml += '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">';\r\n    strXml += '<Default Extension=\"xml\" ContentType=\"application/xml\"/>';\r\n    strXml += '<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>';\r\n    strXml += '<Default Extension=\"jpeg\" ContentType=\"image/jpeg\"/>';\r\n    strXml += '<Default Extension=\"jpg\" ContentType=\"image/jpg\"/>';\r\n    // STEP 1: Add standard/any media types used in Presenation\r\n    strXml += '<Default Extension=\"png\" ContentType=\"image/png\"/>';\r\n    strXml += '<Default Extension=\"gif\" ContentType=\"image/gif\"/>';\r\n    strXml += '<Default Extension=\"m4v\" ContentType=\"video/mp4\"/>'; // NOTE: Hard-Code this extension as it wont be created in loop below (as extn !== type)\r\n    strXml += '<Default Extension=\"mp4\" ContentType=\"video/mp4\"/>'; // NOTE: Hard-Code this extension as it wont be created in loop below (as extn !== type)\r\n    slides.forEach(function (slide) {\r\n        (slide.relsMedia || []).forEach(function (rel) {\r\n            if (rel.type !== 'image' && rel.type !== 'online' && rel.type !== 'chart' && rel.extn !== 'm4v' && strXml.indexOf(rel.type) === -1) {\r\n                strXml += '<Default Extension=\"' + rel.extn + '\" ContentType=\"' + rel.type + '\"/>';\r\n            }\r\n        });\r\n    });\r\n    strXml += '<Default Extension=\"vml\" ContentType=\"application/vnd.openxmlformats-officedocument.vmlDrawing\"/>';\r\n    strXml += '<Default Extension=\"xlsx\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"/>';\r\n    // STEP 2: Add presentation and slide master(s)/slide(s)\r\n    strXml += '<Override PartName=\"/ppt/presentation.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml\"/>';\r\n    strXml += '<Override PartName=\"/ppt/notesMasters/notesMaster1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.notesMaster+xml\"/>';\r\n    slides.forEach(function (slide, idx) {\r\n        strXml +=\r\n            '<Override PartName=\"/ppt/slideMasters/slideMaster' +\r\n                (idx + 1) +\r\n                '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml\"/>';\r\n        strXml += '<Override PartName=\"/ppt/slides/slide' + (idx + 1) + '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\"/>';\r\n        // Add charts if any\r\n        slide.relsChart.forEach(function (rel) {\r\n            strXml += ' <Override PartName=\"' + rel.Target + '\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n        });\r\n    });\r\n    // STEP 3: Core PPT\r\n    strXml += '<Override PartName=\"/ppt/presProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presProps+xml\"/>';\r\n    strXml += '<Override PartName=\"/ppt/viewProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml\"/>';\r\n    strXml += '<Override PartName=\"/ppt/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>';\r\n    strXml += '<Override PartName=\"/ppt/tableStyles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml\"/>';\r\n    // STEP 4: Add Slide Layouts\r\n    slideLayouts.forEach(function (layout, idx) {\r\n        strXml +=\r\n            '<Override PartName=\"/ppt/slideLayouts/slideLayout' +\r\n                (idx + 1) +\r\n                '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml\"/>';\r\n        (layout.relsChart || []).forEach(function (rel) {\r\n            strXml += ' <Override PartName=\"' + rel.Target + '\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n        });\r\n    });\r\n    // STEP 5: Add notes slide(s)\r\n    slides.forEach(function (_slide, idx) {\r\n        strXml +=\r\n            ' <Override PartName=\"/ppt/notesSlides/notesSlide' +\r\n                (idx + 1) +\r\n                '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.notesSlide+xml\"/>';\r\n    });\r\n    // STEP 6: Add rels\r\n    masterSlide.relsChart.forEach(function (rel) {\r\n        strXml += ' <Override PartName=\"' + rel.Target + '\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n    });\r\n    masterSlide.relsMedia.forEach(function (rel) {\r\n        if (rel.type !== 'image' && rel.type !== 'online' && rel.type !== 'chart' && rel.extn !== 'm4v' && strXml.indexOf(rel.type) === -1)\r\n            strXml += ' <Default Extension=\"' + rel.extn + '\" ContentType=\"' + rel.type + '\"/>';\r\n    });\r\n    // LAST: Finish XML (Resume core)\r\n    strXml += ' <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>';\r\n    strXml += ' <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>';\r\n    strXml += '</Types>';\r\n    return strXml;\r\n}\r\n/**\r\n * Creates `_rels/.rels`\r\n * @returns XML\r\n */\r\nfunction makeXmlRootRels() {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF + \"<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n\\t\\t<Relationship Id=\\\"rId1\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\\\" Target=\\\"docProps/app.xml\\\"/>\\n\\t\\t<Relationship Id=\\\"rId2\\\" Type=\\\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\\\" Target=\\\"docProps/core.xml\\\"/>\\n\\t\\t<Relationship Id=\\\"rId3\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\\\" Target=\\\"ppt/presentation.xml\\\"/>\\n\\t\\t</Relationships>\";\r\n}\r\n/**\r\n * Creates `docProps/app.xml`\r\n * @param {ISlide[]} slides - Presenation Slides\r\n * @param {string} company - \"Company\" metadata\r\n * @returns XML\r\n */\r\nfunction makeXmlApp(slides, company) {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF + \"<Properties xmlns=\\\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\\\" xmlns:vt=\\\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\\\">\\n\\t<TotalTime>0</TotalTime>\\n\\t<Words>0</Words>\\n\\t<Application>Microsoft Office PowerPoint</Application>\\n\\t<PresentationFormat>On-screen Show (16:9)</PresentationFormat>\\n\\t<Paragraphs>0</Paragraphs>\\n\\t<Slides>\" + slides.length + \"</Slides>\\n\\t<Notes>\" + slides.length + \"</Notes>\\n\\t<HiddenSlides>0</HiddenSlides>\\n\\t<MMClips>0</MMClips>\\n\\t<ScaleCrop>false</ScaleCrop>\\n\\t<HeadingPairs>\\n\\t\\t<vt:vector size=\\\"6\\\" baseType=\\\"variant\\\">\\n\\t\\t\\t<vt:variant><vt:lpstr>Fonts Used</vt:lpstr></vt:variant>\\n\\t\\t\\t<vt:variant><vt:i4>2</vt:i4></vt:variant>\\n\\t\\t\\t<vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant>\\n\\t\\t\\t<vt:variant><vt:i4>1</vt:i4></vt:variant>\\n\\t\\t\\t<vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant>\\n\\t\\t\\t<vt:variant><vt:i4>\" + slides.length + \"</vt:i4></vt:variant>\\n\\t\\t</vt:vector>\\n\\t</HeadingPairs>\\n\\t<TitlesOfParts>\\n\\t\\t<vt:vector size=\\\"\" + (slides.length + 1 + 2) + \"\\\" baseType=\\\"lpstr\\\">\\n\\t\\t\\t<vt:lpstr>Arial</vt:lpstr>\\n\\t\\t\\t<vt:lpstr>Calibri</vt:lpstr>\\n\\t\\t\\t<vt:lpstr>Office Theme</vt:lpstr>\\n\\t\\t\\t\" + slides.map(function (_slideObj, idx) { return '<vt:lpstr>Slide ' + (idx + 1) + '</vt:lpstr>\\n'; }).join('') + \"\\n\\t\\t</vt:vector>\\n\\t</TitlesOfParts>\\n\\t<Company>\" + company + \"</Company>\\n\\t<LinksUpToDate>false</LinksUpToDate>\\n\\t<SharedDoc>false</SharedDoc>\\n\\t<HyperlinksChanged>false</HyperlinksChanged>\\n\\t<AppVersion>16.0000</AppVersion>\\n\\t</Properties>\";\r\n}\r\n/**\r\n * Creates `docProps/core.xml`\r\n * @param {string} title - metadata data\r\n * @param {string} company - metadata data\r\n * @param {string} author - metadata value\r\n * @param {string} revision - metadata value\r\n * @returns XML\r\n */\r\nfunction makeXmlCore(title, subject, author, revision) {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\\n\\t<cp:coreProperties xmlns:cp=\\\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\\\" xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:dcterms=\\\"http://purl.org/dc/terms/\\\" xmlns:dcmitype=\\\"http://purl.org/dc/dcmitype/\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\">\\n\\t\\t<dc:title>\" + encodeXmlEntities(title) + \"</dc:title>\\n\\t\\t<dc:subject>\" + encodeXmlEntities(subject) + \"</dc:subject>\\n\\t\\t<dc:creator>\" + encodeXmlEntities(author) + \"</dc:creator>\\n\\t\\t<cp:lastModifiedBy>\" + encodeXmlEntities(author) + \"</cp:lastModifiedBy>\\n\\t\\t<cp:revision>\" + revision + \"</cp:revision>\\n\\t\\t<dcterms:created xsi:type=\\\"dcterms:W3CDTF\\\">\" + new Date().toISOString().replace(/\\.\\d\\d\\dZ/, 'Z') + \"</dcterms:created>\\n\\t\\t<dcterms:modified xsi:type=\\\"dcterms:W3CDTF\\\">\" + new Date().toISOString().replace(/\\.\\d\\d\\dZ/, 'Z') + \"</dcterms:modified>\\n\\t</cp:coreProperties>\";\r\n}\r\n/**\r\n * Creates `ppt/_rels/presentation.xml.rels`\r\n * @param {ISlide[]} slides - Presenation Slides\r\n * @returns XML\r\n */\r\nfunction makeXmlPresentationRels(slides) {\r\n    var intRelNum = 1;\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n    strXml += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\r\n    strXml += '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\" Target=\"slideMasters/slideMaster1.xml\"/>';\r\n    for (var idx = 1; idx <= slides.length; idx++) {\r\n        strXml +=\r\n            '<Relationship Id=\"rId' + ++intRelNum + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\" Target=\"slides/slide' + idx + '.xml\"/>';\r\n    }\r\n    intRelNum++;\r\n    strXml +=\r\n        '<Relationship Id=\"rId' +\r\n            intRelNum +\r\n            '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesMaster\" Target=\"notesMasters/notesMaster1.xml\"/>' +\r\n            '<Relationship Id=\"rId' +\r\n            (intRelNum + 1) +\r\n            '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps\" Target=\"presProps.xml\"/>' +\r\n            '<Relationship Id=\"rId' +\r\n            (intRelNum + 2) +\r\n            '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps\" Target=\"viewProps.xml\"/>' +\r\n            '<Relationship Id=\"rId' +\r\n            (intRelNum + 3) +\r\n            '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>' +\r\n            '<Relationship Id=\"rId' +\r\n            (intRelNum + 4) +\r\n            '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles\" Target=\"tableStyles.xml\"/>' +\r\n            '</Relationships>';\r\n    return strXml;\r\n}\r\n// XML-GEN: Functions that run 1-N times (once for each Slide)\r\n/**\r\n * Generates XML for the slide file (`ppt/slides/slide1.xml`)\r\n * @param {ISlide} slide - the slide object to transform into XML\r\n * @return {string} XML\r\n */\r\nfunction makeXmlSlide(slide) {\r\n    return (\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF +\r\n        \"<p:sld xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" \" +\r\n        \"xmlns:p=\\\"http://schemas.openxmlformats.org/presentationml/2006/main\\\"\" +\r\n        ((slide && slide.hidden ? ' show=\"0\"' : '') + \">\") +\r\n        (\"\" + slideObjectToXml(slide)) +\r\n        \"<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sld>\");\r\n}\r\n/**\r\n * Get text content of Notes from Slide\r\n * @param {ISlide} slide - the slide object to transform into XML\r\n * @return {string} notes text\r\n */\r\nfunction getNotesFromSlide(slide) {\r\n    var notesText = '';\r\n    slide.data.forEach(function (data) {\r\n        if (data.type === 'notes')\r\n            notesText += data.text;\r\n    });\r\n    return notesText.replace(/\\r*\\n/g, CRLF);\r\n}\r\n/**\r\n * Generate XML for Notes Master (notesMaster1.xml)\r\n * @returns {string} XML\r\n */\r\nfunction makeXmlNotesMaster() {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF + \"<p:notesMaster xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:p=\\\"http://schemas.openxmlformats.org/presentationml/2006/main\\\"><p:cSld><p:bg><p:bgRef idx=\\\"1001\\\"><a:schemeClr val=\\\"bg1\\\"/></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id=\\\"1\\\" name=\\\"\\\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\\\"0\\\" y=\\\"0\\\"/><a:ext cx=\\\"0\\\" cy=\\\"0\\\"/><a:chOff x=\\\"0\\\" y=\\\"0\\\"/><a:chExt cx=\\\"0\\\" cy=\\\"0\\\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\\\"2\\\" name=\\\"Header Placeholder 1\\\"/><p:cNvSpPr><a:spLocks noGrp=\\\"1\\\"/></p:cNvSpPr><p:nvPr><p:ph type=\\\"hdr\\\" sz=\\\"quarter\\\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\\\"0\\\" y=\\\"0\\\"/><a:ext cx=\\\"2971800\\\" cy=\\\"458788\\\"/></a:xfrm><a:prstGeom prst=\\\"rect\\\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\\\"horz\\\" lIns=\\\"91440\\\" tIns=\\\"45720\\\" rIns=\\\"91440\\\" bIns=\\\"45720\\\" rtlCol=\\\"0\\\"/><a:lstStyle><a:lvl1pPr algn=\\\"l\\\"><a:defRPr sz=\\\"1200\\\"/></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\\\"en-US\\\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\\\"3\\\" name=\\\"Date Placeholder 2\\\"/><p:cNvSpPr><a:spLocks noGrp=\\\"1\\\"/></p:cNvSpPr><p:nvPr><p:ph type=\\\"dt\\\" idx=\\\"1\\\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\\\"3884613\\\" y=\\\"0\\\"/><a:ext cx=\\\"2971800\\\" cy=\\\"458788\\\"/></a:xfrm><a:prstGeom prst=\\\"rect\\\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\\\"horz\\\" lIns=\\\"91440\\\" tIns=\\\"45720\\\" rIns=\\\"91440\\\" bIns=\\\"45720\\\" rtlCol=\\\"0\\\"/><a:lstStyle><a:lvl1pPr algn=\\\"r\\\"><a:defRPr sz=\\\"1200\\\"/></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\\\"{5282F153-3F37-0F45-9E97-73ACFA13230C}\\\" type=\\\"datetimeFigureOut\\\"><a:rPr lang=\\\"en-US\\\"/><a:t>7/23/19</a:t></a:fld><a:endParaRPr lang=\\\"en-US\\\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\\\"4\\\" name=\\\"Slide Image Placeholder 3\\\"/><p:cNvSpPr><a:spLocks noGrp=\\\"1\\\" noRot=\\\"1\\\" noChangeAspect=\\\"1\\\"/></p:cNvSpPr><p:nvPr><p:ph type=\\\"sldImg\\\" idx=\\\"2\\\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\\\"685800\\\" y=\\\"1143000\\\"/><a:ext cx=\\\"5486400\\\" cy=\\\"3086100\\\"/></a:xfrm><a:prstGeom prst=\\\"rect\\\"><a:avLst/></a:prstGeom><a:noFill/><a:ln w=\\\"12700\\\"><a:solidFill><a:prstClr val=\\\"black\\\"/></a:solidFill></a:ln></p:spPr><p:txBody><a:bodyPr vert=\\\"horz\\\" lIns=\\\"91440\\\" tIns=\\\"45720\\\" rIns=\\\"91440\\\" bIns=\\\"45720\\\" rtlCol=\\\"0\\\" anchor=\\\"ctr\\\"/><a:lstStyle/><a:p><a:endParaRPr lang=\\\"en-US\\\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\\\"5\\\" name=\\\"Notes Placeholder 4\\\"/><p:cNvSpPr><a:spLocks noGrp=\\\"1\\\"/></p:cNvSpPr><p:nvPr><p:ph type=\\\"body\\\" sz=\\\"quarter\\\" idx=\\\"3\\\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\\\"685800\\\" y=\\\"4400550\\\"/><a:ext cx=\\\"5486400\\\" cy=\\\"3600450\\\"/></a:xfrm><a:prstGeom prst=\\\"rect\\\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\\\"horz\\\" lIns=\\\"91440\\\" tIns=\\\"45720\\\" rIns=\\\"91440\\\" bIns=\\\"45720\\\" rtlCol=\\\"0\\\"/><a:lstStyle/><a:p><a:pPr lvl=\\\"0\\\"/><a:r><a:rPr lang=\\\"en-US\\\"/><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl=\\\"1\\\"/><a:r><a:rPr lang=\\\"en-US\\\"/><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl=\\\"2\\\"/><a:r><a:rPr lang=\\\"en-US\\\"/><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl=\\\"3\\\"/><a:r><a:rPr lang=\\\"en-US\\\"/><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl=\\\"4\\\"/><a:r><a:rPr lang=\\\"en-US\\\"/><a:t>Fifth level</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\\\"6\\\" name=\\\"Footer Placeholder 5\\\"/><p:cNvSpPr><a:spLocks noGrp=\\\"1\\\"/></p:cNvSpPr><p:nvPr><p:ph type=\\\"ftr\\\" sz=\\\"quarter\\\" idx=\\\"4\\\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\\\"0\\\" y=\\\"8685213\\\"/><a:ext cx=\\\"2971800\\\" cy=\\\"458787\\\"/></a:xfrm><a:prstGeom prst=\\\"rect\\\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\\\"horz\\\" lIns=\\\"91440\\\" tIns=\\\"45720\\\" rIns=\\\"91440\\\" bIns=\\\"45720\\\" rtlCol=\\\"0\\\" anchor=\\\"b\\\"/><a:lstStyle><a:lvl1pPr algn=\\\"l\\\"><a:defRPr sz=\\\"1200\\\"/></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\\\"en-US\\\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\\\"7\\\" name=\\\"Slide Number Placeholder 6\\\"/><p:cNvSpPr><a:spLocks noGrp=\\\"1\\\"/></p:cNvSpPr><p:nvPr><p:ph type=\\\"sldNum\\\" sz=\\\"quarter\\\" idx=\\\"5\\\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\\\"3884613\\\" y=\\\"8685213\\\"/><a:ext cx=\\\"2971800\\\" cy=\\\"458787\\\"/></a:xfrm><a:prstGeom prst=\\\"rect\\\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\\\"horz\\\" lIns=\\\"91440\\\" tIns=\\\"45720\\\" rIns=\\\"91440\\\" bIns=\\\"45720\\\" rtlCol=\\\"0\\\" anchor=\\\"b\\\"/><a:lstStyle><a:lvl1pPr algn=\\\"r\\\"><a:defRPr sz=\\\"1200\\\"/></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\\\"{CE5E9CC1-C706-0F49-92D6-E571CC5EEA8F}\\\" type=\\\"slidenum\\\"><a:rPr lang=\\\"en-US\\\"/><a:t>\\u2039#\\u203A</a:t></a:fld><a:endParaRPr lang=\\\"en-US\\\"/></a:p></p:txBody></p:sp></p:spTree><p:extLst><p:ext uri=\\\"{BB962C8B-B14F-4D97-AF65-F5344CB8AC3E}\\\"><p14:creationId xmlns:p14=\\\"http://schemas.microsoft.com/office/powerpoint/2010/main\\\" val=\\\"1024086991\\\"/></p:ext></p:extLst></p:cSld><p:clrMap bg1=\\\"lt1\\\" tx1=\\\"dk1\\\" bg2=\\\"lt2\\\" tx2=\\\"dk2\\\" accent1=\\\"accent1\\\" accent2=\\\"accent2\\\" accent3=\\\"accent3\\\" accent4=\\\"accent4\\\" accent5=\\\"accent5\\\" accent6=\\\"accent6\\\" hlink=\\\"hlink\\\" folHlink=\\\"folHlink\\\"/><p:notesStyle><a:lvl1pPr marL=\\\"0\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\\\"457200\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\\\"914400\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\\\"1371600\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\\\"1828800\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\\\"2286000\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\\\"2743200\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\\\"3200400\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\\\"3657600\\\" algn=\\\"l\\\" defTabSz=\\\"914400\\\" rtl=\\\"0\\\" eaLnBrk=\\\"1\\\" latinLnBrk=\\\"0\\\" hangingPunct=\\\"1\\\"><a:defRPr sz=\\\"1200\\\" kern=\\\"1200\\\"><a:solidFill><a:schemeClr val=\\\"tx1\\\"/></a:solidFill><a:latin typeface=\\\"+mn-lt\\\"/><a:ea typeface=\\\"+mn-ea\\\"/><a:cs typeface=\\\"+mn-cs\\\"/></a:defRPr></a:lvl9pPr></p:notesStyle></p:notesMaster>\";\r\n}\r\n/**\r\n * Creates Notes Slide (`ppt/notesSlides/notesSlide1.xml`)\r\n * @param {ISlide} slide - the slide object to transform into XML\r\n * @return {string} XML\r\n */\r\nfunction makeXmlNotesSlide(slide) {\r\n    return ('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n        CRLF +\r\n        '<p:notes xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">' +\r\n        '<p:cSld><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/>' +\r\n        '<p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/>' +\r\n        '<a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/>' +\r\n        '</a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Slide Image Placeholder 1\"/>' +\r\n        '<p:cNvSpPr><a:spLocks noGrp=\"1\" noRot=\"1\" noChangeAspect=\"1\"/></p:cNvSpPr>' +\r\n        '<p:nvPr><p:ph type=\"sldImg\"/></p:nvPr></p:nvSpPr><p:spPr/>' +\r\n        '</p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Notes Placeholder 2\"/>' +\r\n        '<p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr>' +\r\n        '<p:ph type=\"body\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr/>' +\r\n        '<p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:r>' +\r\n        '<a:rPr lang=\"en-US\" dirty=\"0\"/><a:t>' +\r\n        encodeXmlEntities(getNotesFromSlide(slide)) +\r\n        '</a:t></a:r><a:endParaRPr lang=\"en-US\" dirty=\"0\"/></a:p></p:txBody>' +\r\n        '</p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Slide Number Placeholder 3\"/>' +\r\n        '<p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr>' +\r\n        '<p:ph type=\"sldNum\" sz=\"quarter\" idx=\"10\"/></p:nvPr></p:nvSpPr>' +\r\n        '<p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p>' +\r\n        '<a:fld id=\"' +\r\n        SLDNUMFLDID +\r\n        '\" type=\"slidenum\">' +\r\n        '<a:rPr lang=\"en-US\"/><a:t>' +\r\n        slide.number +\r\n        '</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>' +\r\n        '</p:spTree><p:extLst><p:ext uri=\"{BB962C8B-B14F-4D97-AF65-F5344CB8AC3E}\">' +\r\n        '<p14:creationId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1024086991\"/>' +\r\n        '</p:ext></p:extLst></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:notes>');\r\n}\r\n/**\r\n * Generates the XML layout resource from a layout object\r\n * @param {ISlideLayout} layout - slide layout (master)\r\n * @return {string} XML\r\n */\r\nfunction makeXmlLayout(layout) {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\\n\\t\\t<p:sldLayout xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:p=\\\"http://schemas.openxmlformats.org/presentationml/2006/main\\\" preserve=\\\"1\\\">\\n\\t\\t\" + slideObjectToXml(layout) + \"\\n\\t\\t<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sldLayout>\";\r\n}\r\n/**\r\n * Creates Slide Master 1 (`ppt/slideMasters/slideMaster1.xml`)\r\n * @param {ISlide} slide - slide object that represents master slide layout\r\n * @param {ISlideLayout[]} layouts - slide layouts\r\n * @return {string} XML\r\n */\r\nfunction makeXmlMaster(slide, layouts) {\r\n    // NOTE: Pass layouts as static rels because they are not referenced any time\r\n    var layoutDefs = layouts.map(function (_layoutDef, idx) { return '<p:sldLayoutId id=\"' + (LAYOUT_IDX_SERIES_BASE + idx) + '\" r:id=\"rId' + (slide.rels.length + idx + 1) + '\"/>'; });\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n    strXml +=\r\n        '<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">';\r\n    strXml += slideObjectToXml(slide);\r\n    strXml +=\r\n        '<p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\"/>';\r\n    strXml += '<p:sldLayoutIdLst>' + layoutDefs.join('') + '</p:sldLayoutIdLst>';\r\n    strXml += '<p:hf sldNum=\"0\" hdr=\"0\" ftr=\"0\" dt=\"0\"/>';\r\n    strXml +=\r\n        '<p:txStyles>' +\r\n            ' <p:titleStyle>' +\r\n            '  <a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr>' +\r\n            ' </p:titleStyle>' +\r\n            ' <p:bodyStyle>' +\r\n            '  <a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>' +\r\n            '  <a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"–\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>' +\r\n            '  <a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>' +\r\n            '  <a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"–\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>' +\r\n            '  <a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"»\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>' +\r\n            '  <a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>' +\r\n            '  <a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>' +\r\n            '  <a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>' +\r\n            '  <a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>' +\r\n            ' </p:bodyStyle>' +\r\n            ' <p:otherStyle>' +\r\n            '  <a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>' +\r\n            '  <a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>' +\r\n            '  <a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>' +\r\n            '  <a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>' +\r\n            '  <a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>' +\r\n            '  <a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>' +\r\n            '  <a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>' +\r\n            '  <a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>' +\r\n            '  <a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>' +\r\n            '  <a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>' +\r\n            ' </p:otherStyle>' +\r\n            '</p:txStyles>';\r\n    strXml += '</p:sldMaster>';\r\n    return strXml;\r\n}\r\n/**\r\n * Generates XML string for a slide layout relation file\r\n * @param {number} layoutNumber - 1-indexed number of a layout that relations are generated for\r\n * @param {ISlideLayout[]} slideLayouts - Slide Layouts\r\n * @return {string} XML\r\n */\r\nfunction makeXmlSlideLayoutRel(layoutNumber, slideLayouts) {\r\n    return slideObjectRelationsToXml(slideLayouts[layoutNumber - 1], [\r\n        {\r\n            target: '../slideMasters/slideMaster1.xml',\r\n            type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\r\n        },\r\n    ]);\r\n}\r\n/**\r\n * Creates `ppt/_rels/slide*.xml.rels`\r\n * @param {ISlide[]} slides\r\n * @param {ISlideLayout[]} slideLayouts - Slide Layout(s)\r\n * @param {number} `slideNumber` 1-indexed number of a layout that relations are generated for\r\n * @return {string} XML\r\n */\r\nfunction makeXmlSlideRel(slides, slideLayouts, slideNumber) {\r\n    return slideObjectRelationsToXml(slides[slideNumber - 1], [\r\n        {\r\n            target: '../slideLayouts/slideLayout' + getLayoutIdxForSlide(slides, slideLayouts, slideNumber) + '.xml',\r\n            type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\r\n        },\r\n        {\r\n            target: '../notesSlides/notesSlide' + slideNumber + '.xml',\r\n            type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesSlide',\r\n        },\r\n    ]);\r\n}\r\n/**\r\n * Generates XML string for a slide relation file.\r\n * @param {number} slideNumber - 1-indexed number of a layout that relations are generated for\r\n * @return {string} XML\r\n */\r\nfunction makeXmlNotesSlideRel(slideNumber) {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\\n\\t\\t<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n\\t\\t\\t<Relationship Id=\\\"rId1\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesMaster\\\" Target=\\\"../notesMasters/notesMaster1.xml\\\"/>\\n\\t\\t\\t<Relationship Id=\\\"rId2\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\\\" Target=\\\"../slides/slide\" + slideNumber + \".xml\\\"/>\\n\\t\\t</Relationships>\";\r\n}\r\n/**\r\n * Creates `ppt/slideMasters/_rels/slideMaster1.xml.rels`\r\n * @param {ISlide} masterSlide - Slide object\r\n * @param {ISlideLayout[]} slideLayouts - Slide Layouts\r\n * @return {string} XML\r\n */\r\nfunction makeXmlMasterRel(masterSlide, slideLayouts) {\r\n    var defaultRels = slideLayouts.map(function (_layoutDef, idx) {\r\n        return { target: \"../slideLayouts/slideLayout\" + (idx + 1) + \".xml\", type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout' };\r\n    });\r\n    defaultRels.push({ target: '../theme/theme1.xml', type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme' });\r\n    return slideObjectRelationsToXml(masterSlide, defaultRels);\r\n}\r\n/**\r\n * Creates `ppt/notesMasters/_rels/notesMaster1.xml.rels`\r\n * @return {string} XML\r\n */\r\nfunction makeXmlNotesMasterRel() {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF + \"<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n\\t\\t<Relationship Id=\\\"rId1\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\\\" Target=\\\"../theme/theme1.xml\\\"/>\\n\\t\\t</Relationships>\";\r\n}\r\n/**\r\n * For the passed slide number, resolves name of a layout that is used for.\r\n * @param {ISlide[]} slides - srray of slides\r\n * @param {ISlideLayout[]} slideLayouts - array of slideLayouts\r\n * @param {number} slideNumber\r\n * @return {number} slide number\r\n */\r\nfunction getLayoutIdxForSlide(slides, slideLayouts, slideNumber) {\r\n    for (var i = 0; i < slideLayouts.length; i++) {\r\n        if (slideLayouts[i].name === slides[slideNumber - 1].slideLayout.name) {\r\n            return i + 1;\r\n        }\r\n    }\r\n    // IMPORTANT: Return 1 (for `slideLayout1.xml`) when no def is found\r\n    // So all objects are in Layout1 and every slide that references it uses this layout.\r\n    return 1;\r\n}\r\n// XML-GEN: Last 5 functions create root /ppt files\r\n/**\r\n * Creates `ppt/theme/theme1.xml`\r\n * @return {string} XML\r\n */\r\nfunction makeXmlTheme() {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF + \"<a:theme xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\" name=\\\"Office Theme\\\"><a:themeElements><a:clrScheme name=\\\"Office\\\"><a:dk1><a:sysClr val=\\\"windowText\\\" lastClr=\\\"000000\\\"/></a:dk1><a:lt1><a:sysClr val=\\\"window\\\" lastClr=\\\"FFFFFF\\\"/></a:lt1><a:dk2><a:srgbClr val=\\\"44546A\\\"/></a:dk2><a:lt2><a:srgbClr val=\\\"E7E6E6\\\"/></a:lt2><a:accent1><a:srgbClr val=\\\"4472C4\\\"/></a:accent1><a:accent2><a:srgbClr val=\\\"ED7D31\\\"/></a:accent2><a:accent3><a:srgbClr val=\\\"A5A5A5\\\"/></a:accent3><a:accent4><a:srgbClr val=\\\"FFC000\\\"/></a:accent4><a:accent5><a:srgbClr val=\\\"5B9BD5\\\"/></a:accent5><a:accent6><a:srgbClr val=\\\"70AD47\\\"/></a:accent6><a:hlink><a:srgbClr val=\\\"0563C1\\\"/></a:hlink><a:folHlink><a:srgbClr val=\\\"954F72\\\"/></a:folHlink></a:clrScheme><a:fontScheme name=\\\"Office\\\"><a:majorFont><a:latin typeface=\\\"Calibri Light\\\" panose=\\\"020F0302020204030204\\\"/><a:ea typeface=\\\"\\\"/><a:cs typeface=\\\"\\\"/><a:font script=\\\"Jpan\\\" typeface=\\\"\\u6E38\\u30B4\\u30B7\\u30C3\\u30AF Light\\\"/><a:font script=\\\"Hang\\\" typeface=\\\"\\uB9D1\\uC740 \\uACE0\\uB515\\\"/><a:font script=\\\"Hans\\\" typeface=\\\"\\u7B49\\u7EBF Light\\\"/><a:font script=\\\"Hant\\\" typeface=\\\"\\u65B0\\u7D30\\u660E\\u9AD4\\\"/><a:font script=\\\"Arab\\\" typeface=\\\"Times New Roman\\\"/><a:font script=\\\"Hebr\\\" typeface=\\\"Times New Roman\\\"/><a:font script=\\\"Thai\\\" typeface=\\\"Angsana New\\\"/><a:font script=\\\"Ethi\\\" typeface=\\\"Nyala\\\"/><a:font script=\\\"Beng\\\" typeface=\\\"Vrinda\\\"/><a:font script=\\\"Gujr\\\" typeface=\\\"Shruti\\\"/><a:font script=\\\"Khmr\\\" typeface=\\\"MoolBoran\\\"/><a:font script=\\\"Knda\\\" typeface=\\\"Tunga\\\"/><a:font script=\\\"Guru\\\" typeface=\\\"Raavi\\\"/><a:font script=\\\"Cans\\\" typeface=\\\"Euphemia\\\"/><a:font script=\\\"Cher\\\" typeface=\\\"Plantagenet Cherokee\\\"/><a:font script=\\\"Yiii\\\" typeface=\\\"Microsoft Yi Baiti\\\"/><a:font script=\\\"Tibt\\\" typeface=\\\"Microsoft Himalaya\\\"/><a:font script=\\\"Thaa\\\" typeface=\\\"MV Boli\\\"/><a:font script=\\\"Deva\\\" typeface=\\\"Mangal\\\"/><a:font script=\\\"Telu\\\" typeface=\\\"Gautami\\\"/><a:font script=\\\"Taml\\\" typeface=\\\"Latha\\\"/><a:font script=\\\"Syrc\\\" typeface=\\\"Estrangelo Edessa\\\"/><a:font script=\\\"Orya\\\" typeface=\\\"Kalinga\\\"/><a:font script=\\\"Mlym\\\" typeface=\\\"Kartika\\\"/><a:font script=\\\"Laoo\\\" typeface=\\\"DokChampa\\\"/><a:font script=\\\"Sinh\\\" typeface=\\\"Iskoola Pota\\\"/><a:font script=\\\"Mong\\\" typeface=\\\"Mongolian Baiti\\\"/><a:font script=\\\"Viet\\\" typeface=\\\"Times New Roman\\\"/><a:font script=\\\"Uigh\\\" typeface=\\\"Microsoft Uighur\\\"/><a:font script=\\\"Geor\\\" typeface=\\\"Sylfaen\\\"/><a:font script=\\\"Armn\\\" typeface=\\\"Arial\\\"/><a:font script=\\\"Bugi\\\" typeface=\\\"Leelawadee UI\\\"/><a:font script=\\\"Bopo\\\" typeface=\\\"Microsoft JhengHei\\\"/><a:font script=\\\"Java\\\" typeface=\\\"Javanese Text\\\"/><a:font script=\\\"Lisu\\\" typeface=\\\"Segoe UI\\\"/><a:font script=\\\"Mymr\\\" typeface=\\\"Myanmar Text\\\"/><a:font script=\\\"Nkoo\\\" typeface=\\\"Ebrima\\\"/><a:font script=\\\"Olck\\\" typeface=\\\"Nirmala UI\\\"/><a:font script=\\\"Osma\\\" typeface=\\\"Ebrima\\\"/><a:font script=\\\"Phag\\\" typeface=\\\"Phagspa\\\"/><a:font script=\\\"Syrn\\\" typeface=\\\"Estrangelo Edessa\\\"/><a:font script=\\\"Syrj\\\" typeface=\\\"Estrangelo Edessa\\\"/><a:font script=\\\"Syre\\\" typeface=\\\"Estrangelo Edessa\\\"/><a:font script=\\\"Sora\\\" typeface=\\\"Nirmala UI\\\"/><a:font script=\\\"Tale\\\" typeface=\\\"Microsoft Tai Le\\\"/><a:font script=\\\"Talu\\\" typeface=\\\"Microsoft New Tai Lue\\\"/><a:font script=\\\"Tfng\\\" typeface=\\\"Ebrima\\\"/></a:majorFont><a:minorFont><a:latin typeface=\\\"Calibri\\\" panose=\\\"020F0502020204030204\\\"/><a:ea typeface=\\\"\\\"/><a:cs typeface=\\\"\\\"/><a:font script=\\\"Jpan\\\" typeface=\\\"\\u6E38\\u30B4\\u30B7\\u30C3\\u30AF\\\"/><a:font script=\\\"Hang\\\" typeface=\\\"\\uB9D1\\uC740 \\uACE0\\uB515\\\"/><a:font script=\\\"Hans\\\" typeface=\\\"\\u7B49\\u7EBF\\\"/><a:font script=\\\"Hant\\\" typeface=\\\"\\u65B0\\u7D30\\u660E\\u9AD4\\\"/><a:font script=\\\"Arab\\\" typeface=\\\"Arial\\\"/><a:font script=\\\"Hebr\\\" typeface=\\\"Arial\\\"/><a:font script=\\\"Thai\\\" typeface=\\\"Cordia New\\\"/><a:font script=\\\"Ethi\\\" typeface=\\\"Nyala\\\"/><a:font script=\\\"Beng\\\" typeface=\\\"Vrinda\\\"/><a:font script=\\\"Gujr\\\" typeface=\\\"Shruti\\\"/><a:font script=\\\"Khmr\\\" typeface=\\\"DaunPenh\\\"/><a:font script=\\\"Knda\\\" typeface=\\\"Tunga\\\"/><a:font script=\\\"Guru\\\" typeface=\\\"Raavi\\\"/><a:font script=\\\"Cans\\\" typeface=\\\"Euphemia\\\"/><a:font script=\\\"Cher\\\" typeface=\\\"Plantagenet Cherokee\\\"/><a:font script=\\\"Yiii\\\" typeface=\\\"Microsoft Yi Baiti\\\"/><a:font script=\\\"Tibt\\\" typeface=\\\"Microsoft Himalaya\\\"/><a:font script=\\\"Thaa\\\" typeface=\\\"MV Boli\\\"/><a:font script=\\\"Deva\\\" typeface=\\\"Mangal\\\"/><a:font script=\\\"Telu\\\" typeface=\\\"Gautami\\\"/><a:font script=\\\"Taml\\\" typeface=\\\"Latha\\\"/><a:font script=\\\"Syrc\\\" typeface=\\\"Estrangelo Edessa\\\"/><a:font script=\\\"Orya\\\" typeface=\\\"Kalinga\\\"/><a:font script=\\\"Mlym\\\" typeface=\\\"Kartika\\\"/><a:font script=\\\"Laoo\\\" typeface=\\\"DokChampa\\\"/><a:font script=\\\"Sinh\\\" typeface=\\\"Iskoola Pota\\\"/><a:font script=\\\"Mong\\\" typeface=\\\"Mongolian Baiti\\\"/><a:font script=\\\"Viet\\\" typeface=\\\"Arial\\\"/><a:font script=\\\"Uigh\\\" typeface=\\\"Microsoft Uighur\\\"/><a:font script=\\\"Geor\\\" typeface=\\\"Sylfaen\\\"/><a:font script=\\\"Armn\\\" typeface=\\\"Arial\\\"/><a:font script=\\\"Bugi\\\" typeface=\\\"Leelawadee UI\\\"/><a:font script=\\\"Bopo\\\" typeface=\\\"Microsoft JhengHei\\\"/><a:font script=\\\"Java\\\" typeface=\\\"Javanese Text\\\"/><a:font script=\\\"Lisu\\\" typeface=\\\"Segoe UI\\\"/><a:font script=\\\"Mymr\\\" typeface=\\\"Myanmar Text\\\"/><a:font script=\\\"Nkoo\\\" typeface=\\\"Ebrima\\\"/><a:font script=\\\"Olck\\\" typeface=\\\"Nirmala UI\\\"/><a:font script=\\\"Osma\\\" typeface=\\\"Ebrima\\\"/><a:font script=\\\"Phag\\\" typeface=\\\"Phagspa\\\"/><a:font script=\\\"Syrn\\\" typeface=\\\"Estrangelo Edessa\\\"/><a:font script=\\\"Syrj\\\" typeface=\\\"Estrangelo Edessa\\\"/><a:font script=\\\"Syre\\\" typeface=\\\"Estrangelo Edessa\\\"/><a:font script=\\\"Sora\\\" typeface=\\\"Nirmala UI\\\"/><a:font script=\\\"Tale\\\" typeface=\\\"Microsoft Tai Le\\\"/><a:font script=\\\"Talu\\\" typeface=\\\"Microsoft New Tai Lue\\\"/><a:font script=\\\"Tfng\\\" typeface=\\\"Ebrima\\\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\\\"Office\\\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\\\"phClr\\\"/></a:solidFill><a:gradFill rotWithShape=\\\"1\\\"><a:gsLst><a:gs pos=\\\"0\\\"><a:schemeClr val=\\\"phClr\\\"><a:lumMod val=\\\"110000\\\"/><a:satMod val=\\\"105000\\\"/><a:tint val=\\\"67000\\\"/></a:schemeClr></a:gs><a:gs pos=\\\"50000\\\"><a:schemeClr val=\\\"phClr\\\"><a:lumMod val=\\\"105000\\\"/><a:satMod val=\\\"103000\\\"/><a:tint val=\\\"73000\\\"/></a:schemeClr></a:gs><a:gs pos=\\\"100000\\\"><a:schemeClr val=\\\"phClr\\\"><a:lumMod val=\\\"105000\\\"/><a:satMod val=\\\"109000\\\"/><a:tint val=\\\"81000\\\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\\\"5400000\\\" scaled=\\\"0\\\"/></a:gradFill><a:gradFill rotWithShape=\\\"1\\\"><a:gsLst><a:gs pos=\\\"0\\\"><a:schemeClr val=\\\"phClr\\\"><a:satMod val=\\\"103000\\\"/><a:lumMod val=\\\"102000\\\"/><a:tint val=\\\"94000\\\"/></a:schemeClr></a:gs><a:gs pos=\\\"50000\\\"><a:schemeClr val=\\\"phClr\\\"><a:satMod val=\\\"110000\\\"/><a:lumMod val=\\\"100000\\\"/><a:shade val=\\\"100000\\\"/></a:schemeClr></a:gs><a:gs pos=\\\"100000\\\"><a:schemeClr val=\\\"phClr\\\"><a:lumMod val=\\\"99000\\\"/><a:satMod val=\\\"120000\\\"/><a:shade val=\\\"78000\\\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\\\"5400000\\\" scaled=\\\"0\\\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\\\"6350\\\" cap=\\\"flat\\\" cmpd=\\\"sng\\\" algn=\\\"ctr\\\"><a:solidFill><a:schemeClr val=\\\"phClr\\\"/></a:solidFill><a:prstDash val=\\\"solid\\\"/><a:miter lim=\\\"800000\\\"/></a:ln><a:ln w=\\\"12700\\\" cap=\\\"flat\\\" cmpd=\\\"sng\\\" algn=\\\"ctr\\\"><a:solidFill><a:schemeClr val=\\\"phClr\\\"/></a:solidFill><a:prstDash val=\\\"solid\\\"/><a:miter lim=\\\"800000\\\"/></a:ln><a:ln w=\\\"19050\\\" cap=\\\"flat\\\" cmpd=\\\"sng\\\" algn=\\\"ctr\\\"><a:solidFill><a:schemeClr val=\\\"phClr\\\"/></a:solidFill><a:prstDash val=\\\"solid\\\"/><a:miter lim=\\\"800000\\\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\\\"57150\\\" dist=\\\"19050\\\" dir=\\\"5400000\\\" algn=\\\"ctr\\\" rotWithShape=\\\"0\\\"><a:srgbClr val=\\\"000000\\\"><a:alpha val=\\\"63000\\\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\\\"phClr\\\"/></a:solidFill><a:solidFill><a:schemeClr val=\\\"phClr\\\"><a:tint val=\\\"95000\\\"/><a:satMod val=\\\"170000\\\"/></a:schemeClr></a:solidFill><a:gradFill rotWithShape=\\\"1\\\"><a:gsLst><a:gs pos=\\\"0\\\"><a:schemeClr val=\\\"phClr\\\"><a:tint val=\\\"93000\\\"/><a:satMod val=\\\"150000\\\"/><a:shade val=\\\"98000\\\"/><a:lumMod val=\\\"102000\\\"/></a:schemeClr></a:gs><a:gs pos=\\\"50000\\\"><a:schemeClr val=\\\"phClr\\\"><a:tint val=\\\"98000\\\"/><a:satMod val=\\\"130000\\\"/><a:shade val=\\\"90000\\\"/><a:lumMod val=\\\"103000\\\"/></a:schemeClr></a:gs><a:gs pos=\\\"100000\\\"><a:schemeClr val=\\\"phClr\\\"><a:shade val=\\\"63000\\\"/><a:satMod val=\\\"120000\\\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\\\"5400000\\\" scaled=\\\"0\\\"/></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/><a:extLst><a:ext uri=\\\"{05A4C25C-085E-4340-85A3-A5531E510DB2}\\\"><thm15:themeFamily xmlns:thm15=\\\"http://schemas.microsoft.com/office/thememl/2012/main\\\" name=\\\"Office Theme\\\" id=\\\"{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}\\\" vid=\\\"{4A3C46E8-61CC-4603-A589-7422A47A8E4A}\\\"/></a:ext></a:extLst></a:theme>\";\r\n}\r\n/**\r\n * Create presentation file (`ppt/presentation.xml`)\r\n * @see https://docs.microsoft.com/en-us/office/open-xml/structure-of-a-presentationml-document\r\n * @see http://www.datypic.com/sc/ooxml/t-p_CT_Presentation.html\r\n * @param {ISlide[]} slides - array of slides\r\n * @param {ILayout} pptLayout - presentation layout\r\n * @param {boolean} rtlMode - RTL mode\r\n * @return {string} XML\r\n */\r\nfunction makeXmlPresentation(slides, pptLayout, rtlMode) {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n        CRLF +\r\n        '<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" ' +\r\n        'xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" ' +\r\n        'xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" ' +\r\n        (rtlMode ? 'rtl=\"1\" ' : '') +\r\n        'saveSubsetFonts=\"1\" autoCompressPictures=\"0\">';\r\n    // IMPORTANT: Steps 1-2-3 must be in this order or PPT will give corruption message on open!\r\n    // STEP 1: Add slide master\r\n    strXml += '<p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst>';\r\n    // STEP 2: Add all Slides\r\n    strXml += '<p:sldIdLst>';\r\n    for (var idx = 0; idx < slides.length; idx++) {\r\n        strXml += '<p:sldId id=\"' + (idx + 256) + '\" r:id=\"rId' + (idx + 2) + '\"/>';\r\n    }\r\n    strXml += '</p:sldIdLst>';\r\n    // STEP 3: Add Notes Master (NOTE: length+2 is from `presentation.xml.rels` func (since we have to match this rId, we just use same logic))\r\n    strXml += '<p:notesMasterIdLst><p:notesMasterId r:id=\"rId' + (slides.length + 2) + '\"/></p:notesMasterIdLst>';\r\n    // STEP 4: Build SLIDE text styles\r\n    strXml +=\r\n        '<p:sldSz cx=\"' +\r\n            pptLayout.width +\r\n            '\" cy=\"' +\r\n            pptLayout.height +\r\n            '\"/>' +\r\n            '<p:notesSz cx=\"' +\r\n            pptLayout.height +\r\n            '\" cy=\"' +\r\n            pptLayout.width +\r\n            '\"/>' +\r\n            '<p:defaultTextStyle>'; //+'<a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>'\r\n    for (var idy = 1; idy < 10; idy++) {\r\n        strXml +=\r\n            '<a:lvl' +\r\n                idy +\r\n                'pPr marL=\"' +\r\n                (idy - 1) * 457200 +\r\n                '\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\">' +\r\n                '<a:defRPr sz=\"1800\" kern=\"1200\">' +\r\n                '<a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill>' +\r\n                '<a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/>' +\r\n                '</a:defRPr>' +\r\n                '</a:lvl' +\r\n                idy +\r\n                'pPr>';\r\n    }\r\n    strXml += '</p:defaultTextStyle>';\r\n    strXml += '</p:presentation>';\r\n    return strXml;\r\n}\r\n/**\r\n * Create `ppt/presProps.xml`\r\n * @return {string} XML\r\n */\r\nfunction makeXmlPresProps() {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF + \"<p:presentationPr xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:p=\\\"http://schemas.openxmlformats.org/presentationml/2006/main\\\"/>\";\r\n}\r\n/**\r\n * Create `ppt/tableStyles.xml`\r\n * @see: http://openxmldeveloper.org/discussions/formats/f/13/p/2398/8107.aspx\r\n * @return {string} XML\r\n */\r\nfunction makeXmlTableStyles() {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF + \"<a:tblStyleLst xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\" def=\\\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\\\"/>\";\r\n}\r\n/**\r\n * Creates `ppt/viewProps.xml`\r\n * @return {string} XML\r\n */\r\nfunction makeXmlViewProps() {\r\n    return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\" + CRLF + \"<p:viewPr xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:p=\\\"http://schemas.openxmlformats.org/presentationml/2006/main\\\"><p:normalViewPr horzBarState=\\\"maximized\\\"><p:restoredLeft sz=\\\"15611\\\"/><p:restoredTop sz=\\\"94610\\\"/></p:normalViewPr><p:slideViewPr><p:cSldViewPr snapToGrid=\\\"0\\\" snapToObjects=\\\"1\\\"><p:cViewPr varScale=\\\"1\\\"><p:scale><a:sx n=\\\"136\\\" d=\\\"100\\\"/><a:sy n=\\\"136\\\" d=\\\"100\\\"/></p:scale><p:origin x=\\\"216\\\" y=\\\"312\\\"/></p:cViewPr><p:guideLst/></p:cSldViewPr></p:slideViewPr><p:notesTextViewPr><p:cViewPr><p:scale><a:sx n=\\\"1\\\" d=\\\"1\\\"/><a:sy n=\\\"1\\\" d=\\\"1\\\"/></p:scale><p:origin x=\\\"0\\\" y=\\\"0\\\"/></p:cViewPr></p:notesTextViewPr><p:gridSpacing cx=\\\"76200\\\" cy=\\\"76200\\\"/></p:viewPr>\";\r\n}\r\n/**\r\n * Checks shadow options passed by user and performs corrections if needed.\r\n * @param {ShadowOptions} IShadowOptions - shadow options\r\n */\r\nfunction correctShadowOptions(ShadowOptions) {\r\n    if (!ShadowOptions || typeof ShadowOptions !== 'object') {\r\n        //console.warn(\"`shadow` options must be an object. Ex: `{shadow: {type:'none'}}`\")\r\n        return;\r\n    }\r\n    // OPT: `type`\r\n    if (ShadowOptions.type !== 'outer' && ShadowOptions.type !== 'inner' && ShadowOptions.type !== 'none') {\r\n        console.warn('Warning: shadow.type options are `outer`, `inner` or `none`.');\r\n        ShadowOptions.type = 'outer';\r\n    }\r\n    // OPT: `angle`\r\n    if (ShadowOptions.angle) {\r\n        // A: REALITY-CHECK\r\n        if (isNaN(Number(ShadowOptions.angle)) || ShadowOptions.angle < 0 || ShadowOptions.angle > 359) {\r\n            console.warn('Warning: shadow.angle can only be 0-359');\r\n            ShadowOptions.angle = 270;\r\n        }\r\n        // B: ROBUST: Cast any type of valid arg to int: '12', 12.3, etc. -> 12\r\n        ShadowOptions.angle = Math.round(Number(ShadowOptions.angle));\r\n    }\r\n    // OPT: `opacity`\r\n    if (ShadowOptions.opacity) {\r\n        // A: REALITY-CHECK\r\n        if (isNaN(Number(ShadowOptions.opacity)) || ShadowOptions.opacity < 0 || ShadowOptions.opacity > 1) {\r\n            console.warn('Warning: shadow.opacity can only be 0-1');\r\n            ShadowOptions.opacity = 0.75;\r\n        }\r\n        // B: ROBUST: Cast any type of valid arg to int: '12', 12.3, etc. -> 12\r\n        ShadowOptions.opacity = Number(ShadowOptions.opacity);\r\n    }\r\n}\r\nfunction getShapeInfo(shapeName) {\r\n    if (!shapeName)\r\n        return PowerPointShapes.RECTANGLE;\r\n    if (typeof shapeName === 'object' && shapeName.name && shapeName.displayName && shapeName.avLst)\r\n        return shapeName;\r\n    if (PowerPointShapes[shapeName])\r\n        return PowerPointShapes[shapeName];\r\n    var objShape = Object.keys(PowerPointShapes).filter(function (key) { return PowerPointShapes[key].name === shapeName || PowerPointShapes[key].displayName; })[0];\r\n    if (typeof objShape !== 'undefined' && objShape !== null)\r\n        return objShape;\r\n    return PowerPointShapes.RECTANGLE;\r\n}\n\n/**\r\n * PptxGenJS: Slide Object Generators\r\n */\r\n/** counter for included charts (used for index in their filenames) */\r\nvar _chartCounter = 0;\r\n/**\r\n * Transforms a slide definition to a slide object that is then passed to the XML transformation process.\r\n * @param {ISlideMasterOptions} slideDef - slide definition\r\n * @param {ISlide|ISlideLayout} target - empty slide object that should be updated by the passed definition\r\n */\r\nfunction createSlideObject(slideDef, target) {\r\n    // STEP 1: Add background\r\n    if (slideDef.bkgd) {\r\n        addBackgroundDefinition(slideDef.bkgd, target);\r\n    }\r\n    // STEP 2: Add all Slide Master objects in the order they were given (Issue#53)\r\n    if (slideDef.objects && Array.isArray(slideDef.objects) && slideDef.objects.length > 0) {\r\n        slideDef.objects.forEach(function (object, idx) {\r\n            var key = Object.keys(object)[0];\r\n            var tgt = target;\r\n            if (MASTER_OBJECTS[key] && key === 'chart')\r\n                addChartDefinition(tgt, object[key].type, object[key].data, object[key].opts);\r\n            else if (MASTER_OBJECTS[key] && key === 'image')\r\n                addImageDefinition(tgt, object[key]);\r\n            else if (MASTER_OBJECTS[key] && key === 'line')\r\n                addShapeDefinition(tgt, BASE_SHAPES.LINE, object[key]);\r\n            else if (MASTER_OBJECTS[key] && key === 'rect')\r\n                addShapeDefinition(tgt, BASE_SHAPES.RECTANGLE, object[key]);\r\n            else if (MASTER_OBJECTS[key] && key === 'text')\r\n                addTextDefinition(tgt, object[key].text, object[key].options, false);\r\n            else if (MASTER_OBJECTS[key] && key === 'placeholder') {\r\n                // TODO: 20180820: Check for existing `name`?\r\n                object[key].options.placeholder = object[key].options.name;\r\n                delete object[key].options.name; // remap name for earier handling internally\r\n                object[key].options.placeholderType = object[key].options.type;\r\n                delete object[key].options.type; // remap name for earier handling internally\r\n                object[key].options.placeholderIdx = 100 + idx;\r\n                addPlaceholderDefinition(tgt, object[key].text, object[key].options);\r\n            }\r\n        });\r\n    }\r\n    // STEP 3: Add Slide Numbers (NOTE: Do this last so numbers are not covered by objects!)\r\n    if (slideDef.slideNumber && typeof slideDef.slideNumber === 'object') {\r\n        target.slideNumberObj = slideDef.slideNumber;\r\n    }\r\n}\r\n/**\r\n * Generate the chart based on input data.\r\n * OOXML Chart Spec: ISO/IEC 29500-1:2016(E)\r\n *\r\n * @param {CHART_TYPE_NAMES | IChartMulti[]} `type` should belong to: 'column', 'pie'\r\n * @param {[]} `data` a JSON object with follow the following format\r\n * @param {IChartOpts} `opt` chart options\r\n * @param {ISlide} `target` slide object that the chart will be added to\r\n * @return {object} chart object\r\n * {\r\n *   title: 'eSurvey chart',\r\n *   data: [\r\n *\t\t{\r\n *\t\t\tname: 'Income',\r\n *\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n *\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n *\t\t},\r\n *\t\t{\r\n *\t\t\tname: 'Expense',\r\n *\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n *\t\t\tvalues: [18.1, 22.8, 23.9, 25.1, 25]\r\n *\t\t}\r\n *\t ]\r\n *\t}\r\n */\r\nfunction addChartDefinition(target, type, data, opt) {\r\n    function correctGridLineOptions(glOpts) {\r\n        if (!glOpts || glOpts.style === 'none')\r\n            return;\r\n        if (glOpts.size !== undefined && (isNaN(Number(glOpts.size)) || glOpts.size <= 0)) {\r\n            console.warn('Warning: chart.gridLine.size must be greater than 0.');\r\n            delete glOpts.size; // delete prop to used defaults\r\n        }\r\n        if (glOpts.style && ['solid', 'dash', 'dot'].indexOf(glOpts.style) < 0) {\r\n            console.warn('Warning: chart.gridLine.style options: `solid`, `dash`, `dot`.');\r\n            delete glOpts.style;\r\n        }\r\n    }\r\n    var chartId = ++_chartCounter;\r\n    var resultObject = {\r\n        type: null,\r\n        text: null,\r\n        options: null,\r\n        chartRid: null,\r\n    };\r\n    // DESIGN: `type` can an object (ex: `pptx.charts.DOUGHNUT`) or an array of chart objects\r\n    // EX: addChartDefinition([ { type:pptx.charts.BAR, data:{name:'', labels:[], values[]} }, {<etc>} ])\r\n    // Multi-Type Charts\r\n    var tmpOpt;\r\n    var tmpData = [], options;\r\n    if (Array.isArray(type)) {\r\n        // For multi-type charts there needs to be data for each type,\r\n        // as well as a single data source for non-series operations.\r\n        // The data is indexed below to keep the data in order when segmented\r\n        // into types.\r\n        type.forEach(function (obj) {\r\n            tmpData = tmpData.concat(obj.data);\r\n        });\r\n        tmpOpt = data || opt;\r\n    }\r\n    else {\r\n        tmpData = data;\r\n        tmpOpt = opt;\r\n    }\r\n    tmpData.forEach(function (item, i) {\r\n        item.index = i;\r\n    });\r\n    options = tmpOpt && typeof tmpOpt === 'object' ? tmpOpt : {};\r\n    // STEP 1: TODO: check for reqd fields, correct type, etc\r\n    // `type` exists in CHART_TYPES\r\n    // Array.isArray(data)\r\n    /*\r\n        if ( Array.isArray(rel.data) && rel.data.length > 0 && typeof rel.data[0] === 'object'\r\n            && rel.data[0].labels && Array.isArray(rel.data[0].labels)\r\n            && rel.data[0].values && Array.isArray(rel.data[0].values) ) {\r\n            obj = rel.data[0];\r\n        }\r\n        else {\r\n            console.warn(\"USAGE: addChart( 'pie', [ {name:'Sales', labels:['Jan','Feb'], values:[10,20]} ], {x:1, y:1} )\");\r\n            return;\r\n        }\r\n        */\r\n    // STEP 2: Set default options/decode user options\r\n    // A: Core\r\n    options.type = type;\r\n    options.x = typeof options.x !== 'undefined' && options.x != null && !isNaN(Number(options.x)) ? options.x : 1;\r\n    options.y = typeof options.y !== 'undefined' && options.y != null && !isNaN(Number(options.y)) ? options.y : 1;\r\n    options.w = options.w || '50%';\r\n    options.h = options.h || '50%';\r\n    // B: Options: misc\r\n    if (['bar', 'col'].indexOf(options.barDir || '') < 0)\r\n        options.barDir = 'col';\r\n    // IMPORTANT: 'bestFit' will cause issues with PPT-Online in some cases, so defualt to 'ctr'!\r\n    if (['bestFit', 'b', 'ctr', 'inBase', 'inEnd', 'l', 'outEnd', 'r', 't'].indexOf(options.dataLabelPosition || '') < 0)\r\n        options.dataLabelPosition = options.type === CHART_TYPES.PIE || options.type === CHART_TYPES.DOUGHNUT ? 'bestFit' : 'ctr';\r\n    options.dataLabelBkgrdColors = options.dataLabelBkgrdColors === true || options.dataLabelBkgrdColors === false ? options.dataLabelBkgrdColors : false;\r\n    if (['b', 'l', 'r', 't', 'tr'].indexOf(options.legendPos || '') < 0)\r\n        options.legendPos = 'r';\r\n    // barGrouping: \"21.2.3.17 ST_Grouping (Grouping)\"\r\n    if (['clustered', 'standard', 'stacked', 'percentStacked'].indexOf(options.barGrouping || '') < 0)\r\n        options.barGrouping = 'standard';\r\n    if (options.barGrouping.indexOf('tacked') > -1) {\r\n        options.dataLabelPosition = 'ctr'; // IMPORTANT: PPT-Online will not open Presentation when 'outEnd' etc is used on stacked!\r\n        if (!options.barGapWidthPct)\r\n            options.barGapWidthPct = 50;\r\n    }\r\n    // 3D bar: ST_Shape\r\n    if (['cone', 'coneToMax', 'box', 'cylinder', 'pyramid', 'pyramidToMax'].indexOf(options.bar3DShape || '') < 0)\r\n        options.bar3DShape = 'box';\r\n    // lineDataSymbol: http://www.datypic.com/sc/ooxml/a-val-32.html\r\n    // Spec has [plus,star,x] however neither PPT2013 nor PPT-Online support them\r\n    if (['circle', 'dash', 'diamond', 'dot', 'none', 'square', 'triangle'].indexOf(options.lineDataSymbol || '') < 0)\r\n        options.lineDataSymbol = 'circle';\r\n    if (['gap', 'span'].indexOf(options.displayBlanksAs || '') < 0)\r\n        options.displayBlanksAs = 'span';\r\n    if (['standard', 'marker', 'filled'].indexOf(options.radarStyle || '') < 0)\r\n        options.radarStyle = 'standard';\r\n    options.lineDataSymbolSize = options.lineDataSymbolSize && !isNaN(options.lineDataSymbolSize) ? options.lineDataSymbolSize : 6;\r\n    options.lineDataSymbolLineSize = options.lineDataSymbolLineSize && !isNaN(options.lineDataSymbolLineSize) ? options.lineDataSymbolLineSize * ONEPT : 0.75 * ONEPT;\r\n    // `layout` allows the override of PPT defaults to maximize space\r\n    if (options.layout) {\r\n        ['x', 'y', 'w', 'h'].forEach(function (key) {\r\n            var val = options.layout[key];\r\n            if (isNaN(Number(val)) || val < 0 || val > 1) {\r\n                console.warn('Warning: chart.layout.' + key + ' can only be 0-1');\r\n                delete options.layout[key]; // remove invalid value so that default will be used\r\n            }\r\n        });\r\n    }\r\n    // Set gridline defaults\r\n    options.catGridLine = options.catGridLine || (options.type === CHART_TYPES.SCATTER ? { color: 'D9D9D9', size: 1 } : { style: 'none' });\r\n    options.valGridLine = options.valGridLine || (options.type === CHART_TYPES.SCATTER ? { color: 'D9D9D9', size: 1 } : {});\r\n    options.serGridLine = options.serGridLine || (options.type === CHART_TYPES.SCATTER ? { color: 'D9D9D9', size: 1 } : { style: 'none' });\r\n    correctGridLineOptions(options.catGridLine);\r\n    correctGridLineOptions(options.valGridLine);\r\n    correctGridLineOptions(options.serGridLine);\r\n    correctShadowOptions(options.shadow);\r\n    // C: Options: plotArea\r\n    options.showDataTable = options.showDataTable === true || options.showDataTable === false ? options.showDataTable : false;\r\n    options.showDataTableHorzBorder = options.showDataTableHorzBorder === true || options.showDataTableHorzBorder === false ? options.showDataTableHorzBorder : true;\r\n    options.showDataTableVertBorder = options.showDataTableVertBorder === true || options.showDataTableVertBorder === false ? options.showDataTableVertBorder : true;\r\n    options.showDataTableOutline = options.showDataTableOutline === true || options.showDataTableOutline === false ? options.showDataTableOutline : true;\r\n    options.showDataTableKeys = options.showDataTableKeys === true || options.showDataTableKeys === false ? options.showDataTableKeys : true;\r\n    options.showLabel = options.showLabel === true || options.showLabel === false ? options.showLabel : false;\r\n    options.showLegend = options.showLegend === true || options.showLegend === false ? options.showLegend : false;\r\n    options.showPercent = options.showPercent === true || options.showPercent === false ? options.showPercent : true;\r\n    options.showTitle = options.showTitle === true || options.showTitle === false ? options.showTitle : false;\r\n    options.showValue = options.showValue === true || options.showValue === false ? options.showValue : false;\r\n    options.catAxisLineShow = typeof options.catAxisLineShow !== 'undefined' ? options.catAxisLineShow : true;\r\n    options.valAxisLineShow = typeof options.valAxisLineShow !== 'undefined' ? options.valAxisLineShow : true;\r\n    options.serAxisLineShow = typeof options.serAxisLineShow !== 'undefined' ? options.serAxisLineShow : true;\r\n    options.v3DRotX = !isNaN(options.v3DRotX) && options.v3DRotX >= -90 && options.v3DRotX <= 90 ? options.v3DRotX : 30;\r\n    options.v3DRotY = !isNaN(options.v3DRotY) && options.v3DRotY >= 0 && options.v3DRotY <= 360 ? options.v3DRotY : 30;\r\n    options.v3DRAngAx = options.v3DRAngAx === true || options.v3DRAngAx === false ? options.v3DRAngAx : true;\r\n    options.v3DPerspective = !isNaN(options.v3DPerspective) && options.v3DPerspective >= 0 && options.v3DPerspective <= 240 ? options.v3DPerspective : 30;\r\n    // D: Options: chart\r\n    options.barGapWidthPct = !isNaN(options.barGapWidthPct) && options.barGapWidthPct >= 0 && options.barGapWidthPct <= 1000 ? options.barGapWidthPct : 150;\r\n    options.barGapDepthPct = !isNaN(options.barGapDepthPct) && options.barGapDepthPct >= 0 && options.barGapDepthPct <= 1000 ? options.barGapDepthPct : 150;\r\n    options.chartColors = Array.isArray(options.chartColors)\r\n        ? options.chartColors\r\n        : options.type === CHART_TYPES.PIE || options.type === CHART_TYPES.DOUGHNUT\r\n            ? PIECHART_COLORS\r\n            : BARCHART_COLORS;\r\n    options.chartColorsOpacity = options.chartColorsOpacity && !isNaN(options.chartColorsOpacity) ? options.chartColorsOpacity : null;\r\n    //\r\n    options.border = options.border && typeof options.border === 'object' ? options.border : null;\r\n    if (options.border && (!options.border.pt || isNaN(options.border.pt)))\r\n        options.border.pt = 1;\r\n    if (options.border && (!options.border.color || typeof options.border.color !== 'string' || options.border.color.length !== 6))\r\n        options.border.color = '363636';\r\n    //\r\n    options.dataBorder = options.dataBorder && typeof options.dataBorder === 'object' ? options.dataBorder : null;\r\n    if (options.dataBorder && (!options.dataBorder.pt || isNaN(options.dataBorder.pt)))\r\n        options.dataBorder.pt = 0.75;\r\n    if (options.dataBorder && (!options.dataBorder.color || typeof options.dataBorder.color !== 'string' || options.dataBorder.color.length !== 6))\r\n        options.dataBorder.color = 'F9F9F9';\r\n    //\r\n    if (!options.dataLabelFormatCode && options.type === CHART_TYPES.SCATTER)\r\n        options.dataLabelFormatCode = 'General';\r\n    options.dataLabelFormatCode =\r\n        options.dataLabelFormatCode && typeof options.dataLabelFormatCode === 'string'\r\n            ? options.dataLabelFormatCode\r\n            : options.type === CHART_TYPES.PIE || options.type === CHART_TYPES.DOUGHNUT\r\n                ? '0%'\r\n                : '#,##0';\r\n    //\r\n    // Set default format for Scatter chart labels to custom string if not defined\r\n    if (!options.dataLabelFormatScatter && options.type === CHART_TYPES.SCATTER)\r\n        options.dataLabelFormatScatter = 'custom';\r\n    //\r\n    options.lineSize = typeof options.lineSize === 'number' ? options.lineSize : 2;\r\n    options.valAxisMajorUnit = typeof options.valAxisMajorUnit === 'number' ? options.valAxisMajorUnit : null;\r\n    options.valAxisCrossesAt = options.valAxisCrossesAt || 'autoZero';\r\n    // STEP 4: Set props\r\n    resultObject.type = 'chart';\r\n    resultObject.options = options;\r\n    resultObject.chartRid = target.relsChart.length + 1;\r\n    // STEP 5: Add this chart to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\r\n    target.relsChart.push({\r\n        rId: target.relsChart.length + 1,\r\n        data: tmpData,\r\n        opts: options,\r\n        type: options.type,\r\n        globalId: chartId,\r\n        fileName: 'chart' + chartId + '.xml',\r\n        Target: '/ppt/charts/chart' + chartId + '.xml',\r\n    });\r\n    target.data.push(resultObject);\r\n    return resultObject;\r\n}\r\n/**\r\n * Adds an image object to a slide definition.\r\n * This method can be called with only two args (opt, target) - this is supposed to be the only way in future.\r\n * @param {IImageOpts} `opt` - object containing `path`/`data`, `x`, `y`, etc.\r\n * @param {ISlide} `target` - slide that the image should be added to (if not specified as the 2nd arg)\r\n */\r\nfunction addImageDefinition(target, opt) {\r\n    var newObject = {\r\n        type: null,\r\n        text: null,\r\n        options: null,\r\n        image: null,\r\n        imageRid: null,\r\n        hyperlink: null,\r\n    };\r\n    // FIRST: Set vars for this image (object param replaces positional args in 1.1.0)\r\n    var intPosX = opt.x || 0;\r\n    var intPosY = opt.y || 0;\r\n    var intWidth = opt.w || 0;\r\n    var intHeight = opt.h || 0;\r\n    var sizing = opt.sizing || null;\r\n    var objHyperlink = opt.hyperlink || '';\r\n    var strImageData = opt.data || '';\r\n    var strImagePath = opt.path || '';\r\n    var imageRelId = target.rels.length + target.relsChart.length + target.relsMedia.length + 1;\r\n    // REALITY-CHECK:\r\n    if (!strImagePath && !strImageData) {\r\n        console.error(\"ERROR: `addImage()` requires either 'data' or 'path' parameter!\");\r\n        return null;\r\n    }\r\n    else if (strImageData && strImageData.toLowerCase().indexOf('base64,') === -1) {\r\n        console.error(\"ERROR: Image `data` value lacks a base64 header! Ex: 'image/png;base64,NMP[...]')\");\r\n        return null;\r\n    }\r\n    // STEP 1: Set extension\r\n    // NOTE: Split to address URLs with params (eg: `path/brent.jpg?someParam=true`)\r\n    var strImgExtn = strImagePath\r\n        .substring(strImagePath.lastIndexOf('/') + 1)\r\n        .split('?')[0]\r\n        .split('.')\r\n        .pop()\r\n        .split('#')[0] || 'png';\r\n    // However, pre-encoded images can be whatever mime-type they want (and good for them!)\r\n    if (strImageData && /image\\/(\\w+);/.exec(strImageData) && /image\\/(\\w+);/.exec(strImageData).length > 0) {\r\n        strImgExtn = /image\\/(\\w+);/.exec(strImageData)[1];\r\n    }\r\n    else if (strImageData && strImageData.toLowerCase().indexOf('image/svg+xml') > -1) {\r\n        strImgExtn = 'svg';\r\n    }\r\n    // STEP 2: Set type/path\r\n    newObject.type = 'image';\r\n    newObject.image = strImagePath || 'preencoded.png';\r\n    // STEP 3: Set image properties & options\r\n    // FIXME: Measure actual image when no intWidth/intHeight params passed\r\n    // ....: This is an async process: we need to make getSizeFromImage use callback, then set H/W...\r\n    // if ( !intWidth || !intHeight ) { var imgObj = getSizeFromImage(strImagePath);\r\n    newObject.options = {\r\n        x: intPosX || 0,\r\n        y: intPosY || 0,\r\n        w: intWidth || 1,\r\n        h: intHeight || 1,\r\n        rounding: typeof opt.rounding === 'boolean' ? opt.rounding : false,\r\n        sizing: sizing,\r\n        placeholder: opt.placeholder,\r\n    };\r\n    // STEP 4: Add this image to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\r\n    if (strImgExtn === 'svg') {\r\n        // SVG files consume *TWO* rId's: (a png version and the svg image)\r\n        // <Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"../media/image1.png\"/>\r\n        // <Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"../media/image2.svg\"/>\r\n        target.relsMedia.push({\r\n            path: strImagePath || strImageData + 'png',\r\n            type: 'image/png',\r\n            extn: 'png',\r\n            data: strImageData || '',\r\n            rId: imageRelId,\r\n            Target: '../media/image-' + target.number + '-' + (target.relsMedia.length + 1) + '.png',\r\n            isSvgPng: true,\r\n            svgSize: { w: newObject.options.w, h: newObject.options.h },\r\n        });\r\n        newObject.imageRid = imageRelId;\r\n        target.relsMedia.push({\r\n            path: strImagePath || strImageData,\r\n            type: 'image/svg+xml',\r\n            extn: strImgExtn,\r\n            data: strImageData || '',\r\n            rId: imageRelId + 1,\r\n            Target: '../media/image-' + target.number + '-' + (target.relsMedia.length + 1) + '.' + strImgExtn,\r\n        });\r\n        newObject.imageRid = imageRelId + 1;\r\n    }\r\n    else {\r\n        target.relsMedia.push({\r\n            path: strImagePath || 'preencoded.' + strImgExtn,\r\n            type: 'image/' + strImgExtn,\r\n            extn: strImgExtn,\r\n            data: strImageData || '',\r\n            rId: imageRelId,\r\n            Target: '../media/image-' + target.number + '-' + (target.relsMedia.length + 1) + '.' + strImgExtn,\r\n        });\r\n        newObject.imageRid = imageRelId;\r\n    }\r\n    // STEP 5: Hyperlink support\r\n    if (typeof objHyperlink === 'object') {\r\n        if (!objHyperlink.url && !objHyperlink.slide)\r\n            throw new Error('ERROR: `hyperlink` option requires either: `url` or `slide`');\r\n        else {\r\n            imageRelId++;\r\n            target.rels.push({\r\n                type: SLIDE_OBJECT_TYPES.hyperlink,\r\n                data: objHyperlink.slide ? 'slide' : 'dummy',\r\n                rId: imageRelId,\r\n                Target: objHyperlink.url || objHyperlink.slide.toString(),\r\n            });\r\n            objHyperlink.rId = imageRelId;\r\n            newObject.hyperlink = objHyperlink;\r\n        }\r\n    }\r\n    // STEP 6: Add object to slide\r\n    target.data.push(newObject);\r\n}\r\n/**\r\n * Adds a media object to a slide definition.\r\n * @param {ISlide} `target` - slide object that the text will be added to\r\n * @param {IMediaOpts} `opt` - media options\r\n */\r\nfunction addMediaDefinition(target, opt) {\r\n    var intRels = target.relsMedia.length + 1;\r\n    var intPosX = opt.x || 0;\r\n    var intPosY = opt.y || 0;\r\n    var intSizeX = opt.w || 2;\r\n    var intSizeY = opt.h || 2;\r\n    var strData = opt.data || '';\r\n    var strLink = opt.link || '';\r\n    var strPath = opt.path || '';\r\n    var strType = opt.type || 'audio';\r\n    var strExtn = 'mp3';\r\n    var slideData = {\r\n        type: SLIDE_OBJECT_TYPES.media,\r\n    };\r\n    // STEP 1: REALITY-CHECK\r\n    if (!strPath && !strData && strType !== 'online') {\r\n        throw new Error(\"addMedia() error: either 'data' or 'path' are required!\");\r\n    }\r\n    else if (strData && strData.toLowerCase().indexOf('base64,') === -1) {\r\n        throw new Error(\"addMedia() error: `data` value lacks a base64 header! Ex: 'video/mpeg;base64,NMP[...]')\");\r\n    }\r\n    // Online Video: requires `link`\r\n    if (strType === 'online' && !strLink) {\r\n        throw new Error('addMedia() error: online videos require `link` value');\r\n    }\r\n    // FIXME: 20190707\r\n    //strType = strData ? strData.split(';')[0].split('/')[0] : strType\r\n    strExtn = strData ? strData.split(';')[0].split('/')[1] : strPath.split('.').pop();\r\n    // STEP 2: Set type, media\r\n    slideData.mtype = strType;\r\n    slideData.media = strPath || 'preencoded.mov';\r\n    slideData.options = {};\r\n    // STEP 3: Set media properties & options\r\n    slideData.options.x = intPosX;\r\n    slideData.options.y = intPosY;\r\n    slideData.options.w = intSizeX;\r\n    slideData.options.h = intSizeY;\r\n    // STEP 4: Add this media to this Slide Rels (rId/rels count spans all slides! Count all media to get next rId)\r\n    // NOTE: rId starts at 2 (hence the intRels+1 below) as slideLayout.xml is rId=1!\r\n    if (strType === 'online') {\r\n        // A: Add video\r\n        target.relsMedia.push({\r\n            path: strPath || 'preencoded' + strExtn,\r\n            data: 'dummy',\r\n            type: 'online',\r\n            extn: strExtn,\r\n            rId: intRels + 1,\r\n            Target: strLink,\r\n        });\r\n        slideData.mediaRid = target.relsMedia[target.relsMedia.length - 1].rId;\r\n        // B: Add preview/overlay image\r\n        target.relsMedia.push({\r\n            path: 'preencoded.png',\r\n            data: IMG_PLAYBTN,\r\n            type: 'image/png',\r\n            extn: 'png',\r\n            rId: intRels + 2,\r\n            Target: '../media/image-' + target.number + '-' + (target.relsMedia.length + 1) + '.png',\r\n        });\r\n    }\r\n    else {\r\n        /* NOTE: Audio/Video files consume *TWO* rId's:\r\n         * <Relationship Id=\"rId2\" Target=\"../media/media1.mov\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>\r\n         * <Relationship Id=\"rId3\" Target=\"../media/media1.mov\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\"/>\r\n         */\r\n        // A: \"relationships/video\"\r\n        target.relsMedia.push({\r\n            path: strPath || 'preencoded' + strExtn,\r\n            type: strType + '/' + strExtn,\r\n            extn: strExtn,\r\n            data: strData || '',\r\n            rId: intRels + 0,\r\n            Target: '../media/media-' + target.number + '-' + (target.relsMedia.length + 1) + '.' + strExtn,\r\n        });\r\n        slideData.mediaRid = target.relsMedia[target.relsMedia.length - 1].rId;\r\n        // B: \"relationships/media\"\r\n        target.relsMedia.push({\r\n            path: strPath || 'preencoded' + strExtn,\r\n            type: strType + '/' + strExtn,\r\n            extn: strExtn,\r\n            data: strData || '',\r\n            rId: intRels + 1,\r\n            Target: '../media/media-' + target.number + '-' + (target.relsMedia.length + 0) + '.' + strExtn,\r\n        });\r\n        // C: Add preview/overlay image\r\n        target.relsMedia.push({\r\n            data: IMG_PLAYBTN,\r\n            path: 'preencoded.png',\r\n            type: 'image/png',\r\n            extn: 'png',\r\n            rId: intRels + 2,\r\n            Target: '../media/image-' + target.number + '-' + (target.relsMedia.length + 1) + '.png',\r\n        });\r\n    }\r\n    // LAST\r\n    target.data.push(slideData);\r\n}\r\n/**\r\n * Adds Notes to a slide.\r\n * @param {String} `notes`\r\n * @param {Object} opt (*unused*)\r\n * @param {ISlide} `target` slide object\r\n * @since 2.3.0\r\n */\r\nfunction addNotesDefinition(target, notes) {\r\n    target.data.push({\r\n        type: SLIDE_OBJECT_TYPES.notes,\r\n        text: notes,\r\n    });\r\n}\r\n/**\r\n * Adds a placeholder object to a slide definition.\r\n * @param {String} `text`\r\n * @param {Object} `opt`\r\n * @param {ISlide} `target` slide object that the placeholder should be added to\r\n */\r\nfunction addPlaceholderDefinition(target, text, opt) {\r\n    // FIXME: there are several tpyes - not all placeholders are text!\r\n    // but it seems to work (see below) - INVESTIGATE: how it s/b written\r\n    return addTextDefinition(target, text, opt, true);\r\n    /*\r\n    this works, albeit not for masters, - it UNDOCUMENTED (oops) and why is type=body (s/b image?), or if we do use body as the locale (like title), than whats 'image' for?\r\n    slide4.addImage({ placeholder:'body', path:(NODEJS ? gPaths.ccLogo.path.replace(/http.+\\/examples/, '../common') : gPaths.ccLogo.path) });\r\n\n    // TODO: TODO-3: this has never worked\r\n    // https://github.com/gitbrent/PptxGenJS/issues/599\r\n    if (opt.type === PLACEHOLDER_TYPES.title || opt.type === PLACEHOLDER_TYPES.body) return addTextDefinition(target, text, opt, true)\r\n    else if (opt.type === PLACEHOLDER_TYPES.image ) return addImageDefinition(target, opt)\r\n    */\r\n}\r\n/**\r\n * Adds a shape object to a slide definition.\r\n * @param {IShape} shape shape const object (pptx.shapes)\r\n * @param {IShapeOptions} opt\r\n * @param {ISlide} target slide object that the shape should be added to\r\n */\r\nfunction addShapeDefinition(target, shape, opt) {\r\n    var options = typeof opt === 'object' ? opt : {};\r\n    var newObject = {\r\n        type: SLIDE_OBJECT_TYPES.text,\r\n        shape: shape,\r\n        options: options,\r\n        text: null,\r\n    };\r\n    // 1: Reality check\r\n    if (!shape || typeof shape !== 'object')\r\n        throw new Error('Missing/Invalid shape parameter! Example: `addShape(pptx.shapes.LINE, {x:1, y:1, w:1, h:1});`');\r\n    // 2: Set options defaults\r\n    options.x = options.x || (options.x === 0 ? 0 : 1);\r\n    options.y = options.y || (options.y === 0 ? 0 : 1);\r\n    options.w = options.w || (options.w === 0 ? 0 : 1);\r\n    options.h = options.h || (options.h === 0 ? 0 : 1);\r\n    options.line = options.line || (shape.name === 'line' ? '333333' : null);\r\n    options.lineSize = options.lineSize || (shape.name === 'line' ? 1 : null);\r\n    if (['dash', 'dashDot', 'lgDash', 'lgDashDot', 'lgDashDotDot', 'solid', 'sysDash', 'sysDot'].indexOf(options.lineDash || '') < 0)\r\n        options.lineDash = 'solid';\r\n    // 3: Add object to slide\r\n    target.data.push(newObject);\r\n}\r\n/**\r\n * Adds a table object to a slide definition.\r\n * @param {ISlide} target - slide object that the table should be added to\r\n * @param {TableRow[]} arrTabRows - table data\r\n * @param {ITableOptions} inOpt - table options\r\n * @param {ISlideLayout} slideLayout - Slide layout\r\n * @param {ILayout} presLayout - Presenation layout\r\n * @param {Function} addSlide - method\r\n * @param {Function} getSlide - method\r\n */\r\nfunction addTableDefinition(target, tableRows, options, slideLayout, presLayout, addSlide, getSlide) {\r\n    var opt = options && typeof options === 'object' ? options : {};\r\n    var slides = [target]; // Create array of Slides as more may be added by auto-paging\r\n    // STEP 1: REALITY-CHECK\r\n    {\r\n        // A: check for empty\r\n        if (tableRows === null || tableRows.length === 0 || !Array.isArray(tableRows)) {\r\n            throw new Error(\"addTable: Array expected! EX: 'slide.addTable( [rows], {options} );' (https://gitbrent.github.io/PptxGenJS/docs/api-tables.html)\");\r\n        }\r\n        // B: check for non-well-formatted array (ex: rows=['a','b'] instead of [['a','b']])\r\n        if (!tableRows[0] || !Array.isArray(tableRows[0])) {\r\n            throw new Error(\"addTable: 'rows' should be an array of cells! EX: 'slide.addTable( [ ['A'], ['B'], {text:'C',options:{align:'center'}} ] );' (https://gitbrent.github.io/PptxGenJS/docs/api-tables.html)\");\r\n        }\r\n        // TODO: FUTURE: This is wacky and wont function right (shows .w value when there is none from demo.js?!) 20191219\r\n        /*\r\n        if (opt.w && opt.colW) {\r\n            console.warn('addTable: please use either `colW` or `w` - not both (table will use `colW` and ignore `w`)')\r\n            console.log(`${opt.w} ${opt.colW}`)\r\n        }\r\n        */\r\n    }\r\n    // STEP 2: Transform `tableRows` into well-formatted ITableCell's\r\n    // tableRows can be object or plain text array: `[{text:'cell 1'}, {text:'cell 2', options:{color:'ff0000'}}]` | `[\"cell 1\", \"cell 2\"]`\r\n    var arrRows = [];\r\n    tableRows.forEach(function (row) {\r\n        var newRow = [];\r\n        if (Array.isArray(row)) {\r\n            row.forEach(function (cell) {\r\n                var newCell = {\r\n                    type: SLIDE_OBJECT_TYPES.tablecell,\r\n                    text: '',\r\n                    options: typeof cell === 'object' ? cell.options : null,\r\n                };\r\n                if (typeof cell === 'string' || typeof cell === 'number')\r\n                    newCell.text = cell.toString();\r\n                else if (cell.text) {\r\n                    // Cell can contain complex text type, or string, or number\r\n                    if (typeof cell.text === 'string' || typeof cell.text === 'number')\r\n                        newCell.text = cell.text.toString();\r\n                    else if (cell.text)\r\n                        newCell.text = cell.text;\r\n                    // Capture options\r\n                    if (cell.options)\r\n                        newCell.options = cell.options;\r\n                }\r\n                newRow.push(newCell);\r\n            });\r\n        }\r\n        else {\r\n            console.log('addTable: tableRows has a bad row. A row should be an array of cells. You provided:');\r\n            console.log(row);\r\n        }\r\n        arrRows.push(newRow);\r\n    });\r\n    // STEP 3: Set options\r\n    opt.x = getSmartParseNumber(opt.x || (opt.x === 0 ? 0 : EMU / 2), 'X', presLayout);\r\n    opt.y = getSmartParseNumber(opt.y || (opt.y === 0 ? 0 : EMU / 2), 'Y', presLayout);\r\n    if (opt.h)\r\n        opt.h = getSmartParseNumber(opt.h, 'Y', presLayout); // NOTE: Dont set default `h` - leaving it null triggers auto-rowH in `makeXMLSlide()`\r\n    opt.autoPage = typeof opt.autoPage === 'boolean' ? opt.autoPage : false;\r\n    opt.fontSize = opt.fontSize || DEF_FONT_SIZE;\r\n    opt.autoPageLineWeight = typeof opt.autoPageLineWeight !== 'undefined' && !isNaN(Number(opt.autoPageLineWeight)) ? Number(opt.autoPageLineWeight) : 0;\r\n    opt.margin = opt.margin === 0 || opt.margin ? opt.margin : DEF_CELL_MARGIN_PT;\r\n    if (typeof opt.margin === 'number')\r\n        opt.margin = [Number(opt.margin), Number(opt.margin), Number(opt.margin), Number(opt.margin)];\r\n    if (opt.autoPageLineWeight > 1)\r\n        opt.autoPageLineWeight = 1;\r\n    else if (opt.autoPageLineWeight < -1)\r\n        opt.autoPageLineWeight = -1;\r\n    // Set default color if needed (table option > inherit from Slide > default to black)\r\n    if (!opt.color)\r\n        opt.color = opt.color || DEF_FONT_COLOR;\r\n    if (typeof opt.border === 'string') {\r\n        console.warn(\"addTable `border` option must be an object. Ex: `{border: {type:'none'}}`\");\r\n        opt.border = null;\r\n    }\r\n    // Set/Calc table width\r\n    // Get slide margins - start with default values, then adjust if master or slide margins exist\r\n    var arrTableMargin = DEF_SLIDE_MARGIN_IN;\r\n    // Case 1: Master margins\r\n    if (slideLayout && typeof slideLayout.margin !== 'undefined') {\r\n        if (Array.isArray(slideLayout.margin))\r\n            arrTableMargin = slideLayout.margin;\r\n        else if (!isNaN(Number(slideLayout.margin)))\r\n            arrTableMargin = [Number(slideLayout.margin), Number(slideLayout.margin), Number(slideLayout.margin), Number(slideLayout.margin)];\r\n    }\r\n    // Case 2: Table margins\r\n    /* FIXME: add `margin` option to slide options\r\n        else if ( addNewSlide.margin ) {\r\n            if ( Array.isArray(addNewSlide.margin) ) arrTableMargin = addNewSlide.margin;\r\n            else if ( !isNaN(Number(addNewSlide.margin)) ) arrTableMargin = [Number(addNewSlide.margin), Number(addNewSlide.margin), Number(addNewSlide.margin), Number(addNewSlide.margin)];\r\n        }\r\n    */\r\n    // Calc table width depending upon what data we have - several scenarios exist (including bad data, eg: colW doesnt match col count)\r\n    if (opt.colW) {\r\n        var firstRowColCnt = arrRows[0].length;\r\n        // Ex: `colW = 3` or `colW = '3'`\r\n        if (typeof opt.colW === 'string' || typeof opt.colW === 'number') {\r\n            opt.w = Math.floor(Number(opt.colW) * firstRowColCnt);\r\n            opt.colW = null; // IMPORTANT: Unset `colW` so table is created using `opt.w`, which will evenly divide cols\r\n        }\r\n        // Ex: `colW=[3]` but with >1 cols (same as above, user is saying \"use this width for all\")\r\n        else if (opt.colW && Array.isArray(opt.colW) && opt.colW.length === 1 && firstRowColCnt > 1) {\r\n            opt.w = Math.floor(Number(opt.colW) * firstRowColCnt);\r\n            opt.colW = null; // IMPORTANT: Unset `colW` so table is created using `opt.w`, which will evenly divide cols\r\n        }\r\n        // Err: Mismatched colW and cols count\r\n        else if (opt.colW && Array.isArray(opt.colW) && opt.colW.length !== firstRowColCnt) {\r\n            console.warn('addTable: mismatch: (colW.length != data.length) Therefore, defaulting to evenly distributed col widths.');\r\n            opt.colW = null;\r\n        }\r\n    }\r\n    else if (opt.w) {\r\n        opt.w = getSmartParseNumber(opt.w, 'X', presLayout);\r\n    }\r\n    else {\r\n        opt.w = Math.floor(presLayout.width / EMU - arrTableMargin[1] - arrTableMargin[3]);\r\n    }\r\n    // STEP 4: Convert units to EMU now (we use different logic in makeSlide->table - smartCalc is not used)\r\n    if (opt.x && opt.x < 20)\r\n        opt.x = inch2Emu(opt.x);\r\n    if (opt.y && opt.y < 20)\r\n        opt.y = inch2Emu(opt.y);\r\n    if (opt.w && opt.w < 20)\r\n        opt.w = inch2Emu(opt.w);\r\n    if (opt.h && opt.h < 20)\r\n        opt.h = inch2Emu(opt.h);\r\n    // STEP 5: Loop over cells: transform each to ITableCell; check to see whether to skip autopaging while here\r\n    arrRows.forEach(function (row) {\r\n        row.forEach(function (cell, idy) {\r\n            // A: Transform cell data if needed\r\n            /* Table rows can be an object or plain text - transform into object when needed\r\n                // EX:\r\n                var arrTabRows1 = [\r\n                    [ { text:'A1\\nA2', options:{rowspan:2, fill:'99FFCC'} } ]\r\n                    ,[ 'B2', 'C2', 'D2', 'E2' ]\r\n                ]\r\n            */\r\n            if (typeof cell === 'number' || typeof cell === 'string') {\r\n                // Grab table formatting `opts` to use here so text style/format inherits as it should\r\n                row[idy] = { type: SLIDE_OBJECT_TYPES.tablecell, text: row[idy].toString(), options: opt };\r\n            }\r\n            else if (typeof cell === 'object') {\r\n                // ARG0: `text`\r\n                if (typeof cell.text === 'number')\r\n                    row[idy].text = row[idy].text.toString();\r\n                else if (typeof cell.text === 'undefined' || cell.text === null)\r\n                    row[idy].text = '';\r\n                // ARG1: `options`: ensure options exists\r\n                row[idy].options = cell.options || {};\r\n                // Set type to tabelcell\r\n                row[idy].type = SLIDE_OBJECT_TYPES.tablecell;\r\n            }\r\n            // B: Check for fine-grained formatting, disable auto-page when found\r\n            // Since genXmlTextBody already checks for text array ( text:[{},..{}] ) we're done!\r\n            // Text in individual cells will be formatted as they are added by calls to genXmlTextBody within table builder\r\n            if (cell.text && Array.isArray(cell.text))\r\n                opt.autoPage = false;\r\n        });\r\n    });\r\n    // STEP 6: Auto-Paging: (via {options} and used internally)\r\n    // (used internally by `tableToSlides()` to not engage recursion - we've already paged the table data, just add this one)\r\n    if (opt && opt.autoPage === false) {\r\n        // Create hyperlink rels (IMPORTANT: Wait until table has been shredded across Slides or all rels will end-up on Slide 1!)\r\n        createHyperlinkRels(target, arrRows);\r\n        // Add data (NOTE: Use `extend` to avoid mutation)\r\n        target.data.push({\r\n            type: SLIDE_OBJECT_TYPES.table,\r\n            arrTabRows: arrRows,\r\n            options: Object.assign({}, opt),\r\n        });\r\n    }\r\n    else {\r\n        // Loop over rows and create 1-N tables as needed (ISSUE#21)\r\n        getSlidesForTableRows(arrRows, opt, presLayout, slideLayout).forEach(function (slide, idx) {\r\n            // A: Create new Slide when needed, otherwise, use existing (NOTE: More than 1 table can be on a Slide, so we will go up AND down the Slide chain)\r\n            if (!getSlide(target.number + idx))\r\n                slides.push(addSlide(slideLayout ? slideLayout.name : null));\r\n            // B: Reset opt.y to `option`/`margin` after first Slide (ISSUE#43, ISSUE#47, ISSUE#48)\r\n            if (idx > 0)\r\n                opt.y = inch2Emu(opt.newSlideStartY || arrTableMargin[0]);\r\n            // C: Add this table to new Slide\r\n            {\r\n                var newSlide = getSlide(target.number + idx);\r\n                opt.autoPage = false;\r\n                // Create hyperlink rels (IMPORTANT: Wait until table has been shredded across Slides or all rels will end-up on Slide 1!)\r\n                createHyperlinkRels(newSlide, slide.rows);\r\n                // Add rows to new slide\r\n                newSlide.addTable(slide.rows, Object.assign({}, opt));\r\n            }\r\n        });\r\n    }\r\n}\r\n/**\r\n * Adds a text object to a slide definition.\r\n * @param {string|IText[]} text\r\n * @param {ITextOpts} opt\r\n * @param {ISlide} target - slide object that the text should be added to\r\n * @param {boolean} isPlaceholder` is this a placeholder object\r\n * @since: 1.0.0\r\n */\r\nfunction addTextDefinition(target, text, opts, isPlaceholder) {\r\n    var opt = opts || {};\r\n    if (!opt.bodyProp)\r\n        opt.bodyProp = {};\r\n    var newObject = {\r\n        text: (Array.isArray(text) && text.length === 0 ? '' : text || '') || '',\r\n        type: isPlaceholder ? SLIDE_OBJECT_TYPES.placeholder : SLIDE_OBJECT_TYPES.text,\r\n        options: opt,\r\n        shape: opt.shape,\r\n    };\r\n    // STEP 1: Set some options\r\n    {\r\n        // A: Placeholders should inherit their colors or override them, so don't default them\r\n        if (!opt.placeholder) {\r\n            opt.color = opt.color || target.color || DEF_FONT_COLOR; // Set color (options > inherit from Slide > default to black)\r\n        }\r\n        // B\r\n        if (opt.shape && opt.shape.name === 'line') {\r\n            opt.line = opt.line || '333333';\r\n            opt.lineSize = opt.lineSize || 1;\r\n        }\r\n        // C\r\n        newObject.options.lineSpacing = opt.lineSpacing && !isNaN(opt.lineSpacing) ? opt.lineSpacing : null;\r\n        // D: Transform text options to bodyProperties as thats how we build XML\r\n        newObject.options.bodyProp.autoFit = opt.autoFit || false; // If true, shape will collapse to text size (Fit To shape)\r\n        newObject.options.bodyProp.anchor = !opt.placeholder ? TEXT_VALIGN.ctr : null; // VALS: [t,ctr,b]\r\n        newObject.options.bodyProp.vert = opt.vert || null; // VALS: [eaVert,horz,mongolianVert,vert,vert270,wordArtVert,wordArtVertRtl]\r\n        if ((opt.inset && !isNaN(Number(opt.inset))) || opt.inset === 0) {\r\n            newObject.options.bodyProp.lIns = inch2Emu(opt.inset);\r\n            newObject.options.bodyProp.rIns = inch2Emu(opt.inset);\r\n            newObject.options.bodyProp.tIns = inch2Emu(opt.inset);\r\n            newObject.options.bodyProp.bIns = inch2Emu(opt.inset);\r\n        }\r\n    }\r\n    // STEP 2: Transform `align`/`valign` to XML values, store in bodyProp for XML gen\r\n    {\r\n        if ((newObject.options.align || '').toLowerCase().startsWith('c'))\r\n            newObject.options.bodyProp.align = TEXT_HALIGN.center;\r\n        else if ((newObject.options.align || '').toLowerCase().startsWith('l'))\r\n            newObject.options.bodyProp.align = TEXT_HALIGN.left;\r\n        else if ((newObject.options.align || '').toLowerCase().startsWith('r'))\r\n            newObject.options.bodyProp.align = TEXT_HALIGN.right;\r\n        else if ((newObject.options.align || '').toLowerCase().startsWith('j'))\r\n            newObject.options.bodyProp.align = TEXT_HALIGN.justify;\r\n        if ((newObject.options.valign || '').toLowerCase().startsWith('b'))\r\n            newObject.options.bodyProp.anchor = TEXT_VALIGN.b;\r\n        else if ((newObject.options.valign || '').toLowerCase().startsWith('m'))\r\n            newObject.options.bodyProp.anchor = TEXT_VALIGN.ctr;\r\n        else if ((newObject.options.valign || '').toLowerCase().startsWith('t'))\r\n            newObject.options.bodyProp.anchor = TEXT_VALIGN.t;\r\n    }\r\n    // STEP 3: ROBUST: Set rational values for some shadow props if needed\r\n    correctShadowOptions(opt.shadow);\r\n    // STEP 4: Create hyperlinks\r\n    createHyperlinkRels(target, newObject.text || '');\r\n    // LAST: Add object to Slide\r\n    target.data.push(newObject);\r\n}\r\n/**\r\n * Adds placeholder objects to slide\r\n * @param {ISlide} slide - slide object containing layouts\r\n */\r\nfunction addPlaceholdersToSlideLayouts(slide) {\r\n    (slide.slideLayout.data || []).forEach(function (slideLayoutObj) {\r\n        if (slideLayoutObj.type === SLIDE_OBJECT_TYPES.placeholder) {\r\n            // A: Search for this placeholder on Slide before we add\r\n            // NOTE: Check to ensure a placeholder does not already exist on the Slide\r\n            // They are created when they have been populated with text (ex: `slide.addText('Hi', { placeholder:'title' });`)\r\n            if (slide.data.filter(function (slideObj) { return slideObj.options && slideObj.options.placeholder === slideLayoutObj.options.placeholder; }).length === 0) {\r\n                addTextDefinition(slide, '', { placeholder: slideLayoutObj.options.placeholder }, false);\r\n            }\r\n        }\r\n    });\r\n}\r\n/* -------------------------------------------------------------------------------- */\r\n/**\r\n * Adds a background image or color to a slide definition.\r\n * @param {String|Object} bkg - color string or an object with image definition\r\n * @param {ISlide} target - slide object that the background is set to\r\n */\r\nfunction addBackgroundDefinition(bkg, target) {\r\n    if (typeof bkg === 'object' && (bkg.src || bkg.path || bkg.data)) {\r\n        // Allow the use of only the data key (`path` isnt reqd)\r\n        bkg.src = bkg.src || bkg.path || null;\r\n        if (!bkg.src)\r\n            bkg.src = 'preencoded.png';\r\n        var strImgExtn = (bkg.src.split('.').pop() || 'png').split('?')[0]; // Handle \"blah.jpg?width=540\" etc.\r\n        if (strImgExtn === 'jpg')\r\n            strImgExtn = 'jpeg'; // base64-encoded jpg's come out as \"data:image/jpeg;base64,/9j/[...]\", so correct exttnesion to avoid content warnings at PPT startup\r\n        var intRels = target.relsMedia.length + 1;\r\n        target.relsMedia.push({\r\n            path: bkg.src,\r\n            type: SLIDE_OBJECT_TYPES.image,\r\n            extn: strImgExtn,\r\n            data: bkg.data || null,\r\n            rId: intRels,\r\n            Target: '../media/image' + (target.relsMedia.length + 1) + '.' + strImgExtn,\r\n        });\r\n        target.bkgdImgRid = intRels;\r\n    }\r\n    else if (bkg && typeof bkg === 'string') {\r\n        target.bkgd = bkg;\r\n    }\r\n}\r\n/**\r\n * Parses text/text-objects from `addText()` and `addTable()` methods; creates 'hyperlink'-type Slide Rels for each hyperlink found\r\n * @param {ISlide} target - slide object that any hyperlinks will be be added to\r\n * @param {number | string | IText | IText[] | ITableCell[][]} text - text to parse\r\n */\r\nfunction createHyperlinkRels(target, text) {\r\n    var textObjs = [];\r\n    // Only text objects can have hyperlinks, bail when text param is plain text\r\n    if (typeof text === 'string' || typeof text === 'number')\r\n        return;\r\n    // IMPORTANT: \"else if\" Array.isArray must come before typeof===object! Otherwise, code will exhaust recursion!\r\n    else if (Array.isArray(text))\r\n        textObjs = text;\r\n    else if (typeof text === 'object')\r\n        textObjs = [text];\r\n    textObjs.forEach(function (text) {\r\n        // `text` can be an array of other `text` objects (table cell word-level formatting), continue parsing using recursion\r\n        if (Array.isArray(text))\r\n            createHyperlinkRels(target, text);\r\n        else if (text && typeof text === 'object' && text.options && text.options.hyperlink && !text.options.hyperlink.rId) {\r\n            if (typeof text.options.hyperlink !== 'object')\r\n                console.log(\"ERROR: text `hyperlink` option should be an object. Ex: `hyperlink: {url:'https://github.com'}` \");\r\n            else if (!text.options.hyperlink.url && !text.options.hyperlink.slide)\r\n                console.log(\"ERROR: 'hyperlink requires either: `url` or `slide`'\");\r\n            else {\r\n                var relId = target.rels.length + target.relsChart.length + target.relsMedia.length + 1;\r\n                target.rels.push({\r\n                    type: SLIDE_OBJECT_TYPES.hyperlink,\r\n                    data: text.options.hyperlink.slide ? 'slide' : 'dummy',\r\n                    rId: relId,\r\n                    Target: encodeXmlEntities(text.options.hyperlink.url) || text.options.hyperlink.slide.toString(),\r\n                });\r\n                text.options.hyperlink.rId = relId;\r\n            }\r\n        }\r\n    });\r\n}\n\n/**\r\n * PptxGenJS: Slide Class\r\n */\r\nvar Slide = /** @class */ (function () {\r\n    function Slide(params) {\r\n        this.addSlide = params.addSlide;\r\n        this.getSlide = params.getSlide;\r\n        this.presLayout = params.presLayout;\r\n        this._setSlideNum = params.setSlideNum;\r\n        this.name = 'Slide ' + params.slideNumber;\r\n        this.number = params.slideNumber;\r\n        this.data = [];\r\n        this.rels = [];\r\n        this.relsChart = [];\r\n        this.relsMedia = [];\r\n        this.slideLayout = params.slideLayout || null;\r\n        // NOTE: Slide Numbers: In order for Slide Numbers to function they need to be in all 3 files: master/layout/slide\r\n        // `defineSlideMaster` and `addNewSlide.slideNumber` will add {slideNumber} to `this.masterSlide` and `this.slideLayouts`\r\n        // so, lastly, add to the Slide now.\r\n        this.slideNumberObj = this.slideLayout && this.slideLayout.slideNumberObj ? this.slideLayout.slideNumberObj : null;\r\n    }\r\n    Object.defineProperty(Slide.prototype, \"bkgd\", {\r\n        get: function () {\r\n            return this._bkgd;\r\n        },\r\n        set: function (value) {\r\n            this._bkgd = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Slide.prototype, \"color\", {\r\n        get: function () {\r\n            return this._color;\r\n        },\r\n        set: function (value) {\r\n            this._color = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Slide.prototype, \"hidden\", {\r\n        get: function () {\r\n            return this._hidden;\r\n        },\r\n        set: function (value) {\r\n            this._hidden = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Slide.prototype, \"slideNumber\", {\r\n        get: function () {\r\n            return this._slideNumber;\r\n        },\r\n        set: function (value) {\r\n            // NOTE: Slide Numbers: In order for Slide Numbers to function they need to be in all 3 files: master/layout/slide\r\n            this.slideNumberObj = value;\r\n            this._slideNumber = value;\r\n            this._setSlideNum(value);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Generate the chart based on input data.\r\n     * @see OOXML Chart Spec: ISO/IEC 29500-1:2016(E)\r\n     * @param {CHART_TYPE_NAMES|IChartMulti[]} `type` - chart type\r\n     * @param {object[]} data - a JSON object with follow the following format\r\n     * @param {IChartOpts} options - chart options\r\n     * @example\r\n     * {\r\n     *   title: 'eSurvey chart',\r\n     *   data: [\r\n     *\t\t{\r\n     *\t\t\tname: 'Income',\r\n     *\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n     *\t\t},\r\n     *\t\t{\r\n     *\t\t\tname: 'Expense',\r\n     *\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *\t\t\tvalues: [18.1, 22.8, 23.9, 25.1, 25]\r\n     *\t\t}\r\n     *\t ]\r\n     * }\r\n     * @return {Slide} this class\r\n     */\r\n    Slide.prototype.addChart = function (type, data, options) {\r\n        addChartDefinition(this, type, data, options);\r\n        return this;\r\n    };\r\n    /**\r\n     * Add Image object\r\n     * @note: Remote images (eg: \"http://whatev.com/blah\"/from web and/or remote server arent supported yet - we'd need to create an <img>, load it, then send to canvas\r\n     * @see: https://stackoverflow.com/questions/164181/how-to-fetch-a-remote-image-to-display-in-a-canvas)\r\n     * @param {IImageOpts} options - image options\r\n     * @return {Slide} this class\r\n     */\r\n    Slide.prototype.addImage = function (options) {\r\n        addImageDefinition(this, options);\r\n        return this;\r\n    };\r\n    /**\r\n     * Add Media (audio/video) object\r\n     * @param {IMediaOpts} options - media options\r\n     * @return {Slide} this class\r\n     */\r\n    Slide.prototype.addMedia = function (options) {\r\n        addMediaDefinition(this, options);\r\n        return this;\r\n    };\r\n    /**\r\n     * Add Speaker Notes to Slide\r\n     * @docs https://gitbrent.github.io/PptxGenJS/docs/speaker-notes.html\r\n     * @param {string} notes - notes to add to slide\r\n     * @return {Slide} this class\r\n     */\r\n    Slide.prototype.addNotes = function (notes) {\r\n        addNotesDefinition(this, notes);\r\n        return this;\r\n    };\r\n    /**\r\n     * Add shape object to Slide\r\n     * @param {IShape} shape - shape object\r\n     * @param {IShapeOptions} options - shape options\r\n     * @return {Slide} this class\r\n     */\r\n    Slide.prototype.addShape = function (shape, options) {\r\n        addShapeDefinition(this, shape, options);\r\n        return this;\r\n    };\r\n    /**\r\n     * Add shape object to Slide\r\n     * @note can be recursive\r\n     * @param {TableRow[]} arrTabRows - table rows\r\n     * @param {ITableOptions} options - table options\r\n     * @return {Slide} this class\r\n     */\r\n    Slide.prototype.addTable = function (arrTabRows, options) {\r\n        // FIXME: TODO: we pass `this` - we dont need to pass layouts - they can be read from this!\r\n        addTableDefinition(this, arrTabRows, options, this.slideLayout, this.presLayout, this.addSlide, this.getSlide);\r\n        return this;\r\n    };\r\n    /**\r\n     * Add text object to Slide\r\n     * @param {string|IText[]} text - text string or complex object\r\n     * @param {ITextOpts} options - text options\r\n     * @return {Slide} this class\r\n     * @since: 1.0.0\r\n     */\r\n    Slide.prototype.addText = function (text, options) {\r\n        addTextDefinition(this, text, options, false);\r\n        return this;\r\n    };\r\n    return Slide;\r\n}());\n\n/**\r\n * PptxGenJS: Chart Generation\r\n */\r\n/**\r\n * Based on passed data, creates Excel Worksheet that is used as a data source for a chart.\r\n * @param {ISlideRelChart} chartObject - chart object\r\n * @param {JSZip} zip - file that the resulting XLSX should be added to\r\n * @return {Promise} promise of generating the XLSX file\r\n */\r\nfunction createExcelWorksheet(chartObject, zip) {\r\n    var data = chartObject.data;\r\n    return new Promise(function (resolve, reject) {\r\n        var zipExcel = new JSZip();\r\n        var intBubbleCols = (data.length - 1) * 2 + 1; // 1 for \"X-Values\", then 2 for every Y-Axis\r\n        // A: Add folders\r\n        zipExcel.folder('_rels');\r\n        zipExcel.folder('docProps');\r\n        zipExcel.folder('xl/_rels');\r\n        zipExcel.folder('xl/tables');\r\n        zipExcel.folder('xl/theme');\r\n        zipExcel.folder('xl/worksheets');\r\n        zipExcel.folder('xl/worksheets/_rels');\r\n        // B: Add core contents\r\n        {\r\n            zipExcel.file('[Content_Types].xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' +\r\n                '  <Default Extension=\"xml\" ContentType=\"application/xml\"/>' +\r\n                '  <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>' +\r\n                //+ '  <Default Extension=\"jpeg\" ContentType=\"image/jpg\"/><Default Extension=\"png\" ContentType=\"image/png\"/>'\r\n                //+ '  <Default Extension=\"bmp\" ContentType=\"image/bmp\"/><Default Extension=\"gif\" ContentType=\"image/gif\"/><Default Extension=\"tif\" ContentType=\"image/tif\"/><Default Extension=\"pdf\" ContentType=\"application/pdf\"/><Default Extension=\"mov\" ContentType=\"application/movie\"/><Default Extension=\"vml\" ContentType=\"application/vnd.openxmlformats-officedocument.vmlDrawing\"/>'\r\n                //+ '  <Default Extension=\"xlsx\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"/>'\r\n                '  <Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\"/>' +\r\n                '  <Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\"/>' +\r\n                '  <Override PartName=\"/xl/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>' +\r\n                '  <Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\"/>' +\r\n                '  <Override PartName=\"/xl/sharedStrings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\"/>' +\r\n                '  <Override PartName=\"/xl/tables/table1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\"/>' +\r\n                '  <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>' +\r\n                '  <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>' +\r\n                '</Types>\\n');\r\n            zipExcel.file('_rels/.rels', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\r\n                '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>' +\r\n                '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>' +\r\n                '<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>' +\r\n                '</Relationships>\\n');\r\n            zipExcel.file('docProps/app.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">' +\r\n                '<Application>Microsoft Excel</Application>' +\r\n                '<DocSecurity>0</DocSecurity>' +\r\n                '<ScaleCrop>false</ScaleCrop>' +\r\n                '<HeadingPairs><vt:vector size=\"2\" baseType=\"variant\"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"1\" baseType=\"lpstr\"><vt:lpstr>Sheet1</vt:lpstr></vt:vector></TitlesOfParts>' +\r\n                '</Properties>\\n');\r\n            zipExcel.file('docProps/core.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\"?><cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">' +\r\n                '<dc:creator>PptxGenJS</dc:creator>' +\r\n                '<cp:lastModifiedBy>Ely, Brent</cp:lastModifiedBy>' +\r\n                '<dcterms:created xsi:type=\"dcterms:W3CDTF\">' +\r\n                new Date().toISOString() +\r\n                '</dcterms:created>' +\r\n                '<dcterms:modified xsi:type=\"dcterms:W3CDTF\">' +\r\n                new Date().toISOString() +\r\n                '</dcterms:modified>' +\r\n                '</cp:coreProperties>\\n');\r\n            zipExcel.file('xl/_rels/workbook.xml.rels', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n                '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\r\n                '<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' +\r\n                '<Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\" Target=\"sharedStrings.xml\"/>' +\r\n                '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>' +\r\n                '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>' +\r\n                '</Relationships>\\n');\r\n            zipExcel.file('xl/styles.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"><numFmts count=\"1\"><numFmt numFmtId=\"0\" formatCode=\"General\"/></numFmts><fonts count=\"4\"><font><sz val=\"9\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"9\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"10\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"18\"/><color indexed=\"8\"/>' +\r\n                '<name val=\"Arial\"/></font></fonts><fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills><borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders><dxfs count=\"0\"/><tableStyles count=\"0\"/><colors><indexedColors><rgbColor rgb=\"ff000000\"/><rgbColor rgb=\"ffffffff\"/><rgbColor rgb=\"ffff0000\"/><rgbColor rgb=\"ff00ff00\"/><rgbColor rgb=\"ff0000ff\"/>' +\r\n                '<rgbColor rgb=\"ffffff00\"/><rgbColor rgb=\"ffff00ff\"/><rgbColor rgb=\"ff00ffff\"/><rgbColor rgb=\"ff000000\"/><rgbColor rgb=\"ffffffff\"/><rgbColor rgb=\"ff878787\"/><rgbColor rgb=\"fff9f9f9\"/></indexedColors></colors></styleSheet>\\n');\r\n            zipExcel.file('xl/theme/theme1.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"44546A\"/></a:dk2><a:lt2><a:srgbClr val=\"E7E6E6\"/></a:lt2><a:accent1><a:srgbClr val=\"4472C4\"/></a:accent1><a:accent2><a:srgbClr val=\"ED7D31\"/></a:accent2><a:accent3><a:srgbClr val=\"A5A5A5\"/></a:accent3><a:accent4><a:srgbClr val=\"FFC000\"/></a:accent4><a:accent5><a:srgbClr val=\"5B9BD5\"/></a:accent5><a:accent6><a:srgbClr val=\"70AD47\"/></a:accent6><a:hlink><a:srgbClr val=\"0563C1\"/></a:hlink><a:folHlink><a:srgbClr val=\"954F72\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Calibri Light\" panose=\"020F0302020204030204\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"Yu Gothic Light\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"DengXian Light\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\" panose=\"020F0502020204030204\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"Yu Gothic\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"DengXian\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"110000\"/><a:satMod val=\"105000\"/><a:tint val=\"67000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"105000\"/><a:satMod val=\"103000\"/><a:tint val=\"73000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"105000\"/><a:satMod val=\"109000\"/><a:tint val=\"81000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:satMod val=\"103000\"/><a:lumMod val=\"102000\"/><a:tint val=\"94000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:satMod val=\"110000\"/><a:lumMod val=\"100000\"/><a:shade val=\"100000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"99000\"/><a:satMod val=\"120000\"/><a:shade val=\"78000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"6350\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln><a:ln w=\"12700\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln><a:ln w=\"19050\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"57150\" dist=\"19050\" dir=\"5400000\" algn=\"ctr\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"63000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:solidFill><a:schemeClr val=\"phClr\"><a:tint val=\"95000\"/><a:satMod val=\"170000\"/></a:schemeClr></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"93000\"/><a:satMod val=\"150000\"/><a:shade val=\"98000\"/><a:lumMod val=\"102000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:tint val=\"98000\"/><a:satMod val=\"130000\"/><a:shade val=\"90000\"/><a:lumMod val=\"103000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"63000\"/><a:satMod val=\"120000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/><a:extLst><a:ext uri=\"{05A4C25C-085E-4340-85A3-A5531E510DB2}\"><thm15:themeFamily xmlns:thm15=\"http://schemas.microsoft.com/office/thememl/2012/main\" name=\"Office Theme\" id=\"{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}\" vid=\"{4A3C46E8-61CC-4603-A589-7422A47A8E4A}\"/></a:ext></a:extLst></a:theme>');\r\n            zipExcel.file('xl/workbook.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +\r\n                '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x15\" xmlns:x15=\"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main\">' +\r\n                '<fileVersion appName=\"xl\" lastEdited=\"6\" lowestEdited=\"6\" rupBuild=\"14420\"/>' +\r\n                '<workbookPr />' +\r\n                '<bookViews><workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"15960\" windowHeight=\"18080\"/></bookViews>' +\r\n                '<sheets><sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\" /></sheets>' +\r\n                '<calcPr calcId=\"171026\" concurrentCalc=\"0\"/>' +\r\n                '</workbook>\\n');\r\n            zipExcel.file('xl/worksheets/_rels/sheet1.xml.rels', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n                '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\r\n                '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table\" Target=\"../tables/table1.xml\"/>' +\r\n                '</Relationships>\\n');\r\n        }\r\n        // sharedStrings.xml\r\n        {\r\n            // A: Start XML\r\n            var strSharedStrings_1 = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n            if (chartObject.opts.type === CHART_TYPES.BUBBLE) {\r\n                strSharedStrings_1 +=\r\n                    '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' + (intBubbleCols + 1) + '\" uniqueCount=\"' + (intBubbleCols + 1) + '\">';\r\n            }\r\n            else if (chartObject.opts.type === CHART_TYPES.SCATTER) {\r\n                strSharedStrings_1 +=\r\n                    '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' + (data.length + 1) + '\" uniqueCount=\"' + (data.length + 1) + '\">';\r\n            }\r\n            else {\r\n                strSharedStrings_1 +=\r\n                    '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' +\r\n                        (data[0].labels.length + data.length + 1) +\r\n                        '\" uniqueCount=\"' +\r\n                        (data[0].labels.length + data.length + 1) +\r\n                        '\">';\r\n                // B: Add 'blank' for A1\r\n                strSharedStrings_1 += '<si><t xml:space=\"preserve\"></t></si>';\r\n            }\r\n            // C: Add `name`/Series\r\n            if (chartObject.opts.type === CHART_TYPES.BUBBLE) {\r\n                data.forEach(function (objData, idx) {\r\n                    if (idx === 0)\r\n                        strSharedStrings_1 += '<si><t>X-Axis</t></si>';\r\n                    else {\r\n                        strSharedStrings_1 += '<si><t>' + encodeXmlEntities(objData.name || ' ') + '</t></si>';\r\n                        strSharedStrings_1 += '<si><t>' + encodeXmlEntities('Size ' + idx) + '</t></si>';\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                data.forEach(function (objData) {\r\n                    strSharedStrings_1 += '<si><t>' + encodeXmlEntities((objData.name || ' ').replace('X-Axis', 'X-Values')) + '</t></si>';\r\n                });\r\n            }\r\n            // D: Add `labels`/Categories\r\n            if (chartObject.opts.type !== CHART_TYPES.BUBBLE && chartObject.opts.type !== CHART_TYPES.SCATTER) {\r\n                data[0].labels.forEach(function (label) {\r\n                    strSharedStrings_1 += '<si><t>' + encodeXmlEntities(label) + '</t></si>';\r\n                });\r\n            }\r\n            strSharedStrings_1 += '</sst>\\n';\r\n            zipExcel.file('xl/sharedStrings.xml', strSharedStrings_1);\r\n        }\r\n        // tables/table1.xml\r\n        {\r\n            var strTableXml_1 = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n            if (chartObject.opts.type === CHART_TYPES.BUBBLE) ;\r\n            else if (chartObject.opts.type === CHART_TYPES.SCATTER) {\r\n                strTableXml_1 +=\r\n                    '<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Table1\" displayName=\"Table1\" ref=\"A1:' +\r\n                        LETTERS[data.length - 1] +\r\n                        (data[0].values.length + 1) +\r\n                        '\" totalsRowShown=\"0\">';\r\n                strTableXml_1 += '<tableColumns count=\"' + data.length + '\">';\r\n                data.forEach(function (_obj, idx) {\r\n                    strTableXml_1 += '<tableColumn id=\"' + (idx + 1) + '\" name=\"' + (idx === 0 ? 'X-Values' : 'Y-Value ' + idx) + '\" />';\r\n                });\r\n            }\r\n            else {\r\n                strTableXml_1 +=\r\n                    '<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Table1\" displayName=\"Table1\" ref=\"A1:' +\r\n                        LETTERS[data.length] +\r\n                        (data[0].labels.length + 1) +\r\n                        '\" totalsRowShown=\"0\">';\r\n                strTableXml_1 += '<tableColumns count=\"' + (data.length + 1) + '\">';\r\n                strTableXml_1 += '<tableColumn id=\"1\" name=\" \" />';\r\n                data.forEach(function (obj, idx) {\r\n                    strTableXml_1 += '<tableColumn id=\"' + (idx + 2) + '\" name=\"' + encodeXmlEntities(obj.name) + '\" />';\r\n                });\r\n            }\r\n            strTableXml_1 += '</tableColumns>';\r\n            strTableXml_1 += '<tableStyleInfo showFirstColumn=\"0\" showLastColumn=\"0\" showRowStripes=\"1\" showColumnStripes=\"0\" />';\r\n            strTableXml_1 += '</table>';\r\n            zipExcel.file('xl/tables/table1.xml', strTableXml_1);\r\n        }\r\n        // worksheets/sheet1.xml\r\n        {\r\n            var strSheetXml_1 = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n            strSheetXml_1 +=\r\n                '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">';\r\n            if (chartObject.opts.type === CHART_TYPES.BUBBLE) {\r\n                strSheetXml_1 += '<dimension ref=\"A1:' + LETTERS[intBubbleCols - 1] + (data[0].values.length + 1) + '\" />';\r\n            }\r\n            else if (chartObject.opts.type === CHART_TYPES.SCATTER) {\r\n                strSheetXml_1 += '<dimension ref=\"A1:' + LETTERS[data.length - 1] + (data[0].values.length + 1) + '\" />';\r\n            }\r\n            else {\r\n                strSheetXml_1 += '<dimension ref=\"A1:' + LETTERS[data.length] + (data[0].labels.length + 1) + '\" />';\r\n            }\r\n            strSheetXml_1 += '<sheetViews><sheetView tabSelected=\"1\" workbookViewId=\"0\"><selection activeCell=\"B1\" sqref=\"B1\" /></sheetView></sheetViews>';\r\n            strSheetXml_1 += '<sheetFormatPr baseColWidth=\"10\" defaultColWidth=\"11.5\" defaultRowHeight=\"12\" />';\r\n            if (chartObject.opts.type === CHART_TYPES.BUBBLE) {\r\n                strSheetXml_1 += '<cols>';\r\n                strSheetXml_1 += '<col min=\"1\" max=\"' + data.length + '\" width=\"11\" customWidth=\"1\" />';\r\n                strSheetXml_1 += '</cols>';\r\n                /* EX: INPUT: `data`\r\n                [\r\n                    { name:'X-Axis'  , values:[10,11,12,13,14,15,16,17,18,19,20] },\r\n                    { name:'Y-Axis 1', values:[ 1, 6, 7, 8, 9], sizes:[ 4, 5, 6, 7, 8] },\r\n                    { name:'Y-Axis 2', values:[33,32,42,53,63], sizes:[11,12,13,14,15] }\r\n                ];\r\n                */\r\n                /* EX: OUTPUT: bubbleChart Worksheet:\r\n                    -|----A-----|------B-----|------C-----|------D-----|------E-----|\r\n                    1| X-Values | Y-Values 1 | Y-Sizes 1  | Y-Values 2 | Y-Sizes 2  |\r\n                    2|    11    |     22     |      4     |     33     |      8     |\r\n                    -|----------|------------|------------|------------|------------|\r\n                */\r\n                strSheetXml_1 += '<sheetData>';\r\n                // A: Create header row first (NOTE: Start at index=1 as headers cols start with 'B')\r\n                strSheetXml_1 += '<row r=\"1\" spans=\"1:' + intBubbleCols + '\">';\r\n                strSheetXml_1 += '<c r=\"A1\" t=\"s\"><v>0</v></c>';\r\n                for (var idxBc = 1; idxBc < intBubbleCols; idxBc++) {\r\n                    strSheetXml_1 += '<c r=\"' + (idxBc < 26 ? LETTERS[idxBc] : 'A' + LETTERS[idxBc % LETTERS.length]) + '1\" t=\"s\">'; // NOTE: use `t=\"s\"` for label cols!\r\n                    strSheetXml_1 += '<v>' + idxBc + '</v>';\r\n                    strSheetXml_1 += '</c>';\r\n                }\r\n                strSheetXml_1 += '</row>';\r\n                // B: Add row for each X-Axis value (Y-Axis* value is optional)\r\n                data[0].values.forEach(function (val, idx) {\r\n                    // Leading col is reserved for the 'X-Axis' value, so hard-code it, then loop over col values\r\n                    strSheetXml_1 += '<row r=\"' + (idx + 2) + '\" spans=\"1:' + intBubbleCols + '\">';\r\n                    strSheetXml_1 += '<c r=\"A' + (idx + 2) + '\"><v>' + val + '</v></c>';\r\n                    // Add Y-Axis 1->N (idy=0 = Xaxis)\r\n                    var idxColLtr = 1;\r\n                    for (var idy = 1; idy < data.length; idy++) {\r\n                        // y-value\r\n                        strSheetXml_1 += '<c r=\"' + (idxColLtr < 26 ? LETTERS[idxColLtr] : 'A' + LETTERS[idxColLtr % LETTERS.length]) + '' + (idx + 2) + '\">';\r\n                        strSheetXml_1 += '<v>' + (data[idy].values[idx] || '') + '</v>';\r\n                        strSheetXml_1 += '</c>';\r\n                        idxColLtr++;\r\n                        // y-size\r\n                        strSheetXml_1 += '<c r=\"' + (idxColLtr < 26 ? LETTERS[idxColLtr] : 'A' + LETTERS[idxColLtr % LETTERS.length]) + '' + (idx + 2) + '\">';\r\n                        strSheetXml_1 += '<v>' + (data[idy].sizes[idx] || '') + '</v>';\r\n                        strSheetXml_1 += '</c>';\r\n                        idxColLtr++;\r\n                    }\r\n                    strSheetXml_1 += '</row>';\r\n                });\r\n            }\r\n            else if (chartObject.opts.type === CHART_TYPES.SCATTER) {\r\n                strSheetXml_1 += '<cols>';\r\n                strSheetXml_1 += '<col min=\"1\" max=\"' + data.length + '\" width=\"11\" customWidth=\"1\" />';\r\n                //data.forEach((obj,idx)=>{ strSheetXml += '<col min=\"'+(idx+1)+'\" max=\"'+(idx+1)+'\" width=\"11\" customWidth=\"1\" />' });\r\n                strSheetXml_1 += '</cols>';\r\n                /* EX: INPUT: `data`\r\n                [\r\n                    { name:'X-Axis'  , values:[10,11,12,13,14,15,16,17,18,19,20] },\r\n                    { name:'Y-Axis 1', values:[ 1, 6, 7, 8, 9] },\r\n                    { name:'Y-Axis 2', values:[33,32,42,53,63] }\r\n                ];\r\n                */\r\n                /* EX: OUTPUT: scatterChart Worksheet:\r\n                    -|----A-----|------B-----|\r\n                    1| X-Values | Y-Values 1 |\r\n                    2|    11    |     22     |\r\n                    -|----------|------------|\r\n                */\r\n                strSheetXml_1 += '<sheetData>';\r\n                // A: Create header row first (NOTE: Start at index=1 as headers cols start with 'B')\r\n                strSheetXml_1 += '<row r=\"1\" spans=\"1:' + data.length + '\">';\r\n                strSheetXml_1 += '<c r=\"A1\" t=\"s\"><v>0</v></c>';\r\n                for (var idxSd = 1; idxSd < data.length; idxSd++) {\r\n                    strSheetXml_1 += '<c r=\"' + (idxSd < 26 ? LETTERS[idxSd] : 'A' + LETTERS[idxSd % LETTERS.length]) + '1\" t=\"s\">'; // NOTE: use `t=\"s\"` for label cols!\r\n                    strSheetXml_1 += '<v>' + idxSd + '</v>';\r\n                    strSheetXml_1 += '</c>';\r\n                }\r\n                strSheetXml_1 += '</row>';\r\n                // B: Add row for each X-Axis value (Y-Axis* value is optional)\r\n                data[0].values.forEach(function (val, idx) {\r\n                    // Leading col is reserved for the 'X-Axis' value, so hard-code it, then loop over col values\r\n                    strSheetXml_1 += '<row r=\"' + (idx + 2) + '\" spans=\"1:' + data.length + '\">';\r\n                    strSheetXml_1 += '<c r=\"A' + (idx + 2) + '\"><v>' + val + '</v></c>';\r\n                    // Add Y-Axis 1->N\r\n                    for (var idy = 1; idy < data.length; idy++) {\r\n                        strSheetXml_1 += '<c r=\"' + (idy < 26 ? LETTERS[idy] : 'A' + LETTERS[idy % LETTERS.length]) + '' + (idx + 2) + '\">';\r\n                        strSheetXml_1 += '<v>' + (data[idy].values[idx] || data[idy].values[idx] === 0 ? data[idy].values[idx] : '') + '</v>';\r\n                        strSheetXml_1 += '</c>';\r\n                    }\r\n                    strSheetXml_1 += '</row>';\r\n                });\r\n            }\r\n            else {\r\n                strSheetXml_1 += '<cols>';\r\n                strSheetXml_1 += '<col min=\"1\" max=\"1\" width=\"11\" customWidth=\"1\" />';\r\n                //data.forEach(function(){ strSheetXml += '<col min=\"10\" max=\"100\" width=\"10\" customWidth=\"1\" />' });\r\n                strSheetXml_1 += '</cols>';\r\n                strSheetXml_1 += '<sheetData>';\r\n                /* EX: INPUT: `data`\r\n                [\r\n                    { name:'Red', labels:['Jan..May-17'], values:[11,13,14,15,16] },\r\n                    { name:'Amb', labels:['Jan..May-17'], values:[22, 6, 7, 8, 9] },\r\n                    { name:'Grn', labels:['Jan..May-17'], values:[33,32,42,53,63] }\r\n                ];\r\n                */\r\n                /* EX: OUTPUT: lineChart Worksheet:\r\n                    -|---A---|--B--|--C--|--D--|\r\n                    1|       | Red | Amb | Grn |\r\n                    2|Jan-17 |   11|   22|   33|\r\n                    3|Feb-17 |   55|   43|   70|\r\n                    4|Mar-17 |   56|  143|   99|\r\n                    5|Apr-17 |   65|    3|  120|\r\n                    6|May-17 |   75|   93|  170|\r\n                    -|-------|-----|-----|-----|\r\n                */\r\n                // A: Create header row first (NOTE: Start at index=1 as headers cols start with 'B')\r\n                strSheetXml_1 += '<row r=\"1\" spans=\"1:' + (data.length + 1) + '\">';\r\n                strSheetXml_1 += '<c r=\"A1\" t=\"s\"><v>0</v></c>';\r\n                for (var idx = 1; idx <= data.length; idx++) {\r\n                    // FIXME: Max cols is 52\r\n                    strSheetXml_1 += '<c r=\"' + (idx < 26 ? LETTERS[idx] : 'A' + LETTERS[idx % LETTERS.length]) + '1\" t=\"s\">'; // NOTE: use `t=\"s\"` for label cols!\r\n                    strSheetXml_1 += '<v>' + idx + '</v>';\r\n                    strSheetXml_1 += '</c>';\r\n                }\r\n                strSheetXml_1 += '</row>';\r\n                // B: Add data row(s) for each category\r\n                data[0].labels.forEach(function (_cat, idx) {\r\n                    // Leading col is reserved for the label, so hard-code it, then loop over col values\r\n                    strSheetXml_1 += '<row r=\"' + (idx + 2) + '\" spans=\"1:' + (data.length + 1) + '\">';\r\n                    strSheetXml_1 += '<c r=\"A' + (idx + 2) + '\" t=\"s\">';\r\n                    strSheetXml_1 += '<v>' + (data.length + idx + 1) + '</v>';\r\n                    strSheetXml_1 += '</c>';\r\n                    for (var idy = 0; idy < data.length; idy++) {\r\n                        strSheetXml_1 += '<c r=\"' + (idy + 1 < 26 ? LETTERS[idy + 1] : 'A' + LETTERS[(idy + 1) % LETTERS.length]) + '' + (idx + 2) + '\">';\r\n                        strSheetXml_1 += '<v>' + (data[idy].values[idx] || '') + '</v>';\r\n                        strSheetXml_1 += '</c>';\r\n                    }\r\n                    strSheetXml_1 += '</row>';\r\n                });\r\n            }\r\n            strSheetXml_1 += '</sheetData>';\r\n            strSheetXml_1 += '<pageMargins left=\"0.7\" right=\"0.7\" top=\"0.75\" bottom=\"0.75\" header=\"0.3\" footer=\"0.3\" />';\r\n            // Link the `table1.xml` file to define an actual Table in Excel\r\n            // NOTE: This only works with scatter charts - all others give a \"cannot find linked file\" error\r\n            // ....: Since we dont need the table anyway (chart data can be edited/range selected, etc.), just dont use this\r\n            // ....: Leaving this so nobody foolishly attempts to add this in the future\r\n            // strSheetXml += '<tableParts count=\"1\"><tablePart r:id=\"rId1\" /></tableParts>';\r\n            strSheetXml_1 += '</worksheet>\\n';\r\n            zipExcel.file('xl/worksheets/sheet1.xml', strSheetXml_1);\r\n        }\r\n        // C: Add XLSX to PPTX export\r\n        zipExcel\r\n            .generateAsync({ type: 'base64' })\r\n            .then(function (content) {\r\n            // 1: Create the embedded Excel worksheet with labels and data\r\n            zip.file('ppt/embeddings/Microsoft_Excel_Worksheet' + chartObject.globalId + '.xlsx', content, { base64: true });\r\n            // 2: Create the chart.xml and rels files\r\n            zip.file('ppt/charts/_rels/' + chartObject.fileName + '.rels', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n                '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\r\n                '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/package\" Target=\"../embeddings/Microsoft_Excel_Worksheet' +\r\n                chartObject.globalId +\r\n                '.xlsx\"/>' +\r\n                '</Relationships>');\r\n            zip.file('ppt/charts/' + chartObject.fileName, makeXmlCharts(chartObject));\r\n            // 3: Done\r\n            resolve();\r\n        })\r\n            .catch(function (strErr) {\r\n            reject(strErr);\r\n        });\r\n    });\r\n}\r\n/**\r\n * Main entry point method for create charts\r\n * @see: http://www.datypic.com/sc/ooxml/s-dml-chart.xsd.html\r\n * @param {ISlideRelChart} rel - chart object\r\n * @return {string} XML\r\n */\r\nfunction makeXmlCharts(rel) {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n    var usesSecondaryValAxis = false;\r\n    // STEP 1: Create chart\r\n    {\r\n        // CHARTSPACE: BEGIN vvv\r\n        strXml +=\r\n            '<c:chartSpace xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">';\r\n        strXml += '<c:date1904 val=\"0\"/>'; // ppt defaults to 1904 dates, excel to 1900\r\n        strXml += '<c:chart>';\r\n        // OPTION: Title\r\n        if (rel.opts.showTitle) {\r\n            strXml += genXmlTitle({\r\n                title: rel.opts.title || 'Chart Title',\r\n                fontSize: rel.opts.titleFontSize || DEF_FONT_TITLE_SIZE,\r\n                color: rel.opts.titleColor,\r\n                fontFace: rel.opts.titleFontFace,\r\n                rotate: rel.opts.titleRotate,\r\n                titleAlign: rel.opts.titleAlign,\r\n                titlePos: rel.opts.titlePos,\r\n            });\r\n            strXml += '<c:autoTitleDeleted val=\"0\"/>';\r\n        }\r\n        else {\r\n            // NOTE: Add autoTitleDeleted tag in else to prevent default creation of chart title even when showTitle is set to false\r\n            strXml += '<c:autoTitleDeleted val=\"1\"/>';\r\n        }\r\n        // Add 3D view tag\r\n        if (rel.opts.type === CHART_TYPES.BAR3D) {\r\n            strXml += '<c:view3D>';\r\n            strXml += ' <c:rotX val=\"' + rel.opts.v3DRotX + '\"/>';\r\n            strXml += ' <c:rotY val=\"' + rel.opts.v3DRotY + '\"/>';\r\n            strXml += ' <c:rAngAx val=\"' + (rel.opts.v3DRAngAx === false ? 0 : 1) + '\"/>';\r\n            strXml += ' <c:perspective val=\"' + rel.opts.v3DPerspective + '\"/>';\r\n            strXml += '</c:view3D>';\r\n        }\r\n        strXml += '<c:plotArea>';\r\n        // IMPORTANT: Dont specify layout to enable auto-fit: PPT does a great job maximizing space with all 4 TRBL locations\r\n        if (rel.opts.layout) {\r\n            strXml += '<c:layout>';\r\n            strXml += ' <c:manualLayout>';\r\n            strXml += '  <c:layoutTarget val=\"inner\" />';\r\n            strXml += '  <c:xMode val=\"edge\" />';\r\n            strXml += '  <c:yMode val=\"edge\" />';\r\n            strXml += '  <c:x val=\"' + (rel.opts.layout.x || 0) + '\" />';\r\n            strXml += '  <c:y val=\"' + (rel.opts.layout.y || 0) + '\" />';\r\n            strXml += '  <c:w val=\"' + (rel.opts.layout.w || 1) + '\" />';\r\n            strXml += '  <c:h val=\"' + (rel.opts.layout.h || 1) + '\" />';\r\n            strXml += ' </c:manualLayout>';\r\n            strXml += '</c:layout>';\r\n        }\r\n        else {\r\n            strXml += '<c:layout/>';\r\n        }\r\n    }\r\n    // A: Create Chart XML -----------------------------------------------------------\r\n    if (Array.isArray(rel.opts.type)) {\r\n        rel.opts.type.forEach(function (type) {\r\n            // TODO: FIXME: theres `options` on chart rels??\r\n            var options = getMix(rel.opts, type.options);\r\n            //let options: IChartOpts = { type: type.type, }\r\n            var valAxisId = options['secondaryValAxis'] ? AXIS_ID_VALUE_SECONDARY : AXIS_ID_VALUE_PRIMARY;\r\n            var catAxisId = options['secondaryCatAxis'] ? AXIS_ID_CATEGORY_SECONDARY : AXIS_ID_CATEGORY_PRIMARY;\r\n            usesSecondaryValAxis = usesSecondaryValAxis || options['secondaryValAxis'];\r\n            strXml += makeChartType(type.type, type.data, options, valAxisId, catAxisId, true);\r\n        });\r\n    }\r\n    else {\r\n        strXml += makeChartType(rel.opts.type, rel.data, rel.opts, AXIS_ID_VALUE_PRIMARY, AXIS_ID_CATEGORY_PRIMARY, false);\r\n    }\r\n    // B: Axes -----------------------------------------------------------\r\n    if (rel.opts.type !== CHART_TYPES.PIE && rel.opts.type !== CHART_TYPES.DOUGHNUT) {\r\n        // Param check\r\n        if (rel.opts.valAxes && !usesSecondaryValAxis) {\r\n            throw new Error('Secondary axis must be used by one of the multiple charts');\r\n        }\r\n        if (rel.opts.catAxes) {\r\n            if (!rel.opts.valAxes || rel.opts.valAxes.length !== rel.opts.catAxes.length) {\r\n                throw new Error('There must be the same number of value and category axes.');\r\n            }\r\n            strXml += makeCatAxis(getMix(rel.opts, rel.opts.catAxes[0]), AXIS_ID_CATEGORY_PRIMARY, AXIS_ID_VALUE_PRIMARY);\r\n            if (rel.opts.catAxes[1]) {\r\n                strXml += makeCatAxis(getMix(rel.opts, rel.opts.catAxes[1]), AXIS_ID_CATEGORY_SECONDARY, AXIS_ID_VALUE_PRIMARY);\r\n            }\r\n        }\r\n        else {\r\n            strXml += makeCatAxis(rel.opts, AXIS_ID_CATEGORY_PRIMARY, AXIS_ID_VALUE_PRIMARY);\r\n        }\r\n        if (rel.opts.valAxes) {\r\n            strXml += makeValAxis(getMix(rel.opts, rel.opts.valAxes[0]), AXIS_ID_VALUE_PRIMARY);\r\n            if (rel.opts.valAxes[1]) {\r\n                strXml += makeValAxis(getMix(rel.opts, rel.opts.valAxes[1]), AXIS_ID_VALUE_SECONDARY);\r\n            }\r\n        }\r\n        else {\r\n            strXml += makeValAxis(rel.opts, AXIS_ID_VALUE_PRIMARY);\r\n            // Add series axis for 3D bar\r\n            if (rel.opts.type === CHART_TYPES.BAR3D) {\r\n                strXml += makeSerAxis(rel.opts, AXIS_ID_SERIES_PRIMARY, AXIS_ID_VALUE_PRIMARY);\r\n            }\r\n        }\r\n    }\r\n    // C: Chart Properties and plotArea Options: Border, Data Table, Fill, Legend\r\n    {\r\n        // NOTE: DataTable goes between '</c:valAx>' and '<c:spPr>'\r\n        if (rel.opts.showDataTable) {\r\n            strXml += '<c:dTable>';\r\n            strXml += '  <c:showHorzBorder val=\"' + (rel.opts.showDataTableHorzBorder === false ? 0 : 1) + '\"/>';\r\n            strXml += '  <c:showVertBorder val=\"' + (rel.opts.showDataTableVertBorder === false ? 0 : 1) + '\"/>';\r\n            strXml += '  <c:showOutline    val=\"' + (rel.opts.showDataTableOutline === false ? 0 : 1) + '\"/>';\r\n            strXml += '  <c:showKeys       val=\"' + (rel.opts.showDataTableKeys === false ? 0 : 1) + '\"/>';\r\n            strXml += '  <c:spPr>';\r\n            strXml += '    <a:noFill/>';\r\n            strXml +=\r\n                '    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill><a:round/></a:ln>';\r\n            strXml += '    <a:effectLst/>';\r\n            strXml += '  </c:spPr>';\r\n            strXml += '  <c:txPr>';\r\n            strXml += '\t  <a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"1\"/>';\r\n            strXml += '\t  <a:lstStyle/>';\r\n            strXml += '\t  <a:p>';\r\n            strXml += '\t\t<a:pPr rtl=\"0\">';\r\n            strXml += '\t\t  <a:defRPr sz=\"1197\" b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">';\r\n            strXml += '\t\t\t<a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></a:solidFill>';\r\n            strXml += '\t\t\t<a:latin typeface=\"+mn-lt\"/>';\r\n            strXml += '\t\t\t<a:ea typeface=\"+mn-ea\"/>';\r\n            strXml += '\t\t\t<a:cs typeface=\"+mn-cs\"/>';\r\n            strXml += '\t\t  </a:defRPr>';\r\n            strXml += '\t\t</a:pPr>';\r\n            strXml += '\t\t<a:endParaRPr lang=\"en-US\"/>';\r\n            strXml += '\t  </a:p>';\r\n            strXml += '\t</c:txPr>';\r\n            strXml += '</c:dTable>';\r\n        }\r\n        strXml += '  <c:spPr>';\r\n        // OPTION: Fill\r\n        strXml += rel.opts.fill ? genXmlColorSelection(rel.opts.fill) : '<a:noFill/>';\r\n        // OPTION: Border\r\n        strXml += rel.opts.border ? \"<a:ln w=\\\"\" + rel.opts.border.pt * ONEPT + \"\\\" cap=\\\"flat\\\">\" + genXmlColorSelection(rel.opts.border.color) + \"</a:ln>\" : '<a:ln><a:noFill/></a:ln>';\r\n        // Close shapeProp/plotArea before Legend\r\n        strXml += '    <a:effectLst/>';\r\n        strXml += '  </c:spPr>';\r\n        strXml += '</c:plotArea>';\r\n        // OPTION: Legend\r\n        // IMPORTANT: Dont specify layout to enable auto-fit: PPT does a great job maximizing space with all 4 TRBL locations\r\n        if (rel.opts.showLegend) {\r\n            strXml += '<c:legend>';\r\n            strXml += '<c:legendPos val=\"' + rel.opts.legendPos + '\"/>';\r\n            strXml += '<c:layout/>';\r\n            strXml += '<c:overlay val=\"0\"/>';\r\n            if (rel.opts.legendFontFace || rel.opts.legendFontSize || rel.opts.legendColor) {\r\n                strXml += '<c:txPr>';\r\n                strXml += '  <a:bodyPr/>';\r\n                strXml += '  <a:lstStyle/>';\r\n                strXml += '  <a:p>';\r\n                strXml += '    <a:pPr>';\r\n                strXml += rel.opts.legendFontSize ? '<a:defRPr sz=\"' + Number(rel.opts.legendFontSize) * 100 + '\">' : '<a:defRPr>';\r\n                if (rel.opts.legendColor)\r\n                    strXml += genXmlColorSelection(rel.opts.legendColor);\r\n                if (rel.opts.legendFontFace)\r\n                    strXml += '<a:latin typeface=\"' + rel.opts.legendFontFace + '\"/>';\r\n                if (rel.opts.legendFontFace)\r\n                    strXml += '<a:cs    typeface=\"' + rel.opts.legendFontFace + '\"/>';\r\n                strXml += '      </a:defRPr>';\r\n                strXml += '    </a:pPr>';\r\n                strXml += '    <a:endParaRPr lang=\"en-US\"/>';\r\n                strXml += '  </a:p>';\r\n                strXml += '</c:txPr>';\r\n            }\r\n            strXml += '</c:legend>';\r\n        }\r\n    }\r\n    strXml += '  <c:plotVisOnly val=\"1\"/>';\r\n    strXml += '  <c:dispBlanksAs val=\"' + rel.opts.displayBlanksAs + '\"/>';\r\n    if (rel.opts.type === CHART_TYPES.SCATTER)\r\n        strXml += '<c:showDLblsOverMax val=\"1\"/>';\r\n    strXml += '</c:chart>';\r\n    // D: CHARTSPACE SHAPE PROPS\r\n    strXml += '<c:spPr>';\r\n    strXml += '  <a:noFill/>';\r\n    strXml += '  <a:ln w=\"12700\" cap=\"flat\"><a:noFill/><a:miter lim=\"400000\"/></a:ln>';\r\n    strXml += '  <a:effectLst/>';\r\n    strXml += '</c:spPr>';\r\n    // E: DATA (Add relID)\r\n    strXml += '<c:externalData r:id=\"rId1\"><c:autoUpdate val=\"0\"/></c:externalData>';\r\n    // LAST: chartSpace end\r\n    strXml += '</c:chartSpace>';\r\n    return strXml;\r\n}\r\n/**\r\n * Create XML string for any given chart type\r\n * @example: <c:bubbleChart> or <c:lineChart>\r\n *\r\n * @param {CHART_TYPE_NAMES} `chartType` chart type name\r\n * @param {OptsChartData[]} `data` chart data\r\n * @param {IChartOpts} `opts` chart options\r\n * @param {string} `valAxisId`\r\n * @param {string} `catAxisId`\r\n * @param {boolean} `isMultiTypeChart`\r\n * @return {string} XML\r\n */\r\nfunction makeChartType(chartType, data, opts, valAxisId, catAxisId, isMultiTypeChart) {\r\n    // NOTE: \"Chart Range\" (as shown in \"select Chart Area dialog\") is calculated.\r\n    // ....: Ensure each X/Y Axis/Col has same row height (esp. applicable to XY Scatter where X can often be larger than Y's)\r\n    var strXml = '';\r\n    switch (chartType) {\r\n        case CHART_TYPES.AREA:\r\n        case CHART_TYPES.BAR:\r\n        case CHART_TYPES.BAR3D:\r\n        case CHART_TYPES.LINE:\r\n        case CHART_TYPES.RADAR:\r\n            // 1: Start Chart\r\n            strXml += '<c:' + chartType + 'Chart>';\r\n            if (chartType === CHART_TYPES.BAR || chartType === CHART_TYPES.BAR3D) {\r\n                strXml += '<c:barDir val=\"' + opts.barDir + '\"/>';\r\n                strXml += '<c:grouping val=\"' + opts.barGrouping + '\"/>';\r\n            }\r\n            if (chartType === CHART_TYPES.RADAR) {\r\n                strXml += '<c:radarStyle val=\"' + opts.radarStyle + '\"/>';\r\n            }\r\n            strXml += '<c:varyColors val=\"0\"/>';\r\n            // 2: \"Series\" block for every data row\r\n            /* EX:\r\n                data: [\r\n                 {\r\n                   name: 'Region 1',\r\n                   labels: ['April', 'May', 'June', 'July'],\r\n                   values: [17, 26, 53, 96]\r\n                 },\r\n                 {\r\n                   name: 'Region 2',\r\n                   labels: ['April', 'May', 'June', 'July'],\r\n                   values: [55, 43, 70, 58]\r\n                 }\r\n                ]\r\n            */\r\n            var colorIndex_1 = -1; // Maintain the color index by region\r\n            data.forEach(function (obj) {\r\n                colorIndex_1++;\r\n                var idx = obj.index;\r\n                strXml += '<c:ser>';\r\n                strXml += '  <c:idx val=\"' + idx + '\"/>';\r\n                strXml += '  <c:order val=\"' + idx + '\"/>';\r\n                strXml += '  <c:tx>';\r\n                strXml += '    <c:strRef>';\r\n                strXml += '      <c:f>Sheet1!$' + getExcelColName(idx + 1) + '$1</c:f>';\r\n                strXml += '      <c:strCache><c:ptCount val=\"1\"/><c:pt idx=\"0\"><c:v>' + encodeXmlEntities(obj.name) + '</c:v></c:pt></c:strCache>';\r\n                strXml += '    </c:strRef>';\r\n                strXml += '  </c:tx>';\r\n                strXml += '  <c:invertIfNegative val=\"0\"/>';\r\n                // Fill and Border\r\n                var seriesColor = opts.chartColors ? opts.chartColors[colorIndex_1 % opts.chartColors.length] : null;\r\n                strXml += '  <c:spPr>';\r\n                if (seriesColor === 'transparent') {\r\n                    strXml += '<a:noFill/>';\r\n                }\r\n                else if (opts.chartColorsOpacity) {\r\n                    strXml += '<a:solidFill>' + createColorElement(seriesColor, '<a:alpha val=\"' + opts.chartColorsOpacity + '000\"/>') + '</a:solidFill>';\r\n                }\r\n                else {\r\n                    strXml += '<a:solidFill>' + createColorElement(seriesColor) + '</a:solidFill>';\r\n                }\r\n                if (chartType === CHART_TYPES.LINE) {\r\n                    if (opts.lineSize === 0) {\r\n                        strXml += '<a:ln><a:noFill/></a:ln>';\r\n                    }\r\n                    else {\r\n                        strXml += '<a:ln w=\"' + opts.lineSize * ONEPT + '\" cap=\"flat\"><a:solidFill>' + createColorElement(seriesColor) + '</a:solidFill>';\r\n                        strXml += '<a:prstDash val=\"' + (opts.lineDash || 'solid') + '\"/><a:round/></a:ln>';\r\n                    }\r\n                }\r\n                else if (opts.dataBorder) {\r\n                    strXml +=\r\n                        '<a:ln w=\"' +\r\n                            opts.dataBorder.pt * ONEPT +\r\n                            '\" cap=\"flat\"><a:solidFill>' +\r\n                            createColorElement(opts.dataBorder.color) +\r\n                            '</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n                }\r\n                strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n                strXml += '  </c:spPr>';\r\n                // Data Labels per series\r\n                // [20190117] NOTE: Adding these to RADAR chart causes unrecoverable corruption!\r\n                if (chartType !== CHART_TYPES.RADAR) {\r\n                    strXml += '  <c:dLbls>';\r\n                    strXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>';\r\n                    if (opts.dataLabelBkgrdColors) {\r\n                        strXml += '    <c:spPr>';\r\n                        strXml += '       <a:solidFill>' + createColorElement(seriesColor) + '</a:solidFill>';\r\n                        strXml += '    </c:spPr>';\r\n                    }\r\n                    strXml += '    <c:txPr>';\r\n                    strXml += '      <a:bodyPr/>';\r\n                    strXml += '      <a:lstStyle/>';\r\n                    strXml += '      <a:p><a:pPr>';\r\n                    strXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">';\r\n                    strXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>';\r\n                    strXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>';\r\n                    strXml += '        </a:defRPr>';\r\n                    strXml += '      </a:pPr></a:p>';\r\n                    strXml += '    </c:txPr>';\r\n                    // Setting dLblPos tag for bar3D seems to break the generated chart\r\n                    if (chartType !== CHART_TYPES.AREA && chartType !== CHART_TYPES.BAR3D) {\r\n                        strXml += '<c:dLblPos val=\"' + (opts.dataLabelPosition || 'outEnd') + '\"/>';\r\n                    }\r\n                    strXml += '    <c:showLegendKey val=\"0\"/>';\r\n                    strXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>';\r\n                    strXml += '    <c:showCatName val=\"0\"/>';\r\n                    strXml += '    <c:showSerName val=\"0\"/>';\r\n                    strXml += '    <c:showPercent val=\"0\"/>';\r\n                    strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n                    strXml += '    <c:showLeaderLines val=\"0\"/>';\r\n                    strXml += '  </c:dLbls>';\r\n                }\r\n                // 'c:marker' tag: `lineDataSymbol`\r\n                if (chartType === CHART_TYPES.LINE || chartType === CHART_TYPES.RADAR) {\r\n                    strXml += '<c:marker>';\r\n                    strXml += '  <c:symbol val=\"' + opts.lineDataSymbol + '\"/>';\r\n                    if (opts.lineDataSymbolSize) {\r\n                        // Defaults to \"auto\" otherwise (but this is usually too small, so there is a default)\r\n                        strXml += '  <c:size val=\"' + opts.lineDataSymbolSize + '\"/>';\r\n                    }\r\n                    strXml += '  <c:spPr>';\r\n                    strXml +=\r\n                        '    <a:solidFill>' +\r\n                            createColorElement(opts.chartColors[idx + 1 > opts.chartColors.length ? Math.floor(Math.random() * opts.chartColors.length) : idx]) +\r\n                            '</a:solidFill>';\r\n                    strXml +=\r\n                        '    <a:ln w=\"' +\r\n                            opts.lineDataSymbolLineSize +\r\n                            '\" cap=\"flat\"><a:solidFill>' +\r\n                            createColorElement(opts.lineDataSymbolLineColor || seriesColor) +\r\n                            '</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n                    strXml += '    <a:effectLst/>';\r\n                    strXml += '  </c:spPr>';\r\n                    strXml += '</c:marker>';\r\n                }\r\n                // Color chart bars various colors\r\n                // Allow users with a single data set to pass their own array of colors (check for this using != ours)\r\n                if ((chartType === CHART_TYPES.BAR || chartType === CHART_TYPES.BAR3D) && (data.length === 1 || opts.valueBarColors) && opts.chartColors !== BARCHART_COLORS) {\r\n                    // Series Data Point colors\r\n                    obj.values.forEach(function (value, index) {\r\n                        var arrColors = value < 0 ? opts.invertedColors || BARCHART_COLORS : opts.chartColors || [];\r\n                        strXml += '  <c:dPt>';\r\n                        strXml += '    <c:idx val=\"' + index + '\"/>';\r\n                        strXml += '      <c:invertIfNegative val=\"' + (opts.invertedColors ? 0 : 1) + '\"/>';\r\n                        strXml += '    <c:bubble3D val=\"0\"/>';\r\n                        strXml += '    <c:spPr>';\r\n                        if (opts.lineSize === 0) {\r\n                            strXml += '<a:ln><a:noFill/></a:ln>';\r\n                        }\r\n                        else if (chartType === CHART_TYPES.BAR) {\r\n                            strXml += '<a:solidFill>';\r\n                            strXml += '  <a:srgbClr val=\"' + arrColors[index % arrColors.length] + '\"/>';\r\n                            strXml += '</a:solidFill>';\r\n                        }\r\n                        else {\r\n                            strXml += '<a:ln>';\r\n                            strXml += '  <a:solidFill>';\r\n                            strXml += '   <a:srgbClr val=\"' + arrColors[index % arrColors.length] + '\"/>';\r\n                            strXml += '  </a:solidFill>';\r\n                            strXml += '</a:ln>';\r\n                        }\r\n                        strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n                        strXml += '    </c:spPr>';\r\n                        strXml += '  </c:dPt>';\r\n                    });\r\n                }\r\n                // 2: \"Categories\"\r\n                {\r\n                    strXml += '<c:cat>';\r\n                    if (opts.catLabelFormatCode) {\r\n                        // Use 'numRef' as catLabelFormatCode implies that we are expecting numbers here\r\n                        strXml += '  <c:numRef>';\r\n                        strXml += '    <c:f>Sheet1!$A$2:$A$' + (obj.labels.length + 1) + '</c:f>';\r\n                        strXml += '    <c:numCache>';\r\n                        strXml += '      <c:formatCode>' + opts.catLabelFormatCode + '</c:formatCode>';\r\n                        strXml += '      <c:ptCount val=\"' + obj.labels.length + '\"/>';\r\n                        obj.labels.forEach(function (label, idx) {\r\n                            strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + encodeXmlEntities(label) + '</c:v></c:pt>';\r\n                        });\r\n                        strXml += '    </c:numCache>';\r\n                        strXml += '  </c:numRef>';\r\n                    }\r\n                    else {\r\n                        strXml += '  <c:strRef>';\r\n                        strXml += '    <c:f>Sheet1!$A$2:$A$' + (obj.labels.length + 1) + '</c:f>';\r\n                        strXml += '    <c:strCache>';\r\n                        strXml += '\t     <c:ptCount val=\"' + obj.labels.length + '\"/>';\r\n                        obj.labels.forEach(function (label, idx) {\r\n                            strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + encodeXmlEntities(label) + '</c:v></c:pt>';\r\n                        });\r\n                        strXml += '    </c:strCache>';\r\n                        strXml += '  </c:strRef>';\r\n                    }\r\n                    strXml += '</c:cat>';\r\n                }\r\n                // 3: \"Values\"\r\n                {\r\n                    strXml += '  <c:val>';\r\n                    strXml += '    <c:numRef>';\r\n                    strXml += '      <c:f>Sheet1!$' + getExcelColName(idx + 1) + '$2:$' + getExcelColName(idx + 1) + '$' + (obj.labels.length + 1) + '</c:f>';\r\n                    strXml += '      <c:numCache>';\r\n                    strXml += '        <c:formatCode>General</c:formatCode>';\r\n                    strXml += '\t       <c:ptCount val=\"' + obj.labels.length + '\"/>';\r\n                    obj.values.forEach(function (value, idx) {\r\n                        strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || value === 0 ? value : '') + '</c:v></c:pt>';\r\n                    });\r\n                    strXml += '      </c:numCache>';\r\n                    strXml += '    </c:numRef>';\r\n                    strXml += '  </c:val>';\r\n                }\r\n                // Option: `smooth`\r\n                if (chartType === CHART_TYPES.LINE)\r\n                    strXml += '<c:smooth val=\"' + (opts.lineSmooth ? '1' : '0') + '\"/>';\r\n                // 4: Close \"SERIES\"\r\n                strXml += '</c:ser>';\r\n            });\r\n            // 3: \"Data Labels\"\r\n            {\r\n                strXml += '  <c:dLbls>';\r\n                strXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>';\r\n                strXml += '    <c:txPr>';\r\n                strXml += '      <a:bodyPr/>';\r\n                strXml += '      <a:lstStyle/>';\r\n                strXml += '      <a:p><a:pPr>';\r\n                strXml +=\r\n                    '        <a:defRPr b=\"' + (opts.dataLabelFontBold ? 1 : 0) + '\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">';\r\n                strXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>';\r\n                strXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>';\r\n                strXml += '        </a:defRPr>';\r\n                strXml += '      </a:pPr></a:p>';\r\n                strXml += '    </c:txPr>';\r\n                // NOTE: Throwing an error while creating a multi type chart which contains area chart as the below line appears for the other chart type.\r\n                // Either the given change can be made or the below line can be removed to stop the slide containing multi type chart with area to crash.\r\n                if (opts.type !== CHART_TYPES.AREA && opts.type !== CHART_TYPES.RADAR && !isMultiTypeChart)\r\n                    strXml += '<c:dLblPos val=\"' + (opts.dataLabelPosition || 'outEnd') + '\"/>';\r\n                strXml += '    <c:showLegendKey val=\"0\"/>';\r\n                strXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>';\r\n                strXml += '    <c:showCatName val=\"0\"/>';\r\n                strXml += '    <c:showSerName val=\"0\"/>';\r\n                strXml += '    <c:showPercent val=\"0\"/>';\r\n                strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n                strXml += '    <c:showLeaderLines val=\"0\"/>';\r\n                strXml += '  </c:dLbls>';\r\n            }\r\n            // 4: Add more chart options (gapWidth, line Marker, etc.)\r\n            if (chartType === CHART_TYPES.BAR) {\r\n                strXml += '  <c:gapWidth val=\"' + opts.barGapWidthPct + '\"/>';\r\n                strXml += '  <c:overlap val=\"' + ((opts.barGrouping || '').indexOf('tacked') > -1 ? 100 : 0) + '\"/>';\r\n            }\r\n            else if (chartType === CHART_TYPES.BAR3D) {\r\n                strXml += '  <c:gapWidth val=\"' + opts.barGapWidthPct + '\"/>';\r\n                strXml += '  <c:gapDepth val=\"' + opts.barGapDepthPct + '\"/>';\r\n                strXml += '  <c:shape val=\"' + opts.bar3DShape + '\"/>';\r\n            }\r\n            else if (chartType === CHART_TYPES.LINE) {\r\n                strXml += '  <c:marker val=\"1\"/>';\r\n            }\r\n            // 5: Add axisId (NOTE: order matters! (category comes first))\r\n            strXml += '  <c:axId val=\"' + catAxisId + '\"/>';\r\n            strXml += '  <c:axId val=\"' + valAxisId + '\"/>';\r\n            strXml += '  <c:axId val=\"' + AXIS_ID_SERIES_PRIMARY + '\"/>';\r\n            // 6: Close Chart tag\r\n            strXml += '</c:' + chartType + 'Chart>';\r\n            // end switch\r\n            break;\r\n        case CHART_TYPES.SCATTER:\r\n            /*\r\n                `data` = [\r\n                    { name:'X-Axis',    values:[1,2,3,4,5,6,7,8,9,10,11,12] },\r\n                    { name:'Y-Value 1', values:[13, 20, 21, 25] },\r\n                    { name:'Y-Value 2', values:[ 1,  2,  5,  9] }\r\n                ];\r\n            */\r\n            // 1: Start Chart\r\n            strXml += '<c:' + chartType + 'Chart>';\r\n            strXml += '<c:scatterStyle val=\"lineMarker\"/>';\r\n            strXml += '<c:varyColors val=\"0\"/>';\r\n            // 2: Series: (One for each Y-Axis)\r\n            colorIndex_1 = -1;\r\n            data.filter(function (_obj, idx) { return idx > 0; }).forEach(function (obj, idx) {\r\n                colorIndex_1++;\r\n                strXml += '<c:ser>';\r\n                strXml += '  <c:idx val=\"' + idx + '\"/>';\r\n                strXml += '  <c:order val=\"' + idx + '\"/>';\r\n                strXml += '  <c:tx>';\r\n                strXml += '    <c:strRef>';\r\n                strXml += '      <c:f>Sheet1!$' + LETTERS[idx + 1] + '$1</c:f>';\r\n                strXml += '      <c:strCache><c:ptCount val=\"1\"/><c:pt idx=\"0\"><c:v>' + obj.name + '</c:v></c:pt></c:strCache>';\r\n                strXml += '    </c:strRef>';\r\n                strXml += '  </c:tx>';\r\n                // 'c:spPr': Fill, Border, Line, LineStyle (dash, etc.), Shadow\r\n                strXml += '  <c:spPr>';\r\n                {\r\n                    var tmpSerColor = opts.chartColors[colorIndex_1 % opts.chartColors.length];\r\n                    if (tmpSerColor === 'transparent') {\r\n                        strXml += '<a:noFill/>';\r\n                    }\r\n                    else if (opts.chartColorsOpacity) {\r\n                        strXml += '<a:solidFill>' + createColorElement(tmpSerColor, '<a:alpha val=\"' + opts.chartColorsOpacity + '000\"/>') + '</a:solidFill>';\r\n                    }\r\n                    else {\r\n                        strXml += '<a:solidFill>' + createColorElement(tmpSerColor) + '</a:solidFill>';\r\n                    }\r\n                    if (opts.lineSize === 0) {\r\n                        strXml += '<a:ln><a:noFill/></a:ln>';\r\n                    }\r\n                    else {\r\n                        strXml += '<a:ln w=\"' + opts.lineSize * ONEPT + '\" cap=\"flat\"><a:solidFill>' + createColorElement(tmpSerColor) + '</a:solidFill>';\r\n                        strXml += '<a:prstDash val=\"' + (opts.lineDash || 'solid') + '\"/><a:round/></a:ln>';\r\n                    }\r\n                    // Shadow\r\n                    strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n                }\r\n                strXml += '  </c:spPr>';\r\n                // 'c:marker' tag: `lineDataSymbol`\r\n                {\r\n                    strXml += '<c:marker>';\r\n                    strXml += '  <c:symbol val=\"' + opts.lineDataSymbol + '\"/>';\r\n                    if (opts.lineDataSymbolSize) {\r\n                        // Defaults to \"auto\" otherwise (but this is usually too small, so there is a default)\r\n                        strXml += '  <c:size val=\"' + opts.lineDataSymbolSize + '\"/>';\r\n                    }\r\n                    strXml += '  <c:spPr>';\r\n                    strXml +=\r\n                        '    <a:solidFill>' +\r\n                            createColorElement(opts.chartColors[idx + 1 > opts.chartColors.length ? Math.floor(Math.random() * opts.chartColors.length) : idx]) +\r\n                            '</a:solidFill>';\r\n                    strXml +=\r\n                        '    <a:ln w=\"' +\r\n                            opts.lineDataSymbolLineSize +\r\n                            '\" cap=\"flat\"><a:solidFill>' +\r\n                            createColorElement(opts.lineDataSymbolLineColor || opts.chartColors[colorIndex_1 % opts.chartColors.length]) +\r\n                            '</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n                    strXml += '    <a:effectLst/>';\r\n                    strXml += '  </c:spPr>';\r\n                    strXml += '</c:marker>';\r\n                }\r\n                // Option: scatter data point labels\r\n                if (opts.showLabel) {\r\n                    var chartUuid_1 = getUuid('-xxxx-xxxx-xxxx-xxxxxxxxxxxx');\r\n                    if (obj.labels && (opts.dataLabelFormatScatter === 'custom' || opts.dataLabelFormatScatter === 'customXY')) {\r\n                        strXml += '<c:dLbls>';\r\n                        obj.labels.forEach(function (label, idx) {\r\n                            if (opts.dataLabelFormatScatter === 'custom' || opts.dataLabelFormatScatter === 'customXY') {\r\n                                strXml += '  <c:dLbl>';\r\n                                strXml += '    <c:idx val=\"' + idx + '\"/>';\r\n                                strXml += '    <c:tx>';\r\n                                strXml += '      <c:rich>';\r\n                                strXml += '\t\t\t<a:bodyPr>';\r\n                                strXml += '\t\t\t\t<a:spAutoFit/>';\r\n                                strXml += '\t\t\t</a:bodyPr>';\r\n                                strXml += '        \t<a:lstStyle/>';\r\n                                strXml += '        \t<a:p>';\r\n                                strXml += '\t\t\t\t<a:pPr>';\r\n                                strXml += '\t\t\t\t\t<a:defRPr/>';\r\n                                strXml += '\t\t\t\t</a:pPr>';\r\n                                strXml += '          \t<a:r>';\r\n                                strXml += '            \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" dirty=\"0\"/>';\r\n                                strXml += '            \t\t<a:t>' + encodeXmlEntities(label) + '</a:t>';\r\n                                strXml += '          \t</a:r>';\r\n                                // Apply XY values at end of custom label\r\n                                // Do not apply the values if the label was empty or just spaces\r\n                                // This allows for selective labelling where required\r\n                                if (opts.dataLabelFormatScatter === 'customXY' && !/^ *$/.test(label)) {\r\n                                    strXml += '          \t<a:r>';\r\n                                    strXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\" dirty=\"0\"/>';\r\n                                    strXml += '          \t\t<a:t> (</a:t>';\r\n                                    strXml += '          \t</a:r>';\r\n                                    strXml += '          \t<a:fld id=\"{' + getUuid('xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx') + '}\" type=\"XVALUE\">';\r\n                                    strXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\"/>';\r\n                                    strXml += '          \t\t<a:pPr>';\r\n                                    strXml += '          \t\t\t<a:defRPr/>';\r\n                                    strXml += '          \t\t</a:pPr>';\r\n                                    strXml += '          \t\t<a:t>[' + encodeXmlEntities(obj.name) + '</a:t>';\r\n                                    strXml += '          \t</a:fld>';\r\n                                    strXml += '          \t<a:r>';\r\n                                    strXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\" dirty=\"0\"/>';\r\n                                    strXml += '          \t\t<a:t>, </a:t>';\r\n                                    strXml += '          \t</a:r>';\r\n                                    strXml += '          \t<a:fld id=\"{' + getUuid('xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx') + '}\" type=\"YVALUE\">';\r\n                                    strXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\"/>';\r\n                                    strXml += '          \t\t<a:pPr>';\r\n                                    strXml += '          \t\t\t<a:defRPr/>';\r\n                                    strXml += '          \t\t</a:pPr>';\r\n                                    strXml += '          \t\t<a:t>[' + encodeXmlEntities(obj.name) + ']</a:t>';\r\n                                    strXml += '          \t</a:fld>';\r\n                                    strXml += '          \t<a:r>';\r\n                                    strXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\" dirty=\"0\"/>';\r\n                                    strXml += '          \t\t<a:t>)</a:t>';\r\n                                    strXml += '          \t</a:r>';\r\n                                    strXml += '          \t<a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\" dirty=\"0\"/>';\r\n                                }\r\n                                strXml += '        \t</a:p>';\r\n                                strXml += '      </c:rich>';\r\n                                strXml += '    </c:tx>';\r\n                                strXml += '    <c:spPr>';\r\n                                strXml += '    \t<a:noFill/>';\r\n                                strXml += '    \t<a:ln>';\r\n                                strXml += '    \t\t<a:noFill/>';\r\n                                strXml += '    \t</a:ln>';\r\n                                strXml += '    \t<a:effectLst/>';\r\n                                strXml += '    </c:spPr>';\r\n                                strXml += '    <c:showLegendKey val=\"0\"/>';\r\n                                strXml += '    <c:showVal val=\"0\"/>';\r\n                                strXml += '    <c:showCatName val=\"0\"/>';\r\n                                strXml += '    <c:showSerName val=\"0\"/>';\r\n                                strXml += '    <c:showPercent val=\"0\"/>';\r\n                                strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n                                strXml += '\t  <c:showLeaderLines val=\"1\"/>';\r\n                                strXml += '    <c:extLst>';\r\n                                strXml += '      <c:ext uri=\"{CE6537A1-D6FC-4f65-9D91-7224C49458BB}\" xmlns:c15=\"http://schemas.microsoft.com/office/drawing/2012/chart\">';\r\n                                strXml += '\t\t\t<c15:dlblFieldTable/>';\r\n                                strXml += '\t\t\t<c15:showDataLabelsRange val=\"0\"/>';\r\n                                strXml += '\t\t</c:ext>';\r\n                                strXml += '      <c:ext uri=\"{C3380CC4-5D6E-409C-BE32-E72D297353CC}\" xmlns:c16=\"http://schemas.microsoft.com/office/drawing/2014/chart\">';\r\n                                strXml += '\t\t\t<c16:uniqueId val=\"{' + '00000000'.substring(0, 8 - (idx + 1).toString().length).toString() + (idx + 1) + chartUuid_1 + '}\"/>';\r\n                                strXml += '      </c:ext>';\r\n                                strXml += '\t\t</c:extLst>';\r\n                                strXml += '</c:dLbl>';\r\n                            }\r\n                        });\r\n                        strXml += '</c:dLbls>';\r\n                    }\r\n                    if (opts.dataLabelFormatScatter === 'XY') {\r\n                        strXml += '<c:dLbls>';\r\n                        strXml += '\t<c:spPr>';\r\n                        strXml += '\t\t<a:noFill/>';\r\n                        strXml += '\t\t<a:ln>';\r\n                        strXml += '\t\t\t<a:noFill/>';\r\n                        strXml += '\t\t</a:ln>';\r\n                        strXml += '\t  \t<a:effectLst/>';\r\n                        strXml += '\t</c:spPr>';\r\n                        strXml += '\t<c:txPr>';\r\n                        strXml += '\t\t<a:bodyPr>';\r\n                        strXml += '\t\t\t<a:spAutoFit/>';\r\n                        strXml += '\t\t</a:bodyPr>';\r\n                        strXml += '\t\t<a:lstStyle/>';\r\n                        strXml += '\t\t<a:p>';\r\n                        strXml += '\t    \t<a:pPr>';\r\n                        strXml += '        \t\t<a:defRPr/>';\r\n                        strXml += '\t    \t</a:pPr>';\r\n                        strXml += '\t    \t<a:endParaRPr lang=\"en-US\"/>';\r\n                        strXml += '\t\t</a:p>';\r\n                        strXml += '\t</c:txPr>';\r\n                        strXml += '\t<c:showLegendKey val=\"0\"/>';\r\n                        strXml += \" <c:showVal val=\\\"\" + (opts.showLabel ? '1' : '0') + \"\\\"/>\";\r\n                        strXml += \" <c:showCatName val=\\\"\" + (opts.showLabel ? '1' : '0') + \"\\\"/>\";\r\n                        strXml += '\t<c:showSerName val=\"0\"/>';\r\n                        strXml += '\t<c:showPercent val=\"0\"/>';\r\n                        strXml += '\t<c:showBubbleSize val=\"0\"/>';\r\n                        strXml += '\t<c:extLst>';\r\n                        strXml += '\t\t<c:ext uri=\"{CE6537A1-D6FC-4f65-9D91-7224C49458BB}\" xmlns:c15=\"http://schemas.microsoft.com/office/drawing/2012/chart\">';\r\n                        strXml += '\t\t\t<c15:showLeaderLines val=\"1\"/>';\r\n                        strXml += '\t\t</c:ext>';\r\n                        strXml += '\t</c:extLst>';\r\n                        strXml += '</c:dLbls>';\r\n                    }\r\n                }\r\n                // Color bar chart bars various colors\r\n                // Allow users with a single data set to pass their own array of colors (check for this using != ours)\r\n                if ((data.length === 1 || opts.valueBarColors) && opts.chartColors !== BARCHART_COLORS) {\r\n                    // Series Data Point colors\r\n                    obj.values.forEach(function (value, index) {\r\n                        var arrColors = value < 0 ? opts.invertedColors || BARCHART_COLORS : opts.chartColors || [];\r\n                        strXml += '  <c:dPt>';\r\n                        strXml += '    <c:idx val=\"' + index + '\"/>';\r\n                        strXml += '      <c:invertIfNegative val=\"' + (opts.invertedColors ? 0 : 1) + '\"/>';\r\n                        strXml += '    <c:bubble3D val=\"0\"/>';\r\n                        strXml += '    <c:spPr>';\r\n                        if (opts.lineSize === 0) {\r\n                            strXml += '<a:ln><a:noFill/></a:ln>';\r\n                        }\r\n                        else {\r\n                            strXml += '<a:solidFill>';\r\n                            strXml += ' <a:srgbClr val=\"' + arrColors[index % arrColors.length] + '\"/>';\r\n                            strXml += '</a:solidFill>';\r\n                        }\r\n                        strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n                        strXml += '    </c:spPr>';\r\n                        strXml += '  </c:dPt>';\r\n                    });\r\n                }\r\n                // 3: \"Values\": Scatter Chart has 2: `xVal` and `yVal`\r\n                {\r\n                    // X-Axis is always the same\r\n                    strXml += '<c:xVal>';\r\n                    strXml += '  <c:numRef>';\r\n                    strXml += '    <c:f>Sheet1!$A$2:$A$' + (data[0].values.length + 1) + '</c:f>';\r\n                    strXml += '    <c:numCache>';\r\n                    strXml += '      <c:formatCode>General</c:formatCode>';\r\n                    strXml += '      <c:ptCount val=\"' + data[0].values.length + '\"/>';\r\n                    data[0].values.forEach(function (value, idx) {\r\n                        strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || value === 0 ? value : '') + '</c:v></c:pt>';\r\n                    });\r\n                    strXml += '    </c:numCache>';\r\n                    strXml += '  </c:numRef>';\r\n                    strXml += '</c:xVal>';\r\n                    // Y-Axis vals are this object's `values`\r\n                    strXml += '<c:yVal>';\r\n                    strXml += '  <c:numRef>';\r\n                    strXml += '    <c:f>Sheet1!$' + getExcelColName(idx + 1) + '$2:$' + getExcelColName(idx + 1) + '$' + (data[0].values.length + 1) + '</c:f>';\r\n                    strXml += '    <c:numCache>';\r\n                    strXml += '      <c:formatCode>General</c:formatCode>';\r\n                    // NOTE: Use pt count and iterate over data[0] (X-Axis) as user can have more values than data (eg: timeline where only first few months are populated)\r\n                    strXml += '      <c:ptCount val=\"' + data[0].values.length + '\"/>';\r\n                    data[0].values.forEach(function (_value, idx) {\r\n                        strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (obj.values[idx] || obj.values[idx] === 0 ? obj.values[idx] : '') + '</c:v></c:pt>';\r\n                    });\r\n                    strXml += '    </c:numCache>';\r\n                    strXml += '  </c:numRef>';\r\n                    strXml += '</c:yVal>';\r\n                }\r\n                // Option: `smooth`\r\n                strXml += '<c:smooth val=\"' + (opts.lineSmooth ? '1' : '0') + '\"/>';\r\n                // 4: Close \"SERIES\"\r\n                strXml += '</c:ser>';\r\n            });\r\n            // 3: Data Labels\r\n            {\r\n                strXml += '  <c:dLbls>';\r\n                strXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>';\r\n                strXml += '    <c:txPr>';\r\n                strXml += '      <a:bodyPr/>';\r\n                strXml += '      <a:lstStyle/>';\r\n                strXml += '      <a:p><a:pPr>';\r\n                strXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">';\r\n                strXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>';\r\n                strXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>';\r\n                strXml += '        </a:defRPr>';\r\n                strXml += '      </a:pPr></a:p>';\r\n                strXml += '    </c:txPr>';\r\n                strXml += '    <c:dLblPos val=\"' + (opts.dataLabelPosition || 'outEnd') + '\"/>';\r\n                strXml += '    <c:showLegendKey val=\"0\"/>';\r\n                strXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>';\r\n                strXml += '    <c:showCatName val=\"0\"/>';\r\n                strXml += '    <c:showSerName val=\"0\"/>';\r\n                strXml += '    <c:showPercent val=\"0\"/>';\r\n                strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n                strXml += '  </c:dLbls>';\r\n            }\r\n            // 4: Add axisId (NOTE: order matters! (category comes first))\r\n            strXml += '  <c:axId val=\"' + catAxisId + '\"/>';\r\n            strXml += '  <c:axId val=\"' + valAxisId + '\"/>';\r\n            // 5: Close Chart tag\r\n            strXml += '</c:' + chartType + 'Chart>';\r\n            // end switch\r\n            break;\r\n        case CHART_TYPES.BUBBLE:\r\n            /*\r\n                `data` = [\r\n                    { name:'X-Axis',     values:[1,2,3,4,5,6,7,8,9,10,11,12] },\r\n                    { name:'Y-Values 1', values:[13, 20, 21, 25], sizes:[10, 5, 20, 15] },\r\n                    { name:'Y-Values 2', values:[ 1,  2,  5,  9], sizes:[ 5, 3,  9,  3] }\r\n                ];\r\n            */\r\n            // 1: Start Chart\r\n            strXml += '<c:' + chartType + 'Chart>';\r\n            strXml += '<c:varyColors val=\"0\"/>';\r\n            // 2: Series: (One for each Y-Axis)\r\n            colorIndex_1 = -1;\r\n            var idxColLtr_1 = 1;\r\n            data.filter(function (_obj, idx) { return idx > 0; }).forEach(function (obj, idx) {\r\n                colorIndex_1++;\r\n                strXml += '<c:ser>';\r\n                strXml += '  <c:idx val=\"' + idx + '\"/>';\r\n                strXml += '  <c:order val=\"' + idx + '\"/>';\r\n                // A: `<c:tx>`\r\n                strXml += '  <c:tx>';\r\n                strXml += '    <c:strRef>';\r\n                strXml += '      <c:f>Sheet1!$' + LETTERS[idxColLtr_1] + '$1</c:f>';\r\n                strXml += '      <c:strCache><c:ptCount val=\"1\"/><c:pt idx=\"0\"><c:v>' + obj.name + '</c:v></c:pt></c:strCache>';\r\n                strXml += '    </c:strRef>';\r\n                strXml += '  </c:tx>';\r\n                // B: '<c:spPr>': Fill, Border, Line, LineStyle (dash, etc.), Shadow\r\n                {\r\n                    strXml += '<c:spPr>';\r\n                    var tmpSerColor = opts.chartColors[colorIndex_1 % opts.chartColors.length];\r\n                    if (tmpSerColor === 'transparent') {\r\n                        strXml += '<a:noFill/>';\r\n                    }\r\n                    else if (opts.chartColorsOpacity) {\r\n                        strXml += '<a:solidFill>' + createColorElement(tmpSerColor, '<a:alpha val=\"' + opts.chartColorsOpacity + '000\"/>') + '</a:solidFill>';\r\n                    }\r\n                    else {\r\n                        strXml += '<a:solidFill>' + createColorElement(tmpSerColor) + '</a:solidFill>';\r\n                    }\r\n                    if (opts.lineSize === 0) {\r\n                        strXml += '<a:ln><a:noFill/></a:ln>';\r\n                    }\r\n                    else if (opts.dataBorder) {\r\n                        strXml +=\r\n                            '<a:ln w=\"' +\r\n                                opts.dataBorder.pt * ONEPT +\r\n                                '\" cap=\"flat\"><a:solidFill>' +\r\n                                createColorElement(opts.dataBorder.color) +\r\n                                '</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n                    }\r\n                    else {\r\n                        strXml += '<a:ln w=\"' + opts.lineSize * ONEPT + '\" cap=\"flat\"><a:solidFill>' + createColorElement(tmpSerColor) + '</a:solidFill>';\r\n                        strXml += '<a:prstDash val=\"' + (opts.lineDash || 'solid') + '\"/><a:round/></a:ln>';\r\n                    }\r\n                    // Shadow\r\n                    strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n                    strXml += '</c:spPr>';\r\n                }\r\n                // C: '<c:dLbls>' \"Data Labels\"\r\n                // Let it be defaulted for now\r\n                // D: '<c:xVal>'/'<c:yVal>' \"Values\": Scatter Chart has 2: `xVal` and `yVal`\r\n                {\r\n                    // X-Axis is always the same\r\n                    strXml += '<c:xVal>';\r\n                    strXml += '  <c:numRef>';\r\n                    strXml += '    <c:f>Sheet1!$A$2:$A$' + (data[0].values.length + 1) + '</c:f>';\r\n                    strXml += '    <c:numCache>';\r\n                    strXml += '      <c:formatCode>General</c:formatCode>';\r\n                    strXml += '      <c:ptCount val=\"' + data[0].values.length + '\"/>';\r\n                    data[0].values.forEach(function (value, idx) {\r\n                        strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || value === 0 ? value : '') + '</c:v></c:pt>';\r\n                    });\r\n                    strXml += '    </c:numCache>';\r\n                    strXml += '  </c:numRef>';\r\n                    strXml += '</c:xVal>';\r\n                    // Y-Axis vals are this object's `values`\r\n                    strXml += '<c:yVal>';\r\n                    strXml += '  <c:numRef>';\r\n                    strXml += '    <c:f>Sheet1!$' + getExcelColName(idxColLtr_1) + '$2:$' + getExcelColName(idxColLtr_1) + '$' + (data[0].values.length + 1) + '</c:f>';\r\n                    idxColLtr_1++;\r\n                    strXml += '    <c:numCache>';\r\n                    strXml += '      <c:formatCode>General</c:formatCode>';\r\n                    // NOTE: Use pt count and iterate over data[0] (X-Axis) as user can have more values than data (eg: timeline where only first few months are populated)\r\n                    strXml += '      <c:ptCount val=\"' + data[0].values.length + '\"/>';\r\n                    data[0].values.forEach(function (_value, idx) {\r\n                        strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (obj.values[idx] || obj.values[idx] === 0 ? obj.values[idx] : '') + '</c:v></c:pt>';\r\n                    });\r\n                    strXml += '    </c:numCache>';\r\n                    strXml += '  </c:numRef>';\r\n                    strXml += '</c:yVal>';\r\n                }\r\n                // E: '<c:bubbleSize>'\r\n                strXml += '  <c:bubbleSize>';\r\n                strXml += '    <c:numRef>';\r\n                strXml += '      <c:f>Sheet1!$' + getExcelColName(idxColLtr_1) + '$2:$' + getExcelColName(idx + 2) + '$' + (obj.sizes.length + 1) + '</c:f>';\r\n                idxColLtr_1++;\r\n                strXml += '      <c:numCache>';\r\n                strXml += '        <c:formatCode>General</c:formatCode>';\r\n                strXml += '\t       <c:ptCount val=\"' + obj.sizes.length + '\"/>';\r\n                obj.sizes.forEach(function (value, idx) {\r\n                    strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || '') + '</c:v></c:pt>';\r\n                });\r\n                strXml += '      </c:numCache>';\r\n                strXml += '    </c:numRef>';\r\n                strXml += '  </c:bubbleSize>';\r\n                strXml += '  <c:bubble3D val=\"0\"/>';\r\n                // F: Close \"SERIES\"\r\n                strXml += '</c:ser>';\r\n            });\r\n            // 3: Data Labels\r\n            {\r\n                strXml += '  <c:dLbls>';\r\n                strXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>';\r\n                strXml += '    <c:txPr>';\r\n                strXml += '      <a:bodyPr/>';\r\n                strXml += '      <a:lstStyle/>';\r\n                strXml += '      <a:p><a:pPr>';\r\n                strXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">';\r\n                strXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>';\r\n                strXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>';\r\n                strXml += '        </a:defRPr>';\r\n                strXml += '      </a:pPr></a:p>';\r\n                strXml += '    </c:txPr>';\r\n                strXml += '    <c:dLblPos val=\"ctr\"/>';\r\n                strXml += '    <c:showLegendKey val=\"0\"/>';\r\n                strXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>';\r\n                strXml += '    <c:showCatName val=\"0\"/>';\r\n                strXml += '    <c:showSerName val=\"0\"/>';\r\n                strXml += '    <c:showPercent val=\"0\"/>';\r\n                strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n                strXml += '  </c:dLbls>';\r\n            }\r\n            // 4: Add bubble options\r\n            //strXml += '  <c:bubbleScale val=\"100\"/>';\r\n            //strXml += '  <c:showNegBubbles val=\"0\"/>';\r\n            // Commented out to let it default to PPT until we create options\r\n            // 5: Add axisId (NOTE: order matters! (category comes first))\r\n            strXml += '  <c:axId val=\"' + catAxisId + '\"/>';\r\n            strXml += '  <c:axId val=\"' + valAxisId + '\"/>';\r\n            // 6: Close Chart tag\r\n            strXml += '</c:' + chartType + 'Chart>';\r\n            // end switch\r\n            break;\r\n        case CHART_TYPES.DOUGHNUT:\r\n        case CHART_TYPES.PIE:\r\n            // Use the same let name so code blocks from barChart are interchangeable\r\n            var obj = data[0];\r\n            /* EX:\r\n                data: [\r\n                 {\r\n                   name: 'Project Status',\r\n                   labels: ['Red', 'Amber', 'Green', 'Unknown'],\r\n                   values: [10, 20, 38, 2]\r\n                 }\r\n                ]\r\n            */\r\n            // 1: Start Chart\r\n            strXml += '<c:' + chartType + 'Chart>';\r\n            strXml += '  <c:varyColors val=\"0\"/>';\r\n            strXml += '<c:ser>';\r\n            strXml += '  <c:idx val=\"0\"/>';\r\n            strXml += '  <c:order val=\"0\"/>';\r\n            strXml += '  <c:tx>';\r\n            strXml += '    <c:strRef>';\r\n            strXml += '      <c:f>Sheet1!$B$1</c:f>';\r\n            strXml += '      <c:strCache>';\r\n            strXml += '        <c:ptCount val=\"1\"/>';\r\n            strXml += '        <c:pt idx=\"0\"><c:v>' + encodeXmlEntities(obj.name) + '</c:v></c:pt>';\r\n            strXml += '      </c:strCache>';\r\n            strXml += '    </c:strRef>';\r\n            strXml += '  </c:tx>';\r\n            strXml += '  <c:spPr>';\r\n            strXml += '    <a:solidFill><a:schemeClr val=\"accent1\"/></a:solidFill>';\r\n            strXml += '    <a:ln w=\"9525\" cap=\"flat\"><a:solidFill><a:srgbClr val=\"F9F9F9\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n            if (opts.dataNoEffects) {\r\n                strXml += '<a:effectLst/>';\r\n            }\r\n            else {\r\n                strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n            }\r\n            strXml += '  </c:spPr>';\r\n            strXml += '<c:explosion val=\"0\"/>';\r\n            // 2: \"Data Point\" block for every data row\r\n            obj.labels.forEach(function (_label, idx) {\r\n                strXml += '<c:dPt>';\r\n                strXml += '  <c:idx val=\"' + idx + '\"/>';\r\n                strXml += '  <c:explosion val=\"0\"/>';\r\n                strXml += '  <c:spPr>';\r\n                strXml +=\r\n                    '    <a:solidFill>' +\r\n                        createColorElement(opts.chartColors[idx + 1 > opts.chartColors.length ? Math.floor(Math.random() * opts.chartColors.length) : idx]) +\r\n                        '</a:solidFill>';\r\n                if (opts.dataBorder) {\r\n                    strXml +=\r\n                        '<a:ln w=\"' +\r\n                            opts.dataBorder.pt * ONEPT +\r\n                            '\" cap=\"flat\"><a:solidFill>' +\r\n                            createColorElement(opts.dataBorder.color) +\r\n                            '</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n                }\r\n                strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n                strXml += '  </c:spPr>';\r\n                strXml += '</c:dPt>';\r\n            });\r\n            // 3: \"Data Label\" block for every data Label\r\n            strXml += '<c:dLbls>';\r\n            obj.labels.forEach(function (_label, idx) {\r\n                strXml += '<c:dLbl>';\r\n                strXml += '  <c:idx val=\"' + idx + '\"/>';\r\n                strXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>';\r\n                strXml += '    <c:txPr>';\r\n                strXml += '      <a:bodyPr/><a:lstStyle/>';\r\n                strXml += '      <a:p><a:pPr>';\r\n                strXml +=\r\n                    '        <a:defRPr b=\"' + (opts.dataLabelFontBold ? 1 : 0) + '\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">';\r\n                strXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>';\r\n                strXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>';\r\n                strXml += '        </a:defRPr>';\r\n                strXml += '      </a:pPr></a:p>';\r\n                strXml += '    </c:txPr>';\r\n                if (chartType === CHART_TYPES.PIE) {\r\n                    strXml += '    <c:dLblPos val=\"' + (opts.dataLabelPosition || 'inEnd') + '\"/>';\r\n                }\r\n                strXml += '    <c:showLegendKey val=\"0\"/>';\r\n                strXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>';\r\n                strXml += '    <c:showCatName val=\"' + (opts.showLabel ? '1' : '0') + '\"/>';\r\n                strXml += '    <c:showSerName val=\"0\"/>';\r\n                strXml += '    <c:showPercent val=\"' + (opts.showPercent ? '1' : '0') + '\"/>';\r\n                strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n                strXml += '  </c:dLbl>';\r\n            });\r\n            strXml += \"<c:numFmt formatCode=\\\"\" + opts.dataLabelFormatCode + \"\\\" sourceLinked=\\\"0\\\"/>\";\r\n            strXml += '\t<c:txPr>';\r\n            strXml += '\t  <a:bodyPr/>';\r\n            strXml += '\t  <a:lstStyle/>';\r\n            strXml += '\t  <a:p>';\r\n            strXml += '\t\t<a:pPr>';\r\n            strXml += '\t\t  <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\">';\r\n            strXml += '\t\t\t<a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:latin typeface=\"Arial\"/>';\r\n            strXml += '\t\t  </a:defRPr>';\r\n            strXml += '\t\t</a:pPr>';\r\n            strXml += '\t  </a:p>';\r\n            strXml += '\t</c:txPr>';\r\n            strXml += chartType === CHART_TYPES.PIE ? '<c:dLblPos val=\"ctr\"/>' : '';\r\n            strXml += '\t<c:showLegendKey val=\"0\"/>';\r\n            strXml += '\t<c:showVal val=\"0\"/>';\r\n            strXml += '\t<c:showCatName val=\"1\"/>';\r\n            strXml += '\t<c:showSerName val=\"0\"/>';\r\n            strXml += '\t<c:showPercent val=\"1\"/>';\r\n            strXml += '\t<c:showBubbleSize val=\"0\"/>';\r\n            strXml += '\t<c:showLeaderLines val=\"0\"/>';\r\n            strXml += '</c:dLbls>';\r\n            // 2: \"Categories\"\r\n            strXml += '<c:cat>';\r\n            strXml += '  <c:strRef>';\r\n            strXml += '    <c:f>Sheet1!$A$2:$A$' + (obj.labels.length + 1) + '</c:f>';\r\n            strXml += '    <c:strCache>';\r\n            strXml += '\t     <c:ptCount val=\"' + obj.labels.length + '\"/>';\r\n            obj.labels.forEach(function (label, idx) {\r\n                strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + encodeXmlEntities(label) + '</c:v></c:pt>';\r\n            });\r\n            strXml += '    </c:strCache>';\r\n            strXml += '  </c:strRef>';\r\n            strXml += '</c:cat>';\r\n            // 3: Create vals\r\n            strXml += '  <c:val>';\r\n            strXml += '    <c:numRef>';\r\n            strXml += '      <c:f>Sheet1!$B$2:$B$' + (obj.labels.length + 1) + '</c:f>';\r\n            strXml += '      <c:numCache>';\r\n            strXml += '\t       <c:ptCount val=\"' + obj.labels.length + '\"/>';\r\n            obj.values.forEach(function (value, idx) {\r\n                strXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || value === 0 ? value : '') + '</c:v></c:pt>';\r\n            });\r\n            strXml += '      </c:numCache>';\r\n            strXml += '    </c:numRef>';\r\n            strXml += '  </c:val>';\r\n            // 4: Close \"SERIES\"\r\n            strXml += '  </c:ser>';\r\n            strXml += '  <c:firstSliceAng val=\"0\"/>';\r\n            if (chartType === CHART_TYPES.DOUGHNUT)\r\n                strXml += '  <c:holeSize val=\"' + (opts.holeSize || 50) + '\"/>';\r\n            strXml += '</c:' + chartType + 'Chart>';\r\n            // Done with Doughnut/Pie\r\n            break;\r\n        default:\r\n            strXml += '';\r\n            break;\r\n    }\r\n    return strXml;\r\n}\r\n/**\r\n * Create Category axis\r\n * @param {IChartOpts} opts - chart options\r\n * @param {string} axisId - value\r\n * @param {string} valAxisId - value\r\n * @return {string} XML\r\n */\r\nfunction makeCatAxis(opts, axisId, valAxisId) {\r\n    var strXml = '';\r\n    // Build cat axis tag\r\n    // NOTE: Scatter and Bubble chart need two Val axises as they display numbers on x axis\r\n    if (opts.type === CHART_TYPES.SCATTER || opts.type === CHART_TYPES.BUBBLE) {\r\n        strXml += '<c:valAx>';\r\n    }\r\n    else {\r\n        strXml += '<c:' + (opts.catLabelFormatCode ? 'dateAx' : 'catAx') + '>';\r\n    }\r\n    strXml += '  <c:axId val=\"' + axisId + '\"/>';\r\n    strXml += '  <c:scaling>';\r\n    strXml += '<c:orientation val=\"' + (opts.catAxisOrientation || (opts.barDir === 'col' ? 'minMax' : 'minMax')) + '\"/>';\r\n    if (opts.catAxisMaxVal || opts.catAxisMaxVal === 0)\r\n        strXml += '<c:max val=\"' + opts.catAxisMaxVal + '\"/>';\r\n    if (opts.catAxisMinVal || opts.catAxisMinVal === 0)\r\n        strXml += '<c:min val=\"' + opts.catAxisMinVal + '\"/>';\r\n    strXml += '</c:scaling>';\r\n    strXml += '  <c:delete val=\"' + (opts.catAxisHidden ? 1 : 0) + '\"/>';\r\n    strXml += '  <c:axPos val=\"' + (opts.barDir === 'col' ? 'b' : 'l') + '\"/>';\r\n    strXml += opts.catGridLine.style !== 'none' ? createGridLineElement(opts.catGridLine) : '';\r\n    // '<c:title>' comes between '</c:majorGridlines>' and '<c:numFmt>'\r\n    if (opts.showCatAxisTitle) {\r\n        strXml += genXmlTitle({\r\n            color: opts.catAxisTitleColor,\r\n            fontFace: opts.catAxisTitleFontFace,\r\n            fontSize: opts.catAxisTitleFontSize,\r\n            rotate: opts.catAxisTitleRotate,\r\n            title: opts.catAxisTitle || 'Axis Title',\r\n        });\r\n    }\r\n    // NOTE: Adding Val Axis Formatting if scatter or bubble charts\r\n    if (opts.type === CHART_TYPES.SCATTER || opts.type === CHART_TYPES.BUBBLE) {\r\n        strXml += '  <c:numFmt formatCode=\"' + (opts.valAxisLabelFormatCode ? opts.valAxisLabelFormatCode : 'General') + '\" sourceLinked=\"0\"/>';\r\n    }\r\n    else {\r\n        strXml += '  <c:numFmt formatCode=\"' + (opts.catLabelFormatCode || 'General') + '\" sourceLinked=\"0\"/>';\r\n    }\r\n    if (opts.type === CHART_TYPES.SCATTER) {\r\n        strXml += '  <c:majorTickMark val=\"none\"/>';\r\n        strXml += '  <c:minorTickMark val=\"none\"/>';\r\n        strXml += '  <c:tickLblPos val=\"nextTo\"/>';\r\n    }\r\n    else {\r\n        strXml += '  <c:majorTickMark val=\"' + (opts.catAxisMajorTickMark || 'out') + '\"/>';\r\n        strXml += '  <c:minorTickMark val=\"' + (opts.catAxisMajorTickMark || 'none') + '\"/>';\r\n        strXml += '  <c:tickLblPos val=\"' + (opts.catAxisLabelPos || opts.barDir === 'col' ? 'low' : 'nextTo') + '\"/>';\r\n    }\r\n    strXml += '  <c:spPr>';\r\n    strXml += '    <a:ln w=\"12700\" cap=\"flat\">';\r\n    strXml += opts.catAxisLineShow === false ? '<a:noFill/>' : '<a:solidFill><a:srgbClr val=\"' + DEF_CHART_GRIDLINE.color + '\"/></a:solidFill>';\r\n    strXml += '      <a:prstDash val=\"solid\"/>';\r\n    strXml += '      <a:round/>';\r\n    strXml += '    </a:ln>';\r\n    strXml += '  </c:spPr>';\r\n    strXml += '  <c:txPr>';\r\n    strXml += '    <a:bodyPr ' + (opts.catAxisLabelRotate ? 'rot=\"' + convertRotationDegrees(opts.catAxisLabelRotate) + '\"' : '') + '/>'; // don't specify rot 0 so we get the auto behavior\r\n    strXml += '    <a:lstStyle/>';\r\n    strXml += '    <a:p>';\r\n    strXml += '    <a:pPr>';\r\n    strXml += '    <a:defRPr sz=\"' + (opts.catAxisLabelFontSize || DEF_FONT_SIZE) + '00\" b=\"' + (opts.catAxisLabelFontBold ? 1 : 0) + '\" i=\"0\" u=\"none\" strike=\"noStrike\">';\r\n    strXml += '      <a:solidFill><a:srgbClr val=\"' + (opts.catAxisLabelColor || DEF_FONT_COLOR) + '\"/></a:solidFill>';\r\n    strXml += '      <a:latin typeface=\"' + (opts.catAxisLabelFontFace || 'Arial') + '\"/>';\r\n    strXml += '   </a:defRPr>';\r\n    strXml += '  </a:pPr>';\r\n    strXml += '  <a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\"/>';\r\n    strXml += '  </a:p>';\r\n    strXml += ' </c:txPr>';\r\n    strXml += ' <c:crossAx val=\"' + valAxisId + '\"/>';\r\n    strXml += ' <c:' + (typeof opts.valAxisCrossesAt === 'number' ? 'crossesAt' : 'crosses') + ' val=\"' + opts.valAxisCrossesAt + '\"/>';\r\n    strXml += ' <c:auto val=\"1\"/>';\r\n    strXml += ' <c:lblAlgn val=\"ctr\"/>';\r\n    strXml += ' <c:noMultiLvlLbl val=\"1\"/>';\r\n    if (opts.catAxisLabelFrequency)\r\n        strXml += ' <c:tickLblSkip val=\"' + opts.catAxisLabelFrequency + '\"/>';\r\n    // Issue#149: PPT will auto-adjust these as needed after calcing the date bounds, so we only include them when specified by user\r\n    if (opts.catLabelFormatCode) {\r\n        ['catAxisBaseTimeUnit', 'catAxisMajorTimeUnit', 'catAxisMinorTimeUnit'].forEach(function (opt) {\r\n            // Validate input as poorly chosen/garbage options will cause chart corruption and it wont render at all!\r\n            if (opts[opt] && (typeof opts[opt] !== 'string' || ['days', 'months', 'years'].indexOf(opt.toLowerCase()) === -1)) {\r\n                console.warn('`' + opt + \"` must be one of: 'days','months','years' !\");\r\n                opts[opt] = null;\r\n            }\r\n        });\r\n        if (opts.catAxisBaseTimeUnit)\r\n            strXml += ' <c:baseTimeUnit  val=\"' + opts.catAxisBaseTimeUnit.toLowerCase() + '\"/>';\r\n        if (opts.catAxisMajorTimeUnit)\r\n            strXml += ' <c:majorTimeUnit val=\"' + opts.catAxisMajorTimeUnit.toLowerCase() + '\"/>';\r\n        if (opts.catAxisMinorTimeUnit)\r\n            strXml += ' <c:minorTimeUnit val=\"' + opts.catAxisMinorTimeUnit.toLowerCase() + '\"/>';\r\n        if (opts.catAxisMajorUnit)\r\n            strXml += ' <c:majorUnit     val=\"' + opts.catAxisMajorUnit + '\"/>';\r\n        if (opts.catAxisMinorUnit)\r\n            strXml += ' <c:minorUnit     val=\"' + opts.catAxisMinorUnit + '\"/>';\r\n    }\r\n    // Close cat axis tag\r\n    // NOTE: Added closing tag of val or cat axis based on chart type\r\n    if (opts.type === CHART_TYPES.SCATTER || opts.type === CHART_TYPES.BUBBLE) {\r\n        strXml += '</c:valAx>';\r\n    }\r\n    else {\r\n        strXml += '</c:' + (opts.catLabelFormatCode ? 'dateAx' : 'catAx') + '>';\r\n    }\r\n    return strXml;\r\n}\r\n/**\r\n * Create Value Axis (Used by `bar3D`)\r\n * @param {IChartOpts} opts - chart options\r\n * @param {string} valAxisId - value\r\n * @return {string} XML\r\n */\r\nfunction makeValAxis(opts, valAxisId) {\r\n    var axisPos = valAxisId === AXIS_ID_VALUE_PRIMARY ? (opts.barDir === 'col' ? 'l' : 'b') : opts.barDir === 'col' ? 'r' : 't';\r\n    var strXml = '';\r\n    var isRight = axisPos === 'r' || axisPos === 't';\r\n    var crosses = isRight ? 'max' : 'autoZero';\r\n    var crossAxId = valAxisId === AXIS_ID_VALUE_PRIMARY ? AXIS_ID_CATEGORY_PRIMARY : AXIS_ID_CATEGORY_SECONDARY;\r\n    strXml += '<c:valAx>';\r\n    strXml += '  <c:axId val=\"' + valAxisId + '\"/>';\r\n    strXml += '  <c:scaling>';\r\n    strXml += '    <c:orientation val=\"' + (opts.valAxisOrientation || (opts.barDir === 'col' ? 'minMax' : 'minMax')) + '\"/>';\r\n    if (opts.valAxisMaxVal || opts.valAxisMaxVal === 0)\r\n        strXml += '<c:max val=\"' + opts.valAxisMaxVal + '\"/>';\r\n    if (opts.valAxisMinVal || opts.valAxisMinVal === 0)\r\n        strXml += '<c:min val=\"' + opts.valAxisMinVal + '\"/>';\r\n    strXml += '  </c:scaling>';\r\n    strXml += '  <c:delete val=\"' + (opts.valAxisHidden ? 1 : 0) + '\"/>';\r\n    strXml += '  <c:axPos val=\"' + axisPos + '\"/>';\r\n    if (opts.valGridLine.style !== 'none')\r\n        strXml += createGridLineElement(opts.valGridLine);\r\n    // '<c:title>' comes between '</c:majorGridlines>' and '<c:numFmt>'\r\n    if (opts.showValAxisTitle) {\r\n        strXml += genXmlTitle({\r\n            color: opts.valAxisTitleColor,\r\n            fontFace: opts.valAxisTitleFontFace,\r\n            fontSize: opts.valAxisTitleFontSize,\r\n            rotate: opts.valAxisTitleRotate,\r\n            title: opts.valAxisTitle || 'Axis Title',\r\n        });\r\n    }\r\n    strXml += ' <c:numFmt formatCode=\"' + (opts.valAxisLabelFormatCode ? opts.valAxisLabelFormatCode : 'General') + '\" sourceLinked=\"0\"/>';\r\n    if (opts.type === CHART_TYPES.SCATTER) {\r\n        strXml += '  <c:majorTickMark val=\"none\"/>';\r\n        strXml += '  <c:minorTickMark val=\"none\"/>';\r\n        strXml += '  <c:tickLblPos val=\"nextTo\"/>';\r\n    }\r\n    else {\r\n        strXml += ' <c:majorTickMark val=\"' + (opts.valAxisMajorTickMark || 'out') + '\"/>';\r\n        strXml += ' <c:minorTickMark val=\"' + (opts.valAxisMinorTickMark || 'none') + '\"/>';\r\n        strXml += ' <c:tickLblPos val=\"' + (opts.valAxisLabelPos || opts.barDir === 'col' ? 'nextTo' : 'low') + '\"/>';\r\n    }\r\n    strXml += ' <c:spPr>';\r\n    strXml += '   <a:ln w=\"12700\" cap=\"flat\">';\r\n    strXml += opts.valAxisLineShow === false ? '<a:noFill/>' : '<a:solidFill><a:srgbClr val=\"' + DEF_CHART_GRIDLINE.color + '\"/></a:solidFill>';\r\n    strXml += '     <a:prstDash val=\"solid\"/>';\r\n    strXml += '     <a:round/>';\r\n    strXml += '   </a:ln>';\r\n    strXml += ' </c:spPr>';\r\n    strXml += ' <c:txPr>';\r\n    strXml += '  <a:bodyPr ' + (opts.valAxisLabelRotate ? 'rot=\"' + convertRotationDegrees(opts.valAxisLabelRotate) + '\"' : '') + '/>'; // don't specify rot 0 so we get the auto behavior\r\n    strXml += '  <a:lstStyle/>';\r\n    strXml += '  <a:p>';\r\n    strXml += '    <a:pPr>';\r\n    strXml += '      <a:defRPr sz=\"' + (opts.valAxisLabelFontSize || DEF_FONT_SIZE) + '00\" b=\"' + (opts.valAxisLabelFontBold ? 1 : 0) + '\" i=\"0\" u=\"none\" strike=\"noStrike\">';\r\n    strXml += '        <a:solidFill><a:srgbClr val=\"' + (opts.valAxisLabelColor || DEF_FONT_COLOR) + '\"/></a:solidFill>';\r\n    strXml += '        <a:latin typeface=\"' + (opts.valAxisLabelFontFace || 'Arial') + '\"/>';\r\n    strXml += '      </a:defRPr>';\r\n    strXml += '    </a:pPr>';\r\n    strXml += '  <a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\"/>';\r\n    strXml += '  </a:p>';\r\n    strXml += ' </c:txPr>';\r\n    strXml += ' <c:crossAx val=\"' + crossAxId + '\"/>';\r\n    strXml += ' <c:crosses val=\"' + crosses + '\"/>';\r\n    strXml +=\r\n        ' <c:crossBetween val=\"' +\r\n            (opts.type === CHART_TYPES.SCATTER || (Array.isArray(opts.type) && opts.type.filter(function (type) { return type.type === CHART_TYPES.AREA; }).length > 0 ? true : false)\r\n                ? 'midCat'\r\n                : 'between') +\r\n            '\"/>';\r\n    if (opts.valAxisMajorUnit)\r\n        strXml += ' <c:majorUnit val=\"' + opts.valAxisMajorUnit + '\"/>';\r\n    strXml += '</c:valAx>';\r\n    return strXml;\r\n}\r\n/**\r\n * Create Series Axis (Used by `bar3D`)\r\n * @param {IChartOpts} opts - chart options\r\n * @param {string} axisId - axis ID\r\n * @param {string} valAxisId - value\r\n * @return {string} XML\r\n */\r\nfunction makeSerAxis(opts, axisId, valAxisId) {\r\n    var strXml = '';\r\n    // Build ser axis tag\r\n    strXml += '<c:serAx>';\r\n    strXml += '  <c:axId val=\"' + axisId + '\"/>';\r\n    strXml += '  <c:scaling><c:orientation val=\"' + (opts.serAxisOrientation || (opts.barDir === 'col' ? 'minMax' : 'minMax')) + '\"/></c:scaling>';\r\n    strXml += '  <c:delete val=\"' + (opts.serAxisHidden ? 1 : 0) + '\"/>';\r\n    strXml += '  <c:axPos val=\"' + (opts.barDir === 'col' ? 'b' : 'l') + '\"/>';\r\n    strXml += opts.serGridLine.style !== 'none' ? createGridLineElement(opts.serGridLine) : '';\r\n    // '<c:title>' comes between '</c:majorGridlines>' and '<c:numFmt>'\r\n    if (opts.showSerAxisTitle) {\r\n        strXml += genXmlTitle({\r\n            color: opts.serAxisTitleColor,\r\n            fontFace: opts.serAxisTitleFontFace,\r\n            fontSize: opts.serAxisTitleFontSize,\r\n            rotate: opts.serAxisTitleRotate,\r\n            title: opts.serAxisTitle || 'Axis Title',\r\n        });\r\n    }\r\n    strXml += '  <c:numFmt formatCode=\"' + (opts.serLabelFormatCode || 'General') + '\" sourceLinked=\"0\"/>';\r\n    strXml += '  <c:majorTickMark val=\"out\"/>';\r\n    strXml += '  <c:minorTickMark val=\"none\"/>';\r\n    strXml += '  <c:tickLblPos val=\"' + (opts.serAxisLabelPos || opts.barDir === 'col' ? 'low' : 'nextTo') + '\"/>';\r\n    strXml += '  <c:spPr>';\r\n    strXml += '    <a:ln w=\"12700\" cap=\"flat\">';\r\n    strXml += opts.serAxisLineShow === false ? '<a:noFill/>' : '<a:solidFill><a:srgbClr val=\"' + DEF_CHART_GRIDLINE.color + '\"/></a:solidFill>';\r\n    strXml += '      <a:prstDash val=\"solid\"/>';\r\n    strXml += '      <a:round/>';\r\n    strXml += '    </a:ln>';\r\n    strXml += '  </c:spPr>';\r\n    strXml += '  <c:txPr>';\r\n    strXml += '    <a:bodyPr/>'; // don't specify rot 0 so we get the auto behavior\r\n    strXml += '    <a:lstStyle/>';\r\n    strXml += '    <a:p>';\r\n    strXml += '    <a:pPr>';\r\n    strXml += '    <a:defRPr sz=\"' + (opts.serAxisLabelFontSize || DEF_FONT_SIZE) + '00\" b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\">';\r\n    strXml += '      <a:solidFill><a:srgbClr val=\"' + (opts.serAxisLabelColor || DEF_FONT_COLOR) + '\"/></a:solidFill>';\r\n    strXml += '      <a:latin typeface=\"' + (opts.serAxisLabelFontFace || 'Arial') + '\"/>';\r\n    strXml += '   </a:defRPr>';\r\n    strXml += '  </a:pPr>';\r\n    strXml += '  <a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\"/>';\r\n    strXml += '  </a:p>';\r\n    strXml += ' </c:txPr>';\r\n    strXml += ' <c:crossAx val=\"' + valAxisId + '\"/>';\r\n    strXml += ' <c:crosses val=\"autoZero\"/>';\r\n    if (opts.serAxisLabelFrequency)\r\n        strXml += ' <c:tickLblSkip val=\"' + opts.serAxisLabelFrequency + '\"/>';\r\n    // Issue#149: PPT will auto-adjust these as needed after calcing the date bounds, so we only include them when specified by user\r\n    if (opts.serLabelFormatCode) {\r\n        ['serAxisBaseTimeUnit', 'serAxisMajorTimeUnit', 'serAxisMinorTimeUnit'].forEach(function (opt) {\r\n            // Validate input as poorly chosen/garbage options will cause chart corruption and it wont render at all!\r\n            if (opts[opt] && (typeof opts[opt] !== 'string' || ['days', 'months', 'years'].indexOf(opt.toLowerCase()) === -1)) {\r\n                console.warn('`' + opt + \"` must be one of: 'days','months','years' !\");\r\n                opts[opt] = null;\r\n            }\r\n        });\r\n        if (opts.serAxisBaseTimeUnit)\r\n            strXml += ' <c:baseTimeUnit  val=\"' + opts.serAxisBaseTimeUnit.toLowerCase() + '\"/>';\r\n        if (opts.serAxisMajorTimeUnit)\r\n            strXml += ' <c:majorTimeUnit val=\"' + opts.serAxisMajorTimeUnit.toLowerCase() + '\"/>';\r\n        if (opts.serAxisMinorTimeUnit)\r\n            strXml += ' <c:minorTimeUnit val=\"' + opts.serAxisMinorTimeUnit.toLowerCase() + '\"/>';\r\n        if (opts.serAxisMajorUnit)\r\n            strXml += ' <c:majorUnit     val=\"' + opts.serAxisMajorUnit + '\"/>';\r\n        if (opts.serAxisMinorUnit)\r\n            strXml += ' <c:minorUnit     val=\"' + opts.serAxisMinorUnit + '\"/>';\r\n    }\r\n    // Close ser axis tag\r\n    strXml += '</c:serAx>';\r\n    return strXml;\r\n}\r\n/**\r\n * Create char title elements\r\n * @param {IChartTitleOpts} opts - options\r\n * @return {string} XML `<c:title>`\r\n */\r\nfunction genXmlTitle(opts) {\r\n    var align = opts.titleAlign === 'left' || opts.titleAlign === 'right' ? \"<a:pPr algn=\\\"\" + opts.titleAlign.substring(0, 1) + \"\\\">\" : \"<a:pPr>\";\r\n    var rotate = opts.rotate ? \"<a:bodyPr rot=\\\"\" + convertRotationDegrees(opts.rotate) + \"\\\"/>\" : \"<a:bodyPr/>\"; // don't specify rotation to get default (ex. vertical for cat axis)\r\n    var sizeAttr = opts.fontSize ? 'sz=\"' + Math.round(opts.fontSize) + '00\"' : ''; // only set the font size if specified.  Powerpoint will handle the default size\r\n    var layout = opts.titlePos && opts.titlePos.x && opts.titlePos.y\r\n        ? \"<c:layout><c:manualLayout><c:xMode val=\\\"edge\\\"/><c:yMode val=\\\"edge\\\"/><c:x val=\\\"\" + opts.titlePos.x + \"\\\"/><c:y val=\\\"\" + opts.titlePos.y + \"\\\"/></c:manualLayout></c:layout>\"\r\n        : \"<c:layout/>\";\r\n    return \"<c:title>\\n\\t  <c:tx>\\n\\t    <c:rich>\\n\\t      \" + rotate + \"\\n\\t      <a:lstStyle/>\\n\\t      <a:p>\\n\\t        \" + align + \"\\n\\t        <a:defRPr \" + sizeAttr + \" b=\\\"0\\\" i=\\\"0\\\" u=\\\"none\\\" strike=\\\"noStrike\\\">\\n\\t          <a:solidFill><a:srgbClr val=\\\"\" + (opts.color || DEF_FONT_COLOR) + \"\\\"/></a:solidFill>\\n\\t          <a:latin typeface=\\\"\" + (opts.fontFace || 'Arial') + \"\\\"/>\\n\\t        </a:defRPr>\\n\\t      </a:pPr>\\n\\t      <a:r>\\n\\t        <a:rPr \" + sizeAttr + \" b=\\\"0\\\" i=\\\"0\\\" u=\\\"none\\\" strike=\\\"noStrike\\\">\\n\\t          <a:solidFill><a:srgbClr val=\\\"\" + (opts.color || DEF_FONT_COLOR) + \"\\\"/></a:solidFill>\\n\\t          <a:latin typeface=\\\"\" + (opts.fontFace || 'Arial') + \"\\\"/>\\n\\t        </a:rPr>\\n\\t        <a:t>\" + (encodeXmlEntities(opts.title) || '') + \"</a:t>\\n\\t      </a:r>\\n\\t    </a:p>\\n\\t    </c:rich>\\n\\t  </c:tx>\\n\\t  \" + layout + \"\\n\\t  <c:overlay val=\\\"0\\\"/>\\n\\t</c:title>\";\r\n}\r\n/**\r\n * Calc and return excel column name for a given column length\r\n * @param {number} length - col length\r\n * @return {string} column name (ex: 'A2')\r\n */\r\nfunction getExcelColName(length) {\r\n    var strName = '';\r\n    if (length <= 26) {\r\n        strName = LETTERS[length];\r\n    }\r\n    else {\r\n        strName += LETTERS[Math.floor(length / LETTERS.length) - 1];\r\n        strName += LETTERS[length % LETTERS.length];\r\n    }\r\n    return strName;\r\n}\r\n/**\r\n * NOTE: Used by both: text and lineChart\r\n * Creates `a:innerShdw` or `a:outerShdw` depending on pass options `opts`.\r\n * @param {Object} opts optional shadow properties\r\n * @param {Object} defaults defaults for unspecified properties in `opts`\r\n * @see http://officeopenxml.com/drwSp-effects.php\r\n * @example { type: 'outer', blur: 3, offset: (23000 / 12700), angle: 90, color: '000000', opacity: 0.35, rotateWithShape: true };\r\n * @return {string} XML\r\n */\r\nfunction createShadowElement(options, defaults) {\r\n    if (!options) {\r\n        return '<a:effectLst/>';\r\n    }\r\n    else if (typeof options !== 'object') {\r\n        console.warn(\"`shadow` options must be an object. Ex: `{shadow: {type:'none'}}`\");\r\n        return '<a:effectLst/>';\r\n    }\r\n    var strXml = '<a:effectLst>', opts = getMix(defaults, options), type = opts['type'] || 'outer', blur = opts['blur'] * ONEPT, offset = opts['offset'] * ONEPT, angle = opts['angle'] * 60000, color = opts['color'], opacity = opts['opacity'] * 100000, rotateWithShape = opts['rotateWithShape'] ? 1 : 0;\r\n    strXml += '<a:' + type + 'Shdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\"  algn=\"bl\" blurRad=\"' + blur + '\" ';\r\n    strXml += 'rotWithShape=\"' + +rotateWithShape + '\"';\r\n    strXml += ' dist=\"' + offset + '\" dir=\"' + angle + '\">';\r\n    strXml += '<a:srgbClr val=\"' + color + '\">'; // TODO: should accept scheme colors implemented in Issue #135\r\n    strXml += '<a:alpha val=\"' + opacity + '\"/></a:srgbClr>';\r\n    strXml += '</a:' + type + 'Shdw>';\r\n    strXml += '</a:effectLst>';\r\n    return strXml;\r\n}\r\n/**\r\n * Create Grid Line Element\r\n * @param {OptsChartGridLine} glOpts {size, color, style}\r\n * @return {string} XML\r\n */\r\nfunction createGridLineElement(glOpts) {\r\n    var strXml = '<c:majorGridlines>';\r\n    strXml += ' <c:spPr>';\r\n    strXml += '  <a:ln w=\"' + Math.round((glOpts.size || DEF_CHART_GRIDLINE.size) * ONEPT) + '\" cap=\"flat\">';\r\n    strXml += '  <a:solidFill><a:srgbClr val=\"' + (glOpts.color || DEF_CHART_GRIDLINE.color) + '\"/></a:solidFill>'; // should accept scheme colors as implemented in [Pull #135]\r\n    strXml += '   <a:prstDash val=\"' + (glOpts.style || DEF_CHART_GRIDLINE.style) + '\"/><a:round/>';\r\n    strXml += '  </a:ln>';\r\n    strXml += ' </c:spPr>';\r\n    strXml += '</c:majorGridlines>';\r\n    return strXml;\r\n}\n\n/**\r\n * PptxGenJS: Media Methods\r\n */\r\n/**\r\n * Encode Image/Audio/Video into base64\r\n * @param {ISlide | ISlideLayout} layout - slide layout\r\n * @return {Promise} promise of generating the rels\r\n */\r\nfunction encodeSlideMediaRels(layout) {\r\n    var fs = typeof require !== 'undefined' && typeof window === 'undefined' ? require('fs') : null; // NodeJS\r\n    var https = typeof require !== 'undefined' && typeof window === 'undefined' ? require('https') : null; // NodeJS\r\n    var imageProms = [];\r\n    // A: Read/Encode each audio/image/video thats not already encoded (eg: base64 provided by user)\r\n    layout.relsMedia\r\n        .filter(function (rel) { return rel.type !== 'online' && !rel.data; })\r\n        .forEach(function (rel) {\r\n        imageProms.push(new Promise(function (resolve, reject) {\r\n            if (fs && rel.path.indexOf('http') !== 0) {\r\n                // DESIGN: Node local-file encoding is syncronous, so we can load all images here, then call export with a callback (if any)\r\n                try {\r\n                    var bitmap = fs.readFileSync(rel.path);\r\n                    rel.data = Buffer.from(bitmap).toString('base64');\r\n                    resolve('done');\r\n                }\r\n                catch (ex) {\r\n                    rel.data = IMG_BROKEN;\r\n                    reject('ERROR: Unable to read media: \"' + rel.path + '\"\\n' + ex.toString());\r\n                }\r\n            }\r\n            else if (fs && https && rel.path.indexOf('http') === 0) {\r\n                https.get(rel.path, function (res) {\r\n                    var rawData = '';\r\n                    res.setEncoding('binary'); // IMPORTANT: Only binary encoding works\r\n                    res.on('data', function (chunk) { return (rawData += chunk); });\r\n                    res.on('end', function () {\r\n                        rel.data = Buffer.from(rawData, 'binary').toString('base64');\r\n                        resolve('done');\r\n                    });\r\n                    res.on('error', function (ex) {\r\n                        rel.data = IMG_BROKEN;\r\n                        reject(\"ERROR! Unable to load image: \" + rel.path);\r\n                    });\r\n                });\r\n            }\r\n            else {\r\n                // A: Declare XHR and onload/onerror handlers\r\n                // DESIGN: `XMLHttpRequest()` plus `FileReader()` = Ablity to read any file into base64!\r\n                var xhr_1 = new XMLHttpRequest();\r\n                xhr_1.onload = function () {\r\n                    var reader = new FileReader();\r\n                    reader.onloadend = function () {\r\n                        rel.data = reader.result;\r\n                        if (!rel.isSvgPng) {\r\n                            resolve('done');\r\n                        }\r\n                        else {\r\n                            createSvgPngPreview(rel)\r\n                                .then(function () {\r\n                                resolve('done');\r\n                            })\r\n                                .catch(function (ex) {\r\n                                reject(ex);\r\n                            });\r\n                        }\r\n                    };\r\n                    reader.readAsDataURL(xhr_1.response);\r\n                };\r\n                xhr_1.onerror = function (ex) {\r\n                    rel.data = IMG_BROKEN;\r\n                    reject(\"ERROR! Unable to load image: \" + rel.path);\r\n                };\r\n                // B: Execute request\r\n                xhr_1.open('GET', rel.path);\r\n                xhr_1.responseType = 'blob';\r\n                xhr_1.send();\r\n            }\r\n        }));\r\n    });\r\n    // B: SVG: base64 data still requires a png to be generated (`isSvgPng` flag this as the preview image, not the SVG itself)\r\n    layout.relsMedia\r\n        .filter(function (rel) { return rel.isSvgPng && rel.data; })\r\n        .forEach(function (rel) {\r\n        if (fs) {\r\n            //console.log('Sorry, SVG is not supported in Node (more info: https://github.com/gitbrent/PptxGenJS/issues/401)')\r\n            rel.data = IMG_BROKEN;\r\n            imageProms.push(Promise.resolve().then(function () { return 'done'; }));\r\n        }\r\n        else {\r\n            imageProms.push(createSvgPngPreview(rel));\r\n        }\r\n    });\r\n    return imageProms;\r\n}\r\n/**\r\n * Create SVG preview image\r\n * @param {ISlideRelMedia} rel - slide rel\r\n * @return {Promise} promise\r\n */\r\nfunction createSvgPngPreview(rel) {\r\n    return new Promise(function (resolve, reject) {\r\n        // A: Create\r\n        var image = new Image();\r\n        // B: Set onload event\r\n        image.onload = function () {\r\n            // First: Check for any errors: This is the best method (try/catch wont work, etc.)\r\n            if (image.width + image.height === 0) {\r\n                image.onerror('h/w=0');\r\n            }\r\n            var canvas = document.createElement('CANVAS');\r\n            var ctx = canvas.getContext('2d');\r\n            canvas.width = image.width;\r\n            canvas.height = image.height;\r\n            ctx.drawImage(image, 0, 0);\r\n            // Users running on local machine will get the following error:\r\n            // \"SecurityError: Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported.\"\r\n            // when the canvas.toDataURL call executes below.\r\n            try {\r\n                rel.data = canvas.toDataURL(rel.type);\r\n                resolve('done');\r\n            }\r\n            catch (ex) {\r\n                image.onerror(ex);\r\n            }\r\n            canvas = null;\r\n        };\r\n        image.onerror = function (ex) {\r\n            rel.data = IMG_BROKEN;\r\n            reject(\"ERROR! Unable to load image: \" + rel.path);\r\n        };\r\n        // C: Load image\r\n        image.src = typeof rel.data === 'string' ? rel.data : IMG_BROKEN;\r\n    });\r\n}\n\n/*\\\r\n|*|  :: pptxgen.ts ::\r\n|*|\r\n|*|  JavaScript framework that creates PowerPoint (pptx) presentations\r\n|*|  https://github.com/gitbrent/PptxGenJS\r\n|*|\r\n|*|  This framework is released under the MIT Public License (MIT)\r\n|*|\r\n|*|  PptxGenJS (C) 2015-2020 Brent Ely -- https://github.com/gitbrent\r\n|*|\r\n|*|  Some code derived from the OfficeGen project:\r\n|*|  github.com/Ziv-Barber/officegen/ (Copyright 2013 Ziv Barber)\r\n|*|\r\n|*|  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n|*|  of this software and associated documentation files (the \"Software\"), to deal\r\n|*|  in the Software without restriction, including without limitation the rights\r\n|*|  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n|*|  copies of the Software, and to permit persons to whom the Software is\r\n|*|  furnished to do so, subject to the following conditions:\r\n|*|\r\n|*|  The above copyright notice and this permission notice shall be included in all\r\n|*|  copies or substantial portions of the Software.\r\n|*|\r\n|*|  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n|*|  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n|*|  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n|*|  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n|*|  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n|*|  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n|*|  SOFTWARE.\r\n\\*/\r\nvar VERSION = '3.1.0-beta';\r\nvar PptxGenJS = /** @class */ (function () {\r\n    function PptxGenJS() {\r\n        var _this = this;\r\n        /**\r\n         * PptxGenJS Library Version\r\n         */\r\n        this._version = VERSION;\r\n        // Global props\r\n        this._charts = CHART_TYPES;\r\n        this._colors = SCHEME_COLOR_NAMES;\r\n        this._shapes = PowerPointShapes;\r\n        /**\r\n         * Provides an API for `addTableDefinition` to create slides as needed for auto-paging\r\n         * @param {string} masterName - slide master name\r\n         * @return {ISlide} new Slide\r\n         */\r\n        this.addNewSlide = function (masterName) { return _this.addSlide(masterName); };\r\n        /**\r\n         * Provides an API for `addTableDefinition` to create slides as needed for auto-paging\r\n         * @since 3.0.0\r\n         * @param {number} slideNum - slide number\r\n         * @return {ISlide} Slide\r\n         */\r\n        this.getSlide = function (slideNum) { return _this.slides.filter(function (slide) { return slide.number === slideNum; })[0]; };\r\n        /**\r\n         * Enables the `Slide` class to set PptxGenJS [Presentation] master/layout slidenumbers\r\n         * @param {ISlideNumber} slideNum - slide number config\r\n         */\r\n        this.setSlideNumber = function (slideNum) {\r\n            // 1: Add slideNumber to slideMaster1.xml\r\n            _this.masterSlide.slideNumberObj = slideNum;\r\n            // 2: Add slideNumber to DEF_PRES_LAYOUT_NAME layout\r\n            _this.slideLayouts.filter(function (layout) { return layout.name === DEF_PRES_LAYOUT_NAME; })[0].slideNumberObj = slideNum;\r\n        };\r\n        /**\r\n         * Create all chart and media rels for this Presenation\r\n         * @param {ISlide | ISlideLayout} slide - slide with rels\r\n         * @param {JSZIP} zip - JSZip instance\r\n         * @param {Promise<any>[]} chartPromises - promise array\r\n         */\r\n        this.createChartMediaRels = function (slide, zip, chartPromises) {\r\n            slide.relsChart.forEach(function (rel) { return chartPromises.push(createExcelWorksheet(rel, zip)); });\r\n            slide.relsMedia.forEach(function (rel) {\r\n                if (rel.type !== 'online' && rel.type !== 'hyperlink') {\r\n                    // A: Loop vars\r\n                    var data = rel.data && typeof rel.data === 'string' ? rel.data : '';\r\n                    // B: Users will undoubtedly pass various string formats, so correct prefixes as needed\r\n                    if (data.indexOf(',') === -1 && data.indexOf(';') === -1)\r\n                        data = 'image/png;base64,' + data;\r\n                    else if (data.indexOf(',') === -1)\r\n                        data = 'image/png;base64,' + data;\r\n                    else if (data.indexOf(';') === -1)\r\n                        data = 'image/png;' + data;\r\n                    // C: Add media\r\n                    zip.file(rel.Target.replace('..', 'ppt'), data.split(',').pop(), { base64: true });\r\n                }\r\n            });\r\n        };\r\n        /**\r\n         * Create and export the .pptx file\r\n         * @param {string} exportName - output file type\r\n         * @param {Blob} blobContent - Blob content\r\n         * @return {Promise<string>} Promise with file name\r\n         */\r\n        this.writeFileToBrowser = function (exportName, blobContent) {\r\n            return new Promise(function (resolve, _reject) {\r\n                // STEP 1: Create element\r\n                var eleLink = document.createElement('a');\r\n                eleLink.setAttribute('style', 'display:none;');\r\n                document.body.appendChild(eleLink);\r\n                // STEP 2: Download file to browser\r\n                // DESIGN: Use `createObjectURL()` (or MS-specific func for IE11) to D/L files in client browsers (FYI: synchronously executed)\r\n                if (window.navigator.msSaveOrOpenBlob) {\r\n                    // @see https://docs.microsoft.com/en-us/microsoft-edge/dev-guide/html5/file-api/blob\r\n                    var blob_1 = new Blob([blobContent], { type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' });\r\n                    eleLink.onclick = function () {\r\n                        window.navigator.msSaveOrOpenBlob(blob_1, exportName);\r\n                    };\r\n                    eleLink.click();\r\n                    // Clean-up\r\n                    document.body.removeChild(eleLink);\r\n                    // Done\r\n                    resolve(exportName);\r\n                }\r\n                else if (window.URL.createObjectURL) {\r\n                    var url_1 = window.URL.createObjectURL(new Blob([blobContent], { type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' }));\r\n                    eleLink.href = url_1;\r\n                    eleLink.download = exportName;\r\n                    eleLink.click();\r\n                    // Clean-up (NOTE: Add a slight delay before removing to avoid 'blob:null' error in Firefox Issue#81)\r\n                    setTimeout(function () {\r\n                        window.URL.revokeObjectURL(url_1);\r\n                        document.body.removeChild(eleLink);\r\n                    }, 100);\r\n                    // Done\r\n                    resolve(exportName);\r\n                }\r\n            });\r\n        };\r\n        /**\r\n         * Create and export the .pptx file\r\n         * @param {WRITE_OUTPUT_TYPE} outputType - output file type\r\n         * @return {Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array>} Promise with data or stream (node) or filename (browser)\r\n         */\r\n        this.exportPresentation = function (outputType) {\r\n            return new Promise(function (resolve, reject) {\r\n                var arrChartPromises = [];\r\n                var arrMediaPromises = [];\r\n                var zip = new JSZip();\r\n                // STEP 1: Read/Encode all Media before zip as base64 content, etc. is required\r\n                _this.slides.forEach(function (slide) {\r\n                    arrMediaPromises = arrMediaPromises.concat(encodeSlideMediaRels(slide));\r\n                });\r\n                _this.slideLayouts.forEach(function (layout) {\r\n                    arrMediaPromises = arrMediaPromises.concat(encodeSlideMediaRels(layout));\r\n                });\r\n                arrMediaPromises = arrMediaPromises.concat(encodeSlideMediaRels(_this.masterSlide));\r\n                // STEP 2: Wait for Promises (if any) then generate the PPTX file\r\n                Promise.all(arrMediaPromises)\r\n                    .catch(function (err) {\r\n                    console.error(\"ERROR! pptxgenjs export media:\");\r\n                    console.error(err);\r\n                    return null;\r\n                    // FIXME: TODO: 20200107: if one image fails to load (eg 404), then *NONE* of the images load b/c of the `.all`...\r\n                })\r\n                    .then(function () {\r\n                    // A: Add empty placeholder objects to slides that don't already have them\r\n                    _this.slides.forEach(function (slide) {\r\n                        if (slide.slideLayout)\r\n                            addPlaceholdersToSlideLayouts(slide);\r\n                    });\r\n                    // B: Add all required folders and files\r\n                    zip.folder('_rels');\r\n                    zip.folder('docProps');\r\n                    zip.folder('ppt').folder('_rels');\r\n                    zip.folder('ppt/charts').folder('_rels');\r\n                    zip.folder('ppt/embeddings');\r\n                    zip.folder('ppt/media');\r\n                    zip.folder('ppt/slideLayouts').folder('_rels');\r\n                    zip.folder('ppt/slideMasters').folder('_rels');\r\n                    zip.folder('ppt/slides').folder('_rels');\r\n                    zip.folder('ppt/theme');\r\n                    zip.folder('ppt/notesMasters').folder('_rels');\r\n                    zip.folder('ppt/notesSlides').folder('_rels');\r\n                    zip.file('[Content_Types].xml', makeXmlContTypes(_this.slides, _this.slideLayouts, _this.masterSlide));\r\n                    zip.file('_rels/.rels', makeXmlRootRels());\r\n                    zip.file('docProps/app.xml', makeXmlApp(_this.slides, _this.company));\r\n                    zip.file('docProps/core.xml', makeXmlCore(_this.title, _this.subject, _this.author, _this.revision));\r\n                    zip.file('ppt/_rels/presentation.xml.rels', makeXmlPresentationRels(_this.slides));\r\n                    zip.file('ppt/theme/theme1.xml', makeXmlTheme());\r\n                    zip.file('ppt/presentation.xml', makeXmlPresentation(_this.slides, _this.presLayout, _this.rtlMode));\r\n                    zip.file('ppt/presProps.xml', makeXmlPresProps());\r\n                    zip.file('ppt/tableStyles.xml', makeXmlTableStyles());\r\n                    zip.file('ppt/viewProps.xml', makeXmlViewProps());\r\n                    // C: Create a Layout/Master/Rel/Slide file for each SlideLayout and Slide\r\n                    _this.slideLayouts.forEach(function (layout, idx) {\r\n                        zip.file('ppt/slideLayouts/slideLayout' + (idx + 1) + '.xml', makeXmlLayout(layout));\r\n                        zip.file('ppt/slideLayouts/_rels/slideLayout' + (idx + 1) + '.xml.rels', makeXmlSlideLayoutRel(idx + 1, _this.slideLayouts));\r\n                    });\r\n                    _this.slides.forEach(function (slide, idx) {\r\n                        zip.file('ppt/slides/slide' + (idx + 1) + '.xml', makeXmlSlide(slide));\r\n                        zip.file('ppt/slides/_rels/slide' + (idx + 1) + '.xml.rels', makeXmlSlideRel(_this.slides, _this.slideLayouts, idx + 1));\r\n                        // Create all slide notes related items. Notes of empty strings are created for slides which do not have notes specified, to keep track of _rels.\r\n                        zip.file('ppt/notesSlides/notesSlide' + (idx + 1) + '.xml', makeXmlNotesSlide(slide));\r\n                        zip.file('ppt/notesSlides/_rels/notesSlide' + (idx + 1) + '.xml.rels', makeXmlNotesSlideRel(idx + 1));\r\n                    });\r\n                    zip.file('ppt/slideMasters/slideMaster1.xml', makeXmlMaster(_this.masterSlide, _this.slideLayouts));\r\n                    zip.file('ppt/slideMasters/_rels/slideMaster1.xml.rels', makeXmlMasterRel(_this.masterSlide, _this.slideLayouts));\r\n                    zip.file('ppt/notesMasters/notesMaster1.xml', makeXmlNotesMaster());\r\n                    zip.file('ppt/notesMasters/_rels/notesMaster1.xml.rels', makeXmlNotesMasterRel());\r\n                    // D: Create all Rels (images, media, chart data)\r\n                    _this.slideLayouts.forEach(function (layout) {\r\n                        _this.createChartMediaRels(layout, zip, arrChartPromises);\r\n                    });\r\n                    _this.slides.forEach(function (slide) {\r\n                        _this.createChartMediaRels(slide, zip, arrChartPromises);\r\n                    });\r\n                    _this.createChartMediaRels(_this.masterSlide, zip, arrChartPromises);\r\n                    // E: Wait for Promises (if any) then generate the PPTX file\r\n                    Promise.all(arrChartPromises)\r\n                        .then(function () {\r\n                        if (outputType === 'STREAM') {\r\n                            // A: stream file\r\n                            zip.generateAsync({ type: 'nodebuffer' }).then(function (content) {\r\n                                resolve(content);\r\n                            });\r\n                        }\r\n                        else if (outputType) {\r\n                            // B: Node [fs]: Output type user option or default\r\n                            resolve(zip.generateAsync({ type: outputType }));\r\n                        }\r\n                        else {\r\n                            // C: Browser: Output blob as app/ms-pptx\r\n                            resolve(zip.generateAsync({ type: 'blob' }));\r\n                        }\r\n                    })\r\n                        .catch(function (err) {\r\n                        throw new Error(err);\r\n                    });\r\n                });\r\n            });\r\n        };\r\n        // Set available layouts\r\n        this.LAYOUTS = {\r\n            LAYOUT_4x3: { name: 'screen4x3', width: 9144000, height: 6858000 },\r\n            LAYOUT_16x9: { name: 'screen16x9', width: 9144000, height: 5143500 },\r\n            LAYOUT_16x10: { name: 'screen16x10', width: 9144000, height: 5715000 },\r\n            LAYOUT_WIDE: { name: 'custom', width: 12192000, height: 6858000 },\r\n        };\r\n        // Core\r\n        this._author = 'PptxGenJS';\r\n        this._company = 'PptxGenJS';\r\n        this._revision = '1'; // Note: Must be a whole number\r\n        this._subject = 'PptxGenJS Presentation';\r\n        this._title = 'PptxGenJS Presentation';\r\n        // PptxGenJS props\r\n        this._presLayout = {\r\n            name: this.LAYOUTS[DEF_PRES_LAYOUT].name,\r\n            width: this.LAYOUTS[DEF_PRES_LAYOUT].width,\r\n            height: this.LAYOUTS[DEF_PRES_LAYOUT].height,\r\n        };\r\n        this._rtlMode = false;\r\n        //\r\n        this.slideLayouts = [\r\n            {\r\n                presLayout: this._presLayout,\r\n                name: DEF_PRES_LAYOUT_NAME,\r\n                number: 1000,\r\n                slide: null,\r\n                data: [],\r\n                rels: [],\r\n                relsChart: [],\r\n                relsMedia: [],\r\n                margin: DEF_SLIDE_MARGIN_IN,\r\n                slideNumberObj: null,\r\n            },\r\n        ];\r\n        this.slides = [];\r\n        this.masterSlide = {\r\n            addChart: null,\r\n            addImage: null,\r\n            addMedia: null,\r\n            addNotes: null,\r\n            addShape: null,\r\n            addTable: null,\r\n            addText: null,\r\n            //\r\n            presLayout: this._presLayout,\r\n            name: null,\r\n            number: null,\r\n            data: [],\r\n            rels: [],\r\n            relsChart: [],\r\n            relsMedia: [],\r\n            slideLayout: null,\r\n            slideNumberObj: null,\r\n        };\r\n    }\r\n    Object.defineProperty(PptxGenJS.prototype, \"layout\", {\r\n        get: function () {\r\n            return this._layout;\r\n        },\r\n        set: function (value) {\r\n            var newLayout = this.LAYOUTS[value];\r\n            if (newLayout) {\r\n                this._layout = value;\r\n                this._presLayout = newLayout;\r\n            }\r\n            else {\r\n                throw new Error('UNKNOWN-LAYOUT');\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"version\", {\r\n        get: function () {\r\n            return this._version;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"author\", {\r\n        get: function () {\r\n            return this._author;\r\n        },\r\n        set: function (value) {\r\n            this._author = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"company\", {\r\n        get: function () {\r\n            return this._company;\r\n        },\r\n        set: function (value) {\r\n            this._company = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"revision\", {\r\n        get: function () {\r\n            return this._revision;\r\n        },\r\n        set: function (value) {\r\n            this._revision = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"subject\", {\r\n        get: function () {\r\n            return this._subject;\r\n        },\r\n        set: function (value) {\r\n            this._subject = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"title\", {\r\n        get: function () {\r\n            return this._title;\r\n        },\r\n        set: function (value) {\r\n            this._title = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"rtlMode\", {\r\n        get: function () {\r\n            return this._rtlMode;\r\n        },\r\n        set: function (value) {\r\n            this._rtlMode = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"charts\", {\r\n        get: function () {\r\n            return this._charts;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"colors\", {\r\n        get: function () {\r\n            return this._colors;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"shapes\", {\r\n        get: function () {\r\n            return this._shapes;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PptxGenJS.prototype, \"presLayout\", {\r\n        get: function () {\r\n            return this._presLayout;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // EXPORT METHODS\r\n    /**\r\n     * Export the current Presenation to stream\r\n     * @since 3.0.0\r\n     * @returns {Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array>} file stream\r\n     */\r\n    PptxGenJS.prototype.stream = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.exportPresentation('STREAM')\r\n                .then(function (content) {\r\n                resolve(content);\r\n            })\r\n                .catch(function (ex) {\r\n                reject(ex);\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Export the current Presenation as JSZip content with the selected type\r\n     * @since 3.0.0\r\n     * @param {JSZIP_OUTPUT_TYPE} outputType - 'arraybuffer' | 'base64' | 'binarystring' | 'blob' | 'nodebuffer' | 'uint8array'\r\n     * @returns {Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array>} file content in selected type\r\n     */\r\n    PptxGenJS.prototype.write = function (outputType) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.exportPresentation(outputType)\r\n                .then(function (content) {\r\n                resolve(content);\r\n            })\r\n                .catch(function (ex) {\r\n                reject(ex + '\\nDid you mean to use writeFile() instead?');\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Export the current Presenation. Writes file to local file system if `fs` exists, otherwise, initiates download in browsers\r\n     * @since 3.0.0\r\n     * @param {string} exportName - file name\r\n     * @returns {Promise<string>} the presentation name\r\n     */\r\n    PptxGenJS.prototype.writeFile = function (exportName) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var fs = typeof require !== 'undefined' && typeof window === 'undefined' ? require('fs') : null; // NodeJS\r\n            var fileName = exportName\r\n                ? exportName\r\n                    .toString()\r\n                    .toLowerCase()\r\n                    .endsWith('.pptx')\r\n                    ? exportName\r\n                    : exportName + '.pptx'\r\n                : 'Presenation.pptx';\r\n            _this.exportPresentation(fs ? 'nodebuffer' : null)\r\n                .then(function (content) {\r\n                if (fs) {\r\n                    // Node: Output\r\n                    fs.writeFile(fileName, content, function () {\r\n                        resolve(fileName);\r\n                    });\r\n                }\r\n                else {\r\n                    // Browser: Output blob as app/ms-pptx\r\n                    resolve(_this.writeFileToBrowser(fileName, content));\r\n                }\r\n            })\r\n                .catch(function (ex) {\r\n                reject(ex);\r\n            });\r\n        });\r\n    };\r\n    // PRESENTATION METHODS\r\n    /**\r\n     * Add a Slide to Presenation\r\n     * @param {string} masterSlideName - Master Slide name\r\n     * @returns {ISlide} the new Slide\r\n     */\r\n    PptxGenJS.prototype.addSlide = function (masterSlideName) {\r\n        var newSlide = new Slide({\r\n            addSlide: this.addNewSlide,\r\n            getSlide: this.getSlide,\r\n            presLayout: this.presLayout,\r\n            setSlideNum: this.setSlideNumber,\r\n            slideNumber: this.slides.length + 1,\r\n            slideLayout: masterSlideName\r\n                ? this.slideLayouts.filter(function (layout) { return layout.name === masterSlideName; })[0] || this.LAYOUTS[DEF_PRES_LAYOUT]\r\n                : this.LAYOUTS[DEF_PRES_LAYOUT],\r\n        });\r\n        this.slides.push(newSlide);\r\n        return newSlide;\r\n    };\r\n    /**\r\n     * Define a custom Slide Layout\r\n     * @example pptx.defineLayout({ name:'A3', width:16.5, height:11.7 });\r\n     * @see https://support.office.com/en-us/article/Change-the-size-of-your-slides-040a811c-be43-40b9-8d04-0de5ed79987e\r\n     * @param {IUserLayout} layout - an object with user-defined w/h\r\n     */\r\n    PptxGenJS.prototype.defineLayout = function (layout) {\r\n        if (!layout)\r\n            console.warn('defineLayout requires `{name, width, height}`');\r\n        else if (!layout.name)\r\n            console.warn('defineLayout requires `name`');\r\n        else if (!layout.width)\r\n            console.warn('defineLayout requires `width`');\r\n        else if (!layout.height)\r\n            console.warn('defineLayout requires `height`');\r\n        else if (typeof layout.height !== 'number')\r\n            console.warn('defineLayout `height` should be a number (inches)');\r\n        else if (typeof layout.width !== 'number')\r\n            console.warn('defineLayout `width` should be a number (inches)');\r\n        this.LAYOUTS[layout.name] = { name: layout.name, width: Math.round(Number(layout.width) * EMU), height: Math.round(Number(layout.height) * EMU) };\r\n    };\r\n    /**\r\n     * Adds a new slide master [layout] to the Presentation\r\n     * @param {ISlideMasterOptions} slideMasterOpts - layout definition\r\n     */\r\n    PptxGenJS.prototype.defineSlideMaster = function (slideMasterOpts) {\r\n        if (!slideMasterOpts.title)\r\n            throw Error('defineSlideMaster() object argument requires a `title` value. (https://gitbrent.github.io/PptxGenJS/docs/masters.html)');\r\n        var newLayout = {\r\n            presLayout: this.presLayout,\r\n            name: slideMasterOpts.title,\r\n            number: 1000 + this.slideLayouts.length + 1,\r\n            slide: null,\r\n            data: [],\r\n            rels: [],\r\n            relsChart: [],\r\n            relsMedia: [],\r\n            margin: slideMasterOpts.margin || DEF_SLIDE_MARGIN_IN,\r\n            slideNumberObj: slideMasterOpts.slideNumber || null,\r\n        };\r\n        // STEP 1: Create the Slide Master/Layout\r\n        createSlideObject(slideMasterOpts, newLayout);\r\n        // STEP 2: Add it to layout defs\r\n        this.slideLayouts.push(newLayout);\r\n        // STEP 3: Add slideNumber to master slide (if any)\r\n        if (newLayout.slideNumberObj && !this.masterSlide.slideNumberObj)\r\n            this.masterSlide.slideNumberObj = newLayout.slideNumberObj;\r\n    };\r\n    // HTML-TO-SLIDES METHODS\r\n    /**\r\n     * Reproduces an HTML table as a PowerPoint table - including column widths, style, etc. - creates 1 or more slides as needed\r\n     * @note `verbose` option is undocumented; used for verbose output of layout process\r\n     * @param {string} tabEleId - HTMLElementID of the table\r\n     * @param {ITableToSlidesOpts} inOpts - array of options (e.g.: tabsize)\r\n     */\r\n    PptxGenJS.prototype.tableToSlides = function (tableElementId, opts) {\r\n        if (opts === void 0) { opts = {}; }\r\n        genTableToSlides(this, tableElementId, opts, opts && opts.masterSlideName ? this.slideLayouts.filter(function (layout) { return layout.name === opts.masterSlideName; })[0] : null);\r\n    };\r\n    return PptxGenJS;\r\n}());\n\nexport default PptxGenJS;\n"],"sourceRoot":""}